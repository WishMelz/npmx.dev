import{Ft as e,It as t,Lt as n,Pt as r,b as i,ot as a}from"./BLt7TXlb.js";import{t as o}from"./B2KNUzwv.js";import{C as s,f as c}from"./-B2-_an5.js";var l=t({__addDisposableResource:()=>me,__assign:()=>C,__asyncDelegator:()=>oe,__asyncGenerator:()=>ae,__asyncValues:()=>se,__await:()=>S,__awaiter:()=>y,__classPrivateFieldGet:()=>de,__classPrivateFieldIn:()=>pe,__classPrivateFieldSet:()=>fe,__createBinding:()=>w,__decorate:()=>f,__disposeResources:()=>he,__esDecorate:()=>m,__exportStar:()=>te,__extends:()=>u,__generator:()=>ee,__importDefault:()=>ue,__importStar:()=>le,__makeTemplateObject:()=>ce,__metadata:()=>v,__param:()=>p,__propKey:()=>g,__read:()=>ne,__rest:()=>d,__rewriteRelativeImportExtension:()=>ge,__runInitializers:()=>h,__setFunctionName:()=>_,__spread:()=>re,__spreadArray:()=>x,__spreadArrays:()=>ie,__values:()=>b,default:()=>xe});function u(e,t){if(typeof t!=`function`&&t!==null)throw TypeError(`Class extends value `+String(t)+` is not a constructor or null`);_e(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function d(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function f(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function p(e,t){return function(n,r){t(n,r,e)}}function m(e,t,n,r,i,a){function o(e){if(e!==void 0&&typeof e!=`function`)throw TypeError(`Function expected`);return e}for(var s=r.kind,c=s===`getter`?`get`:s===`setter`?`set`:`value`,l=!t&&e?r.static?e:e.prototype:null,u=t||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),d,f=!1,p=n.length-1;p>=0;p--){var m={};for(var h in r)m[h]=h===`access`?{}:r[h];for(var h in r.access)m.access[h]=r.access[h];m.addInitializer=function(e){if(f)throw TypeError(`Cannot add initializers after decoration has completed`);a.push(o(e||null))};var g=(0,n[p])(s===`accessor`?{get:u.get,set:u.set}:u[c],m);if(s===`accessor`){if(g===void 0)continue;if(typeof g!=`object`||!g)throw TypeError(`Object expected`);(d=o(g.get))&&(u.get=d),(d=o(g.set))&&(u.set=d),(d=o(g.init))&&i.unshift(d)}else (d=o(g))&&(s===`field`?i.unshift(d):u[c]=d)}l&&Object.defineProperty(l,r.name,u),f=!0}function h(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0}function g(e){return typeof e==`symbol`?e:`${e}`}function _(e,t,n){return typeof t==`symbol`&&(t=t.description?`[${t.description}]`:``),Object.defineProperty(e,`name`,{configurable:!0,value:n?`${n} ${t}`:t})}function v(e,t){if(typeof Reflect==`object`&&typeof Reflect.metadata==`function`)return Reflect.metadata(e,t)}function y(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})}function ee(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o=Object.create((typeof Iterator==`function`?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),typeof Symbol==`function`&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return c([e,t])}}function c(s){if(r)throw TypeError(`Generator is already executing.`);for(;o&&(o=0,s[0]&&(n=0)),n;)try{if(r=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,i=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if((a=n.trys,!(a=a.length>0&&a[a.length-1]))&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){n.label=s[1];break}if(s[0]===6&&n.label<a[1]){n.label=a[1],a=s;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(s);break}a[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(e){s=[6,e],i=0}finally{r=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}function te(e,t){for(var n in e)n!==`default`&&!Object.prototype.hasOwnProperty.call(t,n)&&w(t,e,n)}function b(e){var t=typeof Symbol==`function`&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length==`number`)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?`Object is not iterable.`:`Symbol.iterator is not defined.`)}function ne(e,t){var n=typeof Symbol==`function`&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function re(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ne(arguments[t]));return e}function ie(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function x(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||=Array.prototype.slice.call(t,0,r),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function ae(e,t,n){if(!Symbol.asyncIterator)throw TypeError(`Symbol.asyncIterator is not defined.`);var r=n.apply(e,t||[]),i,a=[];return i=Object.create((typeof AsyncIterator==`function`?AsyncIterator:Object).prototype),s(`next`),s(`throw`),s(`return`,o),i[Symbol.asyncIterator]=function(){return this},i;function o(e){return function(t){return Promise.resolve(t).then(e,d)}}function s(e,t){r[e]&&(i[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||c(e,t)})},t&&(i[e]=t(i[e])))}function c(e,t){try{l(r[e](t))}catch(e){f(a[0][3],e)}}function l(e){e.value instanceof S?Promise.resolve(e.value.v).then(u,d):f(a[0][2],e)}function u(e){c(`next`,e)}function d(e){c(`throw`,e)}function f(e,t){e(t),a.shift(),a.length&&c(a[0][0],a[0][1])}}function oe(e){var t,n;return t={},r(`next`),r(`throw`,function(e){throw e}),r(`return`),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:S(e[r](t)),done:!1}:i?i(t):t}:i}}function se(e){if(!Symbol.asyncIterator)throw TypeError(`Symbol.asyncIterator is not defined.`);var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof b==`function`?b(e):e[Symbol.iterator](),n={},r(`next`),r(`throw`),r(`return`),n[Symbol.asyncIterator]=function(){return this},n);function r(t){n[t]=e[t]&&function(n){return new Promise(function(r,a){n=e[t](n),i(r,a,n.done,n.value)})}}function i(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}}function ce(e,t){return Object.defineProperty?Object.defineProperty(e,`raw`,{value:t}):e.raw=t,e}function le(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n=ye(e),r=0;r<n.length;r++)n[r]!==`default`&&w(t,e,n[r]);return ve(t,e),t}function ue(e){return e&&e.__esModule?e:{default:e}}function de(e,t,n,r){if(n===`a`&&!r)throw TypeError(`Private accessor was defined without a getter`);if(typeof t==`function`?e!==t||!r:!t.has(e))throw TypeError(`Cannot read private member from an object whose class did not declare it`);return n===`m`?r:n===`a`?r.call(e):r?r.value:t.get(e)}function fe(e,t,n,r,i){if(r===`m`)throw TypeError(`Private method is not writable`);if(r===`a`&&!i)throw TypeError(`Private accessor was defined without a setter`);if(typeof t==`function`?e!==t||!i:!t.has(e))throw TypeError(`Cannot write private member to an object whose class did not declare it`);return r===`a`?i.call(e,n):i?i.value=n:t.set(e,n),n}function pe(e,t){if(t===null||typeof t!=`object`&&typeof t!=`function`)throw TypeError(`Cannot use 'in' operator on non-object`);return typeof e==`function`?t===e:e.has(t)}function me(e,t,n){if(t!=null){if(typeof t!=`object`&&typeof t!=`function`)throw TypeError(`Object expected.`);var r,i;if(n){if(!Symbol.asyncDispose)throw TypeError(`Symbol.asyncDispose is not defined.`);r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw TypeError(`Symbol.dispose is not defined.`);r=t[Symbol.dispose],n&&(i=r)}if(typeof r!=`function`)throw TypeError(`Object not disposable.`);i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}function he(e){function t(t){e.error=e.hasError?new be(t,e.error,`An error was suppressed during disposal.`):t,e.hasError=!0}var n,r=0;function i(){for(;n=e.stack.pop();)try{if(!n.async&&r===1)return r=0,e.stack.push(n),Promise.resolve().then(i);if(n.dispose){var a=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(a).then(i,function(e){return t(e),i()})}else r|=1}catch(e){t(e)}if(r===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function ge(e,t){return typeof e==`string`&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,n,r,i,a){return n?t?`.jsx`:`.js`:r&&(!i||!a)?e:r+i+`.`+a.toLowerCase()+`js`}):e}var _e,C,w,ve,ye,be,xe,T=e((()=>{_e=function(e,t){return _e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},_e(e,t)},C=function(){return C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},C.apply(this,arguments)},w=Object.create?(function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||(`get`in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}):(function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),ve=Object.create?(function(e,t){Object.defineProperty(e,`default`,{enumerable:!0,value:t})}):function(e,t){e.default=t},ye=function(e){return ye=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},ye(e)},be=typeof SuppressedError==`function`?SuppressedError:function(e,t,n){var r=Error(n);return r.name=`SuppressedError`,r.error=e,r.suppressed=t,r},xe={__extends:u,__assign:C,__rest:d,__decorate:f,__param:p,__esDecorate:m,__runInitializers:h,__propKey:g,__setFunctionName:_,__metadata:v,__awaiter:y,__generator:ee,__createBinding:w,__exportStar:te,__values:b,__read:ne,__spread:re,__spreadArrays:ie,__spreadArray:x,__await:S,__asyncGenerator:ae,__asyncDelegator:oe,__asyncValues:se,__makeTemplateObject:ce,__importStar:le,__importDefault:ue,__classPrivateFieldGet:de,__classPrivateFieldSet:fe,__classPrivateFieldIn:pe,__addDisposableResource:me,__disposeResources:he,__rewriteRelativeImportExtension:ge}})),Se=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.isAgent=t,e.buildAgent=n;function t(e){return typeof e==`object`&&!!e&&`fetchHandler`in e&&typeof e.fetchHandler==`function`&&(!(`did`in e)||e.did===void 0||typeof e.did==`string`)}function n(e){if(t(e))return e;let n=typeof e==`string`||e instanceof URL?{did:void 0,service:e}:e,{service:i,fetch:a=globalThis.fetch}=n;if(typeof a!=`function`)throw TypeError(`fetch() is not available in this environment`);return{get did(){return n.did},async fetchHandler(e,t){let o=n.headers!=null&&t.headers!=null?r(n.headers,t.headers):n.headers||t.headers;return a(new URL(e,i),o===t.headers?t:{...t,headers:o})}}}function r(e,t){let n=new Headers(e),r=t instanceof Headers?t:new Headers(t);for(let[e,t]of r.entries())n.set(e,t);return n}}));function Ce(e,t,n){t||=[],n||=0;for(var r=n;e>=Oe;)t[n++]=e&255|Ee,e/=128;for(;e&De;)t[n++]=e&255|Ee,e>>>=7;return t[n]=e|0,Ce.bytes=n-r+1,t}function we(e,t){var n=0,t=t||0,r=0,i=t,a,o=e.length;do{if(i>=o)throw we.bytes=0,RangeError(`Could not decode varint`);a=e[i++],n+=r<28?(a&je)<<r:(a&je)*2**r,r+=7}while(a>=Ae);return we.bytes=i-t,n}var Te,Ee,De,Oe,ke,Ae,je,Me,Ne,Pe,Fe,Ie,Le,Re,ze,Be,Ve,E,He=e((()=>{Te=Ce,Ee=128,De=-128,Oe=2**31,ke=we,Ae=128,je=127,Me=2**7,Ne=2**14,Pe=2**21,Fe=2**28,Ie=2**35,Le=2**42,Re=2**49,ze=2**56,Be=2**63,Ve=function(e){return e<Me?1:e<Ne?2:e<Pe?3:e<Fe?4:e<Ie?5:e<Le?6:e<Re?7:e<ze?8:e<Be?9:10},E={encode:Te,decode:ke,encodingLength:Ve}})),Ue,D,O,We=e((()=>{He(),Ue=(e,t=0)=>[E.decode(e,t),E.decode.bytes],D=(e,t,n=0)=>(E.encode(e,t,n),t),O=e=>E.encodingLength(e)})),Ge,k,Ke,qe,A=e((()=>{new Uint8Array,Ge=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},k=e=>{if(e instanceof Uint8Array&&e.constructor.name===`Uint8Array`)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error(`Unknown type, must be binary type`)},Ke=e=>new TextEncoder().encode(e),qe=e=>new TextDecoder().decode(e)})),Je=t({Digest:()=>M,create:()=>j,decode:()=>Ye,equals:()=>Xe}),j,Ye,Xe,M,N=e((()=>{A(),We(),j=(e,t)=>{let n=t.byteLength,r=O(e),i=r+O(n),a=new Uint8Array(i+n);return D(e,a,0),D(n,a,r),a.set(t,i),new M(e,n,t,a)},Ye=e=>{let t=k(e),[n,r]=Ue(t),[i,a]=Ue(t.subarray(r)),o=t.subarray(r+a);if(o.byteLength!==i)throw Error(`Incorrect length`);return new M(n,i,o,t)},Xe=(e,t)=>e===t?!0:e.code===t.code&&e.size===t.size&&Ge(e.bytes,t.bytes),M=class{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}}));function Ze(e,t){if(e.length>=255)throw TypeError(`Alphabet too long`);for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),o=a.charCodeAt(0);if(n[o]!==255)throw TypeError(a+` is ambiguous`);n[o]=i}var s=e.length,c=e.charAt(0),l=Math.log(s)/Math.log(256),u=Math.log(256)/Math.log(s);function d(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError(`Expected Uint8Array`);if(t.length===0)return``;for(var n=0,r=0,i=0,a=t.length;i!==a&&t[i]===0;)i++,n++;for(var o=(a-i)*u+1>>>0,l=new Uint8Array(o);i!==a;){for(var d=t[i],f=0,p=o-1;(d!==0||f<r)&&p!==-1;p--,f++)d+=256*l[p]>>>0,l[p]=d%s>>>0,d=d/s>>>0;if(d!==0)throw Error(`Non-zero carry`);r=f,i++}for(var m=o-r;m!==o&&l[m]===0;)m++;for(var h=c.repeat(n);m<o;++m)h+=e.charAt(l[m]);return h}function f(e){if(typeof e!=`string`)throw TypeError(`Expected String`);if(e.length===0)return new Uint8Array;var t=0;if(e[t]!==` `){for(var r=0,i=0;e[t]===c;)r++,t++;for(var a=(e.length-t)*l+1>>>0,o=new Uint8Array(a);e[t];){var u=n[e.charCodeAt(t)];if(u===255)return;for(var d=0,f=a-1;(u!==0||d<i)&&f!==-1;f--,d++)u+=s*o[f]>>>0,o[f]=u%256>>>0,u=u/256>>>0;if(u!==0)throw Error(`Non-zero carry`);i=d,t++}if(e[t]!==` `){for(var p=a-i;p!==a&&o[p]===0;)p++;for(var m=new Uint8Array(r+(a-p)),h=r;p!==a;)m[h++]=o[p++];return m}}}function p(e){var n=f(e);if(n)return n;throw Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:f,decode:p}}var Qe,$e=e((()=>{Qe=Ze})),et,tt,nt,rt,it,P,F,at,ot,I,L=e((()=>{$e(),A(),et=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error(`Unknown type, must be binary type`)}},tt=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw Error(`Invalid prefix character`);this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e==`string`){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error(`Can only multibase decode strings`)}or(e){return rt(this,e)}},nt=class{constructor(e){this.decoders=e}or(e){return rt(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},rt=(e,t)=>new nt({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),it=class{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new et(e,t,n),this.decoder=new tt(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},P=({name:e,prefix:t,encode:n,decode:r})=>new it(e,t,n,r),F=({prefix:e,name:t,alphabet:n})=>{let{encode:r,decode:i}=Qe(n,t);return P({prefix:e,name:t,encode:r,decode:e=>k(i(e))})},at=(e,t,n,r)=>{let i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let a=e.length;for(;e[a-1]===`=`;)--a;let o=new Uint8Array(a*n/8|0),s=0,c=0,l=0;for(let t=0;t<a;++t){let a=i[e[t]];if(a===void 0)throw SyntaxError(`Non-${r} character`);c=c<<n|a,s+=n,s>=8&&(s-=8,o[l++]=255&c>>s)}if(s>=n||255&c<<8-s)throw SyntaxError(`Unexpected end of data`);return o},ot=(e,t,n)=>{let r=t[t.length-1]===`=`,i=(1<<n)-1,a=``,o=0,s=0;for(let r=0;r<e.length;++r)for(s=s<<8|e[r],o+=8;o>n;)o-=n,a+=t[i&s>>o];if(o&&(a+=t[i&s<<n-o]),r)for(;a.length*n&7;)a+=`=`;return a},I=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>P({prefix:t,name:e,encode(e){return ot(e,r,n)},decode(t){return at(t,r,n,e)}})})),st=t({base58btc:()=>R,base58flickr:()=>ct}),R,ct,lt=e((()=>{L(),R=F({name:`base58btc`,prefix:`z`,alphabet:`123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz`}),ct=F({name:`base58flickr`,prefix:`Z`,alphabet:`123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ`})})),ut=t({base32:()=>z,base32hex:()=>mt,base32hexpad:()=>gt,base32hexpadupper:()=>_t,base32hexupper:()=>ht,base32pad:()=>ft,base32padupper:()=>pt,base32upper:()=>dt,base32z:()=>vt}),z,dt,ft,pt,mt,ht,gt,_t,vt,yt=e((()=>{L(),z=I({prefix:`b`,name:`base32`,alphabet:`abcdefghijklmnopqrstuvwxyz234567`,bitsPerChar:5}),dt=I({prefix:`B`,name:`base32upper`,alphabet:`ABCDEFGHIJKLMNOPQRSTUVWXYZ234567`,bitsPerChar:5}),ft=I({prefix:`c`,name:`base32pad`,alphabet:`abcdefghijklmnopqrstuvwxyz234567=`,bitsPerChar:5}),pt=I({prefix:`C`,name:`base32padupper`,alphabet:`ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=`,bitsPerChar:5}),mt=I({prefix:`v`,name:`base32hex`,alphabet:`0123456789abcdefghijklmnopqrstuv`,bitsPerChar:5}),ht=I({prefix:`V`,name:`base32hexupper`,alphabet:`0123456789ABCDEFGHIJKLMNOPQRSTUV`,bitsPerChar:5}),gt=I({prefix:`t`,name:`base32hexpad`,alphabet:`0123456789abcdefghijklmnopqrstuv=`,bitsPerChar:5}),_t=I({prefix:`T`,name:`base32hexpadupper`,alphabet:`0123456789ABCDEFGHIJKLMNOPQRSTUV=`,bitsPerChar:5}),vt=I({prefix:`h`,name:`base32z`,alphabet:`ybndrfg8ejkmcpqxot1uwisza345h769`,bitsPerChar:5})})),bt=t({CID:()=>xt}),xt,St,Ct,wt,B,Tt,Et,Dt,V,H,Ot,kt,At,jt=e((()=>{We(),N(),lt(),yt(),A(),xt=class e{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this.byteOffset=r.byteOffset,this.byteLength=r.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:H,byteLength:H,code:V,version:V,multihash:V,bytes:V,_baseCache:H,asCID:H})}toV0(){switch(this.version){case 0:return this;default:{let{code:t,multihash:n}=this;if(t!==B)throw Error(`Cannot convert a non dag-pb CID to CIDv0`);if(n.code!==Tt)throw Error(`Cannot convert non sha2-256 multihash CID to CIDv0`);return e.createV0(n)}}}toV1(){switch(this.version){case 0:{let{code:t,digest:n}=this.multihash,r=j(t,n);return e.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Xe(this.multihash,e.multihash)}toString(e){let{bytes:t,version:n,_baseCache:r}=this;switch(n){case 0:return Ct(t,r,e||R.encoder);default:return wt(t,r,e||z.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return`CID`}[Symbol.for(`nodejs.util.inspect.custom`)](){return`CID(`+this.toString()+`)`}static isCID(e){return kt(/^0\.0/,At),!!(e&&(e[Dt]||e.asCID===e))}get toBaseEncodedString(){throw Error(`Deprecated, use .toString()`)}get codec(){throw Error(`"codec" property is deprecated, use integer "code" property instead`)}get buffer(){throw Error(`Deprecated .buffer property, use .bytes to get Uint8Array instead`)}get multibaseName(){throw Error(`"multibaseName" property is deprecated`)}get prefix(){throw Error(`"prefix" property is deprecated`)}static asCID(t){if(t instanceof e)return t;if(t!=null&&t.asCID===t){let{version:n,code:r,multihash:i,bytes:a}=t;return new e(n,r,i,a||Et(n,r,i.bytes))}else if(t!=null&&t[Dt]===!0){let{version:n,multihash:r,code:i}=t,a=Ye(r);return e.create(n,i,a)}else return null}static create(t,n,r){if(typeof n!=`number`)throw Error(`String codecs are no longer supported`);switch(t){case 0:if(n!==B)throw Error(`Version 0 CID must use dag-pb (code: ${B}) block encoding`);return new e(t,n,r,r.bytes);case 1:return new e(t,n,r,Et(t,n,r.bytes));default:throw Error(`Invalid version`)}}static createV0(t){return e.create(0,B,t)}static createV1(t,n){return e.create(1,t,n)}static decode(t){let[n,r]=e.decodeFirst(t);if(r.length)throw Error(`Incorrect length`);return n}static decodeFirst(t){let n=e.inspectBytes(t),r=n.size-n.multihashSize,i=k(t.subarray(r,r+n.multihashSize));if(i.byteLength!==n.multihashSize)throw Error(`Incorrect length`);let a=i.subarray(n.multihashSize-n.digestSize),o=new M(n.multihashCode,n.digestSize,a,i);return[n.version===0?e.createV0(o):e.createV1(n.codec,o),t.subarray(n.size)]}static inspectBytes(e){let t=0,n=()=>{let[n,r]=Ue(e.subarray(t));return t+=r,n},r=n(),i=B;if(r===18?(r=0,t=0):r===1&&(i=n()),r!==0&&r!==1)throw RangeError(`Invalid CID version ${r}`);let a=t,o=n(),s=n(),c=t+s,l=c-a;return{version:r,codec:i,multihashCode:o,digestSize:s,multihashSize:l,size:c}}static parse(t,n){let[r,i]=St(t,n),a=e.decode(i);return a._baseCache.set(r,t),a}},St=(e,t)=>{switch(e[0]){case`Q`:{let n=t||R;return[R.prefix,n.decode(`${R.prefix}${e}`)]}case R.prefix:{let n=t||R;return[R.prefix,n.decode(e)]}case z.prefix:{let n=t||z;return[z.prefix,n.decode(e)]}default:if(t==null)throw Error(`To parse non base32 or base58btc encoded CID multibase decoder must be provided`);return[e[0],t.decode(e)]}},Ct=(e,t,n)=>{let{prefix:r}=n;if(r!==R.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);let i=t.get(r);if(i==null){let i=n.encode(e).slice(1);return t.set(r,i),i}else return i},wt=(e,t,n)=>{let{prefix:r}=n,i=t.get(r);if(i==null){let i=n.encode(e);return t.set(r,i),i}else return i},B=112,Tt=18,Et=(e,t,n)=>{let r=O(e),i=r+O(t),a=new Uint8Array(i+n.byteLength);return D(e,a,0),D(t,a,r),a.set(n,i),a},Dt=Symbol.for(`@ipld/js-cid/CID`),V={writable:!1,configurable:!1,enumerable:!0},H={writable:!1,enumerable:!1,configurable:!1},Ot=`0.0.0-dev`,kt=(e,t)=>{if(e.test(Ot))console.warn(t);else throw Error(t)},At=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`})),Mt,Nt,Pt=e((()=>{N(),Mt=({name:e,code:t,encode:n})=>new Nt(e,t,n),Nt=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?j(this.code,t):t.then(e=>j(this.code,e))}else throw Error(`Unknown type, must be binary type`)}}})),Ft=t({sha256:()=>Lt,sha512:()=>Rt}),It,Lt,Rt,zt=e((()=>{Pt(),It=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Lt=Mt({name:`sha2-256`,code:18,encode:It(`SHA-256`)}),Rt=Mt({name:`sha2-512`,code:19,encode:It(`SHA-512`)})})),U=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.isObject=t,e.isPlainObject=i,e.isPlainProto=a;function t(e){return typeof e==`object`&&!!e}var n=Object.prototype,r=Object.prototype.toString;function i(e){return t(e)&&a(e)}function a(e){let t=Object.getPrototypeOf(e);return t===null?!0:(t===n||Object.getPrototypeOf(t)===null)&&r.call(e)===`[object Object]`}})),W=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.NodeJSBuffer=void 0;var t=`Bu`+`f`.repeat(2)+`er`;e.NodeJSBuffer=globalThis?.[t]?.prototype instanceof Uint8Array&&`byteLength`in globalThis[t]?globalThis[t]:null})),Bt=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.ui8ConcatNode=void 0,e.ui8ConcatPonyfill=n;var t=W().NodeJSBuffer;e.ui8ConcatNode=t?function(e){return t.concat(e)}:null;function n(e){let t=0;for(let n of e)t+=n.length;let n=new Uint8Array(t),r=0;for(let t of e)n.set(t,r),r+=t.length;return n}})),Vt=t({identity:()=>Ht}),Ht,Ut=e((()=>{L(),A(),Ht=P({prefix:`\0`,name:`identity`,encode:e=>qe(e),decode:e=>Ke(e)})})),Wt=t({base2:()=>Gt}),Gt,Kt=e((()=>{L(),Gt=I({prefix:`0`,name:`base2`,alphabet:`01`,bitsPerChar:1})})),qt=t({base8:()=>Jt}),Jt,Yt=e((()=>{L(),Jt=I({prefix:`7`,name:`base8`,alphabet:`01234567`,bitsPerChar:3})})),Xt=t({base10:()=>Zt}),Zt,Qt=e((()=>{L(),Zt=F({prefix:`9`,name:`base10`,alphabet:`0123456789`})})),$t=t({base16:()=>en,base16upper:()=>tn}),en,tn,nn=e((()=>{L(),en=I({prefix:`f`,name:`base16`,alphabet:`0123456789abcdef`,bitsPerChar:4}),tn=I({prefix:`F`,name:`base16upper`,alphabet:`0123456789ABCDEF`,bitsPerChar:4})})),rn=t({base36:()=>an,base36upper:()=>on}),an,on,sn=e((()=>{L(),an=F({prefix:`k`,name:`base36`,alphabet:`0123456789abcdefghijklmnopqrstuvwxyz`}),on=F({prefix:`K`,name:`base36upper`,alphabet:`0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ`})})),cn=t({base64:()=>ln,base64pad:()=>un,base64url:()=>dn,base64urlpad:()=>fn}),ln,un,dn,fn,pn=e((()=>{L(),ln=I({prefix:`m`,name:`base64`,alphabet:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/`,bitsPerChar:6}),un=I({prefix:`M`,name:`base64pad`,alphabet:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=`,bitsPerChar:6}),dn=I({prefix:`u`,name:`base64url`,alphabet:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_`,bitsPerChar:6}),fn=I({prefix:`U`,name:`base64urlpad`,alphabet:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=`,bitsPerChar:6})})),mn=t({base256emoji:()=>bn});function hn(e){return e.reduce((e,t)=>(e+=vn[t],e),``)}function gn(e){let t=[];for(let n of e){let e=yn[n.codePointAt(0)];if(e===void 0)throw Error(`Non-base256emoji character: ${n}`);t.push(e)}return new Uint8Array(t)}var _n,vn,yn,bn,xn=e((()=>{L(),_n=Array.from(`ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚`),vn=_n.reduce((e,t,n)=>(e[n]=t,e),[]),yn=_n.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]),bn=P({prefix:`ðŸš€`,name:`base256emoji`,encode:hn,decode:gn})})),Sn=t({identity:()=>Dn}),Cn,wn,Tn,En,Dn,On=e((()=>{A(),N(),Cn=0,wn=`identity`,Tn=k,En=e=>j(Cn,Tn(e)),Dn={code:Cn,name:wn,encode:Tn,digest:En}})),kn=e((()=>{A()})),An=e((()=>{new TextEncoder,new TextDecoder})),jn=e((()=>{jt(),We(),A(),Pt(),N()})),Mn,Nn=e((()=>{Ut(),Kt(),Yt(),Qt(),nn(),yt(),sn(),lt(),pn(),xn(),zt(),On(),kn(),An(),jn(),Mn={...Vt,...Wt,...qt,...Xt,...$t,...ut,...rn,...st,...cn,...mn},{...Ft,...Sn}}));function Pn(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}var Fn,In,Ln,Rn=e((()=>{Nn(),Fn=Pn(`utf8`,`u`,e=>`u`+new TextDecoder(`utf8`).decode(e),e=>new TextEncoder().encode(e.substring(1))),In=Pn(`ascii`,`a`,e=>{let t=`a`;for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),Ln={utf8:Fn,"utf-8":Fn,hex:Mn.base16,latin1:In,ascii:In,binary:In,...Mn}})),zn=t({fromString:()=>Bn});function Bn(e,t=`utf8`){let n=Ln[t];if(!n)throw Error(`Unsupported encoding "${t}"`);return n.decoder.decode(`${n.prefix}${e}`)}var Vn=e((()=>{Rn()})),Hn=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.fromBase64Node=e.fromBase64Native=void 0,e.fromBase64Ponyfill=i;var t=(Vn(),n(zn)),r=W().NodeJSBuffer;e.fromBase64Native=typeof Uint8Array.fromBase64==`function`?function(e,t=`base64`){return Uint8Array.fromBase64(e,{alphabet:t,lastChunkHandling:`loose`})}:null,e.fromBase64Node=r?function(e,t=`base64`){let n=r.from(e,t);return a(e,n),new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}:null;function i(e,n=`base64`){let r=(0,t.fromString)(e,e.endsWith(`=`)?`${n}pad`:n);return a(e,r),r}function a(e,t){let n=e.endsWith(`==`)?2:e.endsWith(`=`)?1:0,r=e.length-n,i=Math.floor(r*3/4);if(t.length!==i)throw Error(`Invalid base64 string`);let a=t.length/3*4,o=a+(a%4==0?0:4-a%4);if(e.length>o)throw Error(`Invalid base64 string`);for(let t=Math.ceil(a);t<e.length-n;t++){let n=e.charCodeAt(t);if(!(n>=65&&n<=90)&&!(n>=97&&n<=122)&&!(n>=48&&n<=57)&&n!==43&&n!==47)throw Error(`Invalid base64 string`)}}})),Un=t({toString:()=>Wn});function Wn(e,t=`utf8`){let n=Ln[t];if(!n)throw Error(`Unsupported encoding "${t}"`);return n.encoder.encode(e).substring(1)}var Gn=e((()=>{Rn()})),Kn=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.toBase64Node=e.toBase64Native=void 0,e.toBase64Ponyfill=i;var t=(Gn(),n(Un)),r=W().NodeJSBuffer;e.toBase64Native=typeof Uint8Array.prototype.toBase64==`function`?function(e,t=`base64`){return e.toBase64({alphabet:t,omitPadding:!0})}:null,e.toBase64Node=r?function(e,t=`base64`){let n=(e instanceof r?e:r.from(e)).toString(t);return n.charCodeAt(n.length-1)===61?n.charCodeAt(n.length-2)===61?n.slice(0,-2):n.slice(0,-1):n}:null;function i(e,n=`base64`){return(0,t.toString)(e,n)}})),qn=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.ui8Concat=e.fromBase64=e.toBase64=void 0,e.ifUint8Array=i,e.asUint8Array=a,e.ui8Equals=o;var t=Bt(),n=Hn(),r=Kn();e.toBase64=r.toBase64Native??r.toBase64Node??r.toBase64Ponyfill,e.fromBase64=n.fromBase64Native??n.fromBase64Node??n.fromBase64Ponyfill,e.toBase64===r.toBase64Ponyfill||(e.fromBase64,n.fromBase64Ponyfill);function i(e){if(e instanceof Uint8Array)return e}function a(e){if(e instanceof Uint8Array)return e;if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT);if(e instanceof ArrayBuffer)return new Uint8Array(e)}function o(e,t){if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}e.ui8Concat=t.ui8ConcatNode??t.ui8ConcatPonyfill})),Jn=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.CID=e.SHA512_HASH_CODE=e.SHA256_HASH_CODE=e.RAW_DATA_CODEC=e.CBOR_DATA_CODEC=void 0,e.multihashEquals=s,e.asMultiformatsCID=c,e.isRawCid=l,e.isDaslCid=u,e.isCborCid=d,e.checkCid=f,e.isCid=p,e.ifCid=m,e.asCid=h,e.decodeCid=g,e.parseCid=_,e.validateCidString=v,e.parseCidSafe=y,e.ensureValidCidString=ee,e.isCidForBytes=te,e.createCid=b,e.cidForCbor=ne,e.cidForRawBytes=re,e.cidForRawHash=ie;var t=(jt(),n(bt));Object.defineProperty(e,`CID`,{enumerable:!0,get:function(){return t.CID}});var r=(N(),n(Je)),i=(zt(),n(Ft)),a=U(),o=qn();e.CBOR_DATA_CODEC=113,e.RAW_DATA_CODEC=85,e.SHA256_HASH_CODE=i.sha256.code,e.SHA512_HASH_CODE=i.sha512.code;function s(e,t){return e===t?!0:e.code===t.code&&(0,o.ui8Equals)(e.digest,t.digest)}function c(e){return t.CID.asCID(e)??t.CID.create(e.version,e.code,(0,r.create)(e.multihash.code,e.multihash.digest))}function l(t){return t.version===1&&t.code===e.RAW_DATA_CODEC}function u(t){return t.version===1&&(t.code===e.RAW_DATA_CODEC||t.code===e.CBOR_DATA_CODEC)&&t.multihash.code===e.SHA256_HASH_CODE&&t.multihash.digest.byteLength===32}function d(t){return t.code===e.CBOR_DATA_CODEC&&u(t)}function f(e,t){switch(t?.flavor){case void 0:return!0;case`cbor`:return d(e);case`dasl`:return u(e);case`raw`:return l(e);default:throw TypeError(`Unknown CID flavor: ${t?.flavor}`)}}function p(e,t){return x(e)&&f(e,t)}function m(e,t){return x(e)&&f(e,t)?e:null}function h(e,t){if(x(e)&&f(e,t))return e;throw Error(`Not a valid CID`)}function g(e,n){return h(t.CID.decode(e),n)}function _(e,n){return h(t.CID.parse(e),n)}function v(e,t){return y(e,t)?.toString()===e}function y(e,t){try{return _(e,t)}catch{return null}}function ee(e,t){if(!v(e,t))throw Error(`Invalid CID string`)}async function te(e,t){if(e.multihash.code===i.sha256.code)return s(await i.sha256.digest(t),e.multihash);if(e.multihash.code===i.sha512.code)return s(await i.sha512.digest(t),e.multihash);throw Error(`Unsupported CID multihash`)}function b(e,n,i){return t.CID.createV1(e,(0,r.create)(n,i))}async function ne(n){let r=await i.sha256.digest(n);return t.CID.createV1(e.CBOR_DATA_CODEC,r)}async function re(n){let r=await i.sha256.digest(n);return t.CID.createV1(e.RAW_DATA_CODEC,r)}function ie(t){if(t.length!==32)throw Error(`Invalid SHA-256 hash length: ${t.length}`);return b(e.RAW_DATA_CODEC,i.sha256.code,t)}function x(e){if(t.CID.asCID(e))return e.bytes!=null;try{if(!(0,a.isObject)(e))return!1;let t=e;if(t.version!==0&&t.version!==1||!S(t.code)||!(0,a.isObject)(t.multihash))return!1;let n=t.multihash;return!(!S(n.code)||!(n.digest instanceof Uint8Array)||!(t.bytes instanceof Uint8Array)||t.bytes[0]!==t.version||t.bytes[1]!==t.code||t.bytes[2]!==n.code||t.bytes[3]!==n.digest.length||t.bytes.length!==4+n.digest.length||!(0,o.ui8Equals)(t.bytes.subarray(4),n.digest)||typeof t.equals!=`function`||t.equals(t)!==!0)}catch{return!1}}function S(e){return Number.isInteger(e)&&e>=0&&e<256}})),Yn=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.isBlobRef=r,e.isLegacyBlobRef=i,e.enumBlobRefs=a;var t=Jn(),n=U();function r(e,r){if(!(0,n.isPlainObject)(e)||e?.$type!==`blob`)return!1;let{mimeType:i,size:a,ref:o}=e;if(typeof i!=`string`||!i.includes(`/`)||typeof a!=`number`||a<0||!Number.isSafeInteger(a)||typeof o!=`object`||!o)return!1;for(let t in e)if(t!==`$type`&&t!==`mimeType`&&t!==`ref`&&t!==`size`)return!1;return!!(0,t.ifCid)(o,r?.strict===!1?void 0:{flavor:`raw`})}function i(e){if(!(0,n.isPlainObject)(e))return!1;let{cid:r,mimeType:i}=e;if(typeof r!=`string`||typeof i!=`string`||i.length===0)return!1;for(let t in e)if(t!==`cid`&&t!==`mimeType`)return!1;return!!(0,t.validateCidString)(r)}function*a(e,t){let a=t?.allowLegacy===!0,o=[e],s=new Set;do{let e=o.pop();if(typeof e==`object`&&e){if(Array.isArray(e)){if(s.has(e))continue;s.add(e),o.push(...e)}else if((0,n.isPlainProto)(e)){if(s.has(e))continue;if(s.add(e),r(e,t))yield e;else if(a&&i(e))yield e;else for(let t of Object.values(e))t!=null&&o.push(t)}}}while(o.length>0);s.clear()}})),Xn=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.lexEquals=i;var t=Jn(),n=U(),r=qn();function i(e,a){if(Object.is(e,a))return!0;if(e==null||a==null||typeof e!=`object`||typeof a!=`object`)return!1;if(Array.isArray(e)){if(!Array.isArray(a)||e.length!==a.length)return!1;for(let t=0;t<e.length;t++)if(!i(e[t],a[t]))return!1;return!0}else if(Array.isArray(a))return!1;if(ArrayBuffer.isView(e))return ArrayBuffer.isView(a)?(0,r.ui8Equals)(e,a):!1;if(ArrayBuffer.isView(a))return!1;if((0,t.isCid)(e))return(0,t.ifCid)(a)?.equals(e)===!0;if((0,t.isCid)(a))return!1;if(!(0,n.isPlainObject)(e)||!(0,n.isPlainObject)(a))throw TypeError(`Invalid LexValue (expected CID, Uint8Array, or LexMap)`);let o=Object.keys(e),s=Object.keys(a);if(o.length!==s.length)return!1;for(let t of o){let n=e[t],r=a[t];if(n===void 0){if(r===void 0&&s.includes(t))continue;return!1}else if(r===void 0)return!1;if(!i(n,r))return!1}return!0}})),Zn=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.LexError=void 0,e.LexError=class extends Error{error;name=`LexError`;constructor(e,t,n){super(t,n),this.error=e}toString(){return`${this.name}: [${this.error}] ${this.message}`}toJSON(){let{error:e,message:t}=this;return{error:e,message:t||void 0}}toResponse(){return Response.json(this.toJSON(),{status:400})}}})),Qn=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.isLexMap=r,e.isLexArray=i,e.isLexScalar=a,e.isLexValue=o,e.isTypedLexMap=s;var t=Jn(),n=U();function r(e){return(0,n.isPlainObject)(e)&&Object.values(e).every(o)}function i(e){return Array.isArray(e)&&e.every(o)}function a(e){switch(typeof e){case`object`:return e===null||e instanceof Uint8Array||(0,t.isCid)(e);case`string`:case`boolean`:return!0;case`number`:if(Number.isInteger(e))return!0;default:return!1}}function o(e){let t=[e],r=new Set;do{let e=t.pop();if((0,n.isPlainObject)(e)){if(r.has(e))return!1;r.add(e),t.push(...Object.values(e))}else if(Array.isArray(e)){if(r.has(e))return!1;r.add(e),t.push(...e)}else if(!a(e))return!1}while(t.length>0);return r.clear(),!0}function s(e){return r(e)&&typeof e.$type==`string`&&e.$type.length>0}})),$n=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.utf8FromBase64Node=void 0,e.utf8FromBase64Ponyfill=a;var t=(Vn(),n(zn)),r=W().NodeJSBuffer;e.utf8FromBase64Node=r?function(e,t=`base64`){return r.from(e,t).toString(`utf8`)}:null;var i=new TextDecoder;function a(e,n){let r=(0,t.fromString)(e,n);return i.decode(r)}})),er=r((e=>{e.decodeUnicodeData=t,e.findUnicodeRangeIndex=n;function t(e,t=``){let n=[],r=e.split(`,`).map(e=>e?parseInt(e,36):0),i=0;for(let e=0;e<r.length;e++)e%2?n.push([i,i+r[e],t?parseInt(t[e>>1],36):0]):i=r[e];return n}function n(e,t,n=0,r=t.length-1){for(;n<=r;){let i=n+r>>>1,a=t[i];if(e<a[0])r=i-1;else if(e>a[1])n=i+1;else return i}return-1}})),tr=r((e=>{e.grapheme_ranges=e.GraphemeCategory=void 0;var t=er();e.GraphemeCategory={Any:0,CR:1,Control:2,Extend:3,Extended_Pictographic:4,L:5,LF:6,LV:7,LVT:8,Prepend:9,Regional_Indicator:10,SpacingMark:11,T:12,V:13,ZWJ:14},e.grapheme_ranges=(0,t.decodeUnicodeData)(`,9,a,,b,1,d,,e,h,3j,w,4p,,4t,,4u,,lc,33,w3,6,13l,18,14v,,14x,1,150,1,153,,16o,5,174,a,17g,,18r,k,19s,,1cm,6,1ct,,1cv,5,1d3,1,1d6,3,1e7,,1e9,,1f4,q,1ie,a,1kb,8,1kt,,1li,3,1ln,8,1lx,2,1m1,4,1nd,2,1ow,1,1p3,8,1qi,n,1r6,,1r7,v,1s3,,1tm,,1tn,,1to,,1tq,2,1tt,7,1u1,3,1u5,,1u6,1,1u9,6,1uq,1,1vl,,1vm,1,1x8,,1xa,,1xb,1,1xd,3,1xj,1,1xn,1,1xp,,1xz,,1ya,1,1z2,,1z5,1,1z7,,20s,,20u,2,20x,1,213,1,217,2,21d,,228,1,22d,,22p,1,22r,,24c,,24e,2,24h,4,24n,1,24p,,24r,1,24t,,25e,1,262,5,269,,26a,1,27w,,27y,1,280,,281,3,287,1,28b,1,28d,,28l,2,28y,1,29u,,2bi,,2bj,,2bk,,2bl,1,2bq,2,2bu,2,2bx,,2c7,,2dc,,2dd,2,2dg,,2f0,,2f2,2,2f5,3,2fa,2,2fe,3,2fp,1,2g2,1,2gx,,2gy,1,2ik,,2im,,2in,1,2ip,,2iq,,2ir,1,2iu,2,2iy,3,2j9,1,2jm,1,2k3,,2kg,1,2ki,1,2m3,1,2m6,,2m7,1,2m9,3,2me,2,2mi,2,2ml,,2mm,,2mv,,2n6,1,2o1,,2o2,1,2q2,,2q7,,2q8,1,2qa,2,2qe,,2qg,6,2qn,,2r6,1,2sx,,2sz,,2t0,6,2tj,7,2wh,,2wj,,2wk,8,2x4,6,2zc,1,305,,307,,309,,30e,1,31t,d,327,,328,4,32e,1,32l,a,32x,z,346,,371,3,375,,376,5,37d,1,37f,1,37h,1,386,1,388,1,38e,2,38x,3,39e,,39g,,39h,1,39p,,3a5,,3cw,2n,3fk,1z,3hk,2f,3tp,2,4k2,3,4ky,2,4lu,1,4mq,1,4ok,1,4om,,4on,6,4ou,7,4p2,,4p3,1,4p5,a,4pp,,4qz,2,4r2,,4r3,,4ud,1,4vd,,4yo,2,4yr,3,4yv,1,4yx,2,4z4,1,4z6,,4z7,5,4zd,2,55j,1,55l,1,55n,,579,,57a,,57b,,57c,6,57k,,57m,,57p,7,57x,5,583,9,58f,,59s,u,5c0,3,5c4,,5dg,9,5dq,3,5du,2,5ez,8,5fk,1,5fm,,5gh,,5gi,3,5gm,1,5go,5,5ie,,5if,,5ig,1,5ii,2,5il,,5im,,5in,4,5k4,7,5kc,7,5kk,1,5km,1,5ow,2,5p0,c,5pd,,5pe,6,5pp,,5pw,,5pz,,5q0,1,5vk,1r,6bv,,6bw,,6bx,,6by,1,6co,6,6d8,,6dl,,6e8,f,6hc,w,6jm,,6k9,,6ms,5,6nd,1,6xm,1,6y0,,70o,,72n,,73d,a,73s,2,79e,,7fu,1,7g6,,7gg,,7i3,3,7i8,5,7if,b,7is,35,7m8,39,7pk,a,7pw,,7py,,7q5,,7q9,,7qg,,7qr,1,7r8,,7rb,,7rg,,7ri,,7rn,2,7rr,,7s3,4,7th,2,7tt,,7u8,,7un,,850,1,8hx,2,8ij,1,8k0,,8k5,,8vj,2,8zj,,928,v,wvj,3,wvo,9,wwu,1,wz4,1,x6q,,x6u,,x6z,,x7n,1,x7p,1,x7r,,x7w,,xa8,1,xbo,f,xc4,1,xcw,h,xdr,,xeu,7,xfr,a,xg2,,xg3,,xgg,s,xhc,2,xhf,,xir,,xis,1,xiu,3,xiy,1,xj0,1,xj2,1,xj4,,xk5,,xm1,5,xm7,1,xm9,1,xmb,1,xmd,1,xmr,,xn0,,xn1,,xoc,,xps,,xpu,2,xpz,1,xq6,1,xq9,,xrf,,xrg,1,xri,1,xrp,,xrq,,xyb,1,xyd,,xye,1,xyg,,xyh,1,xyk,,xyl,,1e68,f,1e74,f,1edb,,1ehq,1,1ek0,b,1eyl,,1f4w,,1f92,4,1gjl,2,1gjp,1,1gjw,3,1gl4,2,1glb,,1gpx,1,1h5w,3,1h7t,4,1hgr,1,1hj0,3,1hl2,a,1hmq,3,1hq8,,1hq9,,1hqa,,1hrs,e,1htc,,1htf,1,1htr,2,1htu,,1hv4,2,1hv7,3,1hvb,1,1hvd,1,1hvh,,1hvm,,1hvx,,1hxc,2,1hyf,4,1hyk,,1hyl,7,1hz9,1,1i0j,,1i0w,1,1i0y,,1i2b,2,1i2e,8,1i2n,,1i2o,,1i2q,1,1i2x,3,1i32,,1i33,,1i5o,2,1i5r,2,1i5u,1,1i5w,3,1i66,,1i69,,1ian,,1iao,2,1iar,7,1ibk,1,1ibm,1,1id7,1,1ida,,1idb,,1idc,,1idd,3,1idj,1,1idn,1,1idp,,1idz,,1iea,1,1iee,6,1ieo,4,1igo,,1igp,1,1igr,5,1igy,,1ih1,,1ih3,2,1ih6,,1ih8,1,1iha,2,1ihd,,1ihe,,1iht,1,1ik5,2,1ik8,7,1ikg,1,1iki,2,1ikl,,1ikm,,1ila,,1ink,,1inl,1,1inn,5,1int,,1inu,,1inv,1,1inx,,1iny,,1inz,1,1io1,,1io2,1,1iun,,1iuo,1,1iuq,3,1iuw,3,1iv0,1,1iv2,,1iv3,1,1ivw,1,1iy8,2,1iyb,7,1iyj,1,1iyl,,1iym,,1iyn,1,1j1n,,1j1o,,1j1p,,1j1q,1,1j1s,7,1j4t,,1j4u,,1j4v,,1j4y,3,1j52,,1j53,4,1jcc,2,1jcf,8,1jco,,1jcp,1,1jjk,,1jjl,4,1jjr,1,1jjv,3,1jjz,,1jk0,,1jk1,,1jk2,,1jk3,,1jo1,2,1jo4,3,1joa,1,1joc,3,1jog,,1jok,,1jpd,9,1jqr,5,1jqx,,1jqy,,1jqz,3,1jrb,,1jrl,5,1jrr,1,1jrt,2,1jt0,5,1jt6,c,1jtj,,1jtk,1,1k4v,,1k4w,6,1k54,5,1k5a,,1k5b,,1k7m,l,1k89,,1k8a,6,1k8h,,1k8i,1,1k8k,,1k8l,1,1kc1,5,1kca,,1kcc,1,1kcf,6,1kcm,,1kcn,,1kei,4,1keo,1,1ker,1,1ket,,1keu,,1kev,,1koj,1,1kol,1,1kow,1,1koy,,1koz,,1kqc,1,1kqe,4,1kqm,1,1kqo,2,1kre,,1ovk,f,1ow0,,1ow7,e,1xr2,b,1xre,2,1xrh,2,1zow,4,1zqo,6,206b,,206f,3,20jz,,20k1,1i,20lr,3,20o4,,20og,1,2ftp,1,2fts,3,2jgg,19,2jhs,m,2jxh,4,2jxp,5,2jxv,7,2jy3,7,2jyd,6,2jze,3,2k3m,2,2lmo,1i,2lob,1d,2lpx,,2lqc,,2lqz,4,2lr5,e,2mtc,6,2mtk,g,2mu3,6,2mub,1,2mue,4,2mxb,,2n1s,6,2nce,,2ne4,3,2nsc,3,2nzi,1,2ok0,6,2on8,6,2pz4,73,2q6l,2,2q7j,,2q98,5,2q9q,1,2qa6,,2qa9,9,2qb1,1k,2qcm,p,2qdd,e,2qe2,,2qen,,2qeq,8,2qf0,3,2qfd,c1,2qrf,4,2qrk,8t,2r0m,7d,2r9c,3j,2rg4,b,2rit,16,2rkc,3,2rm0,7,2rmi,5,2rns,7,2rou,29,2rrg,1a,2rss,9,2rt3,c8,2scg,sd,jny8,v,jnz4,2n,jo1s,3j,jo5c,6n,joc0,2rz`,`262122424333333393233393339333333333393393b3b3b3b3b333b33b3bb33333b3b3333333b3b33bb3333b33b3bb33333b3bbb333b333b33333b3b3b3b3333b3b33b3bb39333b33b33b3b3b333b333333b3b333333b33b3b3333b3335dc333333b3b3b33323333b3bb3b33b3b3b3333b3333b3b333bb3b33b3b3b3b3b333b333b3323e2244234444444444444444444444444444444444444444443333333333b3b3bb33333b353b3b3b3b333b3b333b333333b3bb3b3b3bb333232333333333333333b3b3333bb3b393933b3b33bb3b393b3b3b3333b33b33b3bbb33b333b3333bb3933b3b3b333b3b3b3b3b33b3b3b33b3b3b33b3b33b33b3b3b33bb39b9b3b33b3b33b9333b393b3b33b33b3b3b3333393b3b3b33b39bb3b332333b333dd3b33332333323333333333333333333333344444444a44444434444444444444423232`)})),nr=r((e=>{e.consonant_ranges=void 0,e.consonant_ranges=(0,er().decodeUnicodeData)(`1sl,10,1ug,7,1vc,7,1w5,j,1wq,6,1wy,,1x2,3,1y4,1,1y7,,1yo,1,239,j,23u,6,242,1,245,4,261,,26t,j,27e,6,27m,1,27p,4,28s,1,28v,,29d,,2dx,j,2ei,f,2fs,2,2l1,11`)})),rr=r((e=>{e.countGrapheme=e.countGraphemes=o,e.graphemeSegments=a,e.splitGraphemes=s;var t=er(),n=tr();e.GraphemeCategory=n.GraphemeCategory;var r=nr(),i=65535;function*a(e){let t=e.codePointAt(0);if(t==null)return;let n=t<=i?1:2,r=e.length,a=h(t),o=0,s=0,c=!1,l=!1,u=!1,d=0,f=a,p=t;for(;n<r;){t=e.codePointAt(n),o=h(t);let r=!0;a===1?r=o!==6:a===2||a===6||o===1||o===2||o===6?r=!0:o===3||o===14||o===11||a===9?r=!1:a===14&&o===4?r=!c:a===10&&o===10?r=s++%2==1:a===5?r=!(o===5||o===13||o===7||o===8):((a===7||a===13)&&(o===13||o===12)||(a===8||a===12)&&o===12||o===0&&l&&u&&g(t))&&(r=!1),r?(yield{segment:e.slice(d,n),index:d,input:e,_hd:p,_catBegin:f,_catEnd:a},c=!1,s=0,d=n,f=o,p=t):o===14&&(a===3||a===4)?c=!0:t>=2325&&(!l&&a===0&&(l=g(p)),u=l&&o===3?u||t===2381||t===2509||t===2637||t===2765||t===2893||t===3149||t===3405:!1),n+=t<=i?1:2,a=o}d<r&&(yield{segment:e.slice(d),index:d,input:e,_hd:p,_catBegin:f,_catEnd:a})}function o(e){let t=0;for(let n of a(e))t+=1;return t}function*s(e){for(let t of a(e))yield t.segment}var c=new Uint8Array(6080),l=128,u=12287,d=new Uint8Array(1536),f=40960,p=44031,m=(()=>{let e=0;for(;;){let[t,r,i]=n.grapheme_ranges[e];if(t>p)break;if(e++,!(r<l||t>u&&r<f))for(let e=t;e<=r;e++){let t,n=0;e<=u?(t=c,n=e-l>>1):(t=d,n=e-f>>1),t[n]=e&1?t[n]&15|i<<4:t[n]&240|i}}return e})();function h(e){if(e<l)return e>=32?0:e===10?6:e===13?1:2;if(e<=u){let t=c[e-l>>1];return e&1?t>>4:t&15}if(e<f)return e<12336?e>=12330?3:0:e<12443?e===12336||e===12349?4:e>=12441?3:0:e===12951||e===12953?4:0;if(e<=p){let t=d[e-f>>1];return e&1?t>>4:t&15}if(e<=55203)return(e-44032)%28==0?7:8;if(e<=55295)return e<=55238?e>=55216?13:0:e>=55243?12:0;if(e<65024)return e===64286?3:0;let r=(0,t.findUnicodeRangeIndex)(e,n.grapheme_ranges,m);return r<0?0:n.grapheme_ranges[r][2]}function g(e){return(0,t.findUnicodeRangeIndex)(e,r.consonant_ranges)>=0}})),ir=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.graphemeLenNative=void 0,e.graphemeLenPonyfill=r;var t=rr(),n=`Segmenter`in Intl&&typeof Intl.Segmenter==`function`?new Intl.Segmenter:null;e.graphemeLenNative=n?function(e){let t=0;for(let r of n.segment(e))t++;return t}:null;function r(e){return(0,t.countGraphemes)(e)}})),ar=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.utf8LenNode=void 0,e.utf8LenCompute=n;var t=W();e.utf8LenNode=t.NodeJSBuffer?function(e){return t.NodeJSBuffer.byteLength(e,`utf8`)}:null;function n(e){let t=e.length,n;for(let r=0;r<e.length;r+=1)n=e.charCodeAt(r),n<=127||(n<=2047?t+=1:(t+=2,n>=55296&&n<=56319&&(n=e.charCodeAt(r+1),n>=56320&&n<=57343&&r++)));return t}})),or=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.utf8ToBase64Node=void 0,e.utf8ToBase64Ponyfill=s;var t=(Gn(),n(Un)),r=W(),i=Kn(),a=r.NodeJSBuffer;e.utf8ToBase64Node=a?function(e,t){let n=a.from(e,`utf8`);return i.toBase64Node(n,t)}:null;var o=new TextEncoder;function s(e,n){let r=o.encode(e);return(0,t.toString)(r,n)}})),sr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.utf8FromBase64=e.utf8ToBase64=e.utf8Len=e.graphemeLen=void 0;var t=$n(),n=ir(),r=ar(),i=or();e.graphemeLen=n.graphemeLenNative??n.graphemeLenPonyfill,e.graphemeLen,n.graphemeLenPonyfill,e.utf8Len=r.utf8LenNode??r.utf8LenCompute,e.utf8ToBase64=i.utf8ToBase64Node??i.utf8ToBase64Ponyfill,e.utf8FromBase64=t.utf8FromBase64Node??t.utf8FromBase64Ponyfill})),G=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0});var t=(T(),n(l));t.__exportStar(Yn(),e),t.__exportStar(Jn(),e),t.__exportStar(Xn(),e),t.__exportStar(Zn(),e),t.__exportStar(Qn(),e),t.__exportStar(U(),e),t.__exportStar(qn(),e),t.__exportStar(sr(),e)})),cr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$type=t,e.$typed=n;function t(e,t){return t===`main`?e:`${e}#${t}`}function n(e,t){return e.$type===t?e:{...e,$type:t}}})),lr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0})})),ur=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.InvalidDidError=void 0,e.ensureValidDid=t,e.ensureValidDidRegex=r,e.isValidDid=i;function t(e){if(!e.startsWith(`did:`))throw new a(`DID requires "did:" prefix`);if(e.length>2048)throw new a(`DID is too long (2048 chars max)`);if(e.endsWith(`:`)||e.endsWith(`%`))throw new a(`DID can not end with ":" or "%"`);if(!/^[a-zA-Z0-9._:%-]*$/.test(e))throw new a(`Disallowed characters in DID (ASCII letters, digits, and a couple other characters only)`);let{length:t,1:n}=e.split(`:`);if(t<3)throw new a(`DID requires prefix, method, and method-specific content`);if(!/^[a-z]+$/.test(n))throw new a(`DID method must be lower-case letters`)}var n=/^did:[a-z]+:[a-zA-Z0-9._:%-]*[a-zA-Z0-9._-]$/;function r(e){if(!n.test(e))throw new a(`DID didn't validate via regex`);if(e.length>2048)throw new a(`DID is too long (2048 chars max)`)}function i(e){return e.length<=2048&&n.test(e)}var a=class extends Error{};e.InvalidDidError=a})),dr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.DisallowedDomainError=e.UnsupportedDomainError=e.ReservedHandleError=e.InvalidHandleError=e.DISALLOWED_TLDS=e.INVALID_HANDLE=void 0,e.ensureValidHandle=t,e.ensureValidHandleRegex=r,e.normalizeHandle=i,e.normalizeAndEnsureValidHandle=a,e.isValidHandle=o,e.isValidTld=s,e.INVALID_HANDLE=`handle.invalid`,e.DISALLOWED_TLDS=[`.local`,`.arpa`,`.invalid`,`.localhost`,`.internal`,`.example`,`.alt`,`.onion`];function t(e){if(!/^[a-zA-Z0-9.-]*$/.test(e))throw new c(`Disallowed characters in handle (ASCII letters, digits, dashes, periods only)`);if(e.length>253)throw new c(`Handle is too long (253 chars max)`);let t=e.split(`.`);if(t.length<2)throw new c(`Handle domain needs at least two parts`);for(let e=0;e<t.length;e++){let n=t[e];if(n.length<1)throw new c(`Handle parts can not be empty`);if(n.length>63)throw new c(`Handle part too long (max 63 chars)`);if(n.endsWith(`-`)||n.startsWith(`-`))throw new c(`Handle parts can not start or end with hyphens`);if(e+1===t.length&&!/^[a-zA-Z]/.test(n))throw new c(`Handle final component (TLD) must start with ASCII letter`)}}var n=/^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?$/;function r(e){if(e.length>253)throw new c(`Handle is too long (253 chars max)`);if(!n.test(e))throw new c(`Handle didn't validate via regex`)}function i(e){return e.toLowerCase()}function a(e){let n=i(e);return t(n),n}function o(e){return e.length<=253&&n.test(e)}function s(t){for(let n of e.DISALLOWED_TLDS)if(t.endsWith(n))return!1;return!0}var c=class extends Error{};e.InvalidHandleError=c,e.ReservedHandleError=class extends Error{},e.UnsupportedDomainError=class extends Error{},e.DisallowedDomainError=class extends Error{}})),fr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.ensureValidAtIdentifier=r,e.isValidAtIdentifier=i;var t=ur(),n=dr();function r(e){try{e.startsWith(`did:`)?(0,t.ensureValidDidRegex)(e):(0,n.ensureValidHandleRegex)(e)}catch(e){throw new n.InvalidHandleError(`Invalid DID or handle`,{cause:e})}}function i(e){return e.startsWith(`did:`)?(0,t.isValidDid)(e):(0,n.isValidHandle)(e)}})),pr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.InvalidNsidError=e.NSID=void 0,e.ensureValidNsid=t,e.parseNsid=n,e.isValidNsid=r,e.validateNsid=i,e.ensureValidNsidRegex=u,e.validateNsidRegex=d,e.NSID=class e{segments;static parse(t){return new e(t)}static create(t,n){return new e([...t.split(`.`).reverse(),n].join(`.`))}static isValid(e){return r(e)}static from(t){return t instanceof e?t:Array.isArray(t)?new e(t.join(`.`)):new e(String(t))}constructor(e){this.segments=n(e)}get authority(){return this.segments.slice(0,this.segments.length-1).reverse().join(`.`)}get name(){return this.segments.at(this.segments.length-1)}toString(){return this.segments.join(`.`)}};function t(e){let t=i(e);if(!t.success)throw new f(t.message)}function n(e){let t=i(e);if(!t.success)throw new f(t.message);return t.value}function r(e){return d(e).success}function i(e){if(e.length>317)return{success:!1,message:`NSID is too long (317 chars max)`};if(a(e))return{success:!1,message:`Disallowed characters in NSID (ASCII letters, digits, dashes, periods only)`};let t=e.split(`.`);if(t.length<3)return{success:!1,message:`NSID needs at least three parts`};for(let e of t){if(e.length<1)return{success:!1,message:`NSID parts can not be empty`};if(e.length>63)return{success:!1,message:`NSID part too long (max 63 chars)`};if(s(e)||c(e))return{success:!1,message:`NSID parts can not start or end with hyphen`}}return o(t[0])?{success:!1,message:`NSID first part may not start with a digit`}:l(t[t.length-1])?{success:!0,value:t}:{success:!1,message:`NSID name part must be only letters and digits (and no leading digit)`}}function a(e){return!/^[a-zA-Z0-9.-]*$/.test(e)}function o(e){let t=e.charCodeAt(0);return t>=48&&t<=57}function s(e){return e.charCodeAt(0)===45}function c(e){return e.charCodeAt(e.length-1)===45}function l(e){return!o(e)&&!e.includes(`-`)}function u(e){let t=d(e);if(!t.success)throw new f(t.message)}function d(e){return e.length>317?{success:!1,message:`NSID is too long (317 chars max)`}:/^[a-zA-Z](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?:\.[a-zA-Z](?:[a-zA-Z0-9]{0,62})?)$/.test(e)?{success:!0,value:e}:{success:!1,message:`NSID didn't validate via regex`}}var f=class extends Error{};e.InvalidNsidError=f})),mr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.ensureValidAtUri=a,e.ensureValidAtUriRegex=o,e.isValidAtUri=s;var t=fr(),n=ur(),r=dr(),i=pr();function a(e){let n=e.indexOf(`#`);if(n!==-1){if(e.charCodeAt(n+1)!==47)throw Error(`ATURI fragment must be non-empty and start with slash`);if(e.includes(`#`,n+1))throw Error(`ATURI can have at most one "#", separating fragment out`);let t=e.slice(n+1);if(!/^\/[a-zA-Z0-9._~:@!$&')(*+,;=%[\]/-]*$/.test(t))throw Error(`Disallowed characters in ATURI fragment (ASCII)`)}let r=n===-1?e:e.slice(0,n);if(r.length>8*1024)throw Error(`ATURI is far too long`);if(!r.startsWith(`at://`))throw Error(`ATURI must start with "at://"`);if(!/^[a-zA-Z0-9._~:@!$&')(*+,;=%/-]*$/.test(r))throw Error(`Disallowed characters in ATURI (ASCII)`);let a=r.indexOf(`/`,5),o=a===-1?r.slice(5):r.slice(5,a);try{(0,t.ensureValidAtIdentifier)(o)}catch(e){throw Error(`ATURI authority must be a valid handle or DID`,{cause:e})}let s=a===-1?-1:a+1,c=s===-1?-1:r.indexOf(`/`,s);if(s!==-1){let e=c===-1?r.slice(s):r.slice(s,c);if(e.length===0)throw Error(`ATURI can not have a slash after authority without a path segment`);if(!(0,i.isValidNsid)(e))throw Error(`ATURI requires first path segment (if supplied) to be valid NSID`)}let l=c===-1?-1:c+1,u=l===-1?-1:r.indexOf(`/`,l);if(l!==-1&&l===r.length)throw Error(`ATURI can not have a slash after collection, unless record key is provided`);if(u!==-1)throw Error(`ATURI path can have at most two parts, and no trailing slash`)}function o(e){let t=e.match(/^at:\/\/(?<authority>[a-zA-Z0-9._:%-]+)(\/(?<collection>[a-zA-Z0-9-.]+)(\/(?<rkey>[a-zA-Z0-9._~:@!$&%')(*+,;=-]+))?)?(#(?<fragment>\/[a-zA-Z0-9._~:@!$&%')(*+,;=\-[\]/\\]*))?$/);if(!t||!t.groups)throw Error(`ATURI didn't validate via regex`);let a=t.groups;try{(0,r.ensureValidHandleRegex)(a.authority)}catch{try{(0,n.ensureValidDidRegex)(a.authority)}catch{throw Error(`ATURI authority must be a valid handle or DID`)}}if(a.collection&&!(0,i.isValidNsid)(a.collection))throw Error(`ATURI collection path segment must be a valid NSID`);if(e.length>8*1024)throw Error(`ATURI is far too long`)}function s(e){try{o(e)}catch{return!1}return!0}})),hr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.AtUri=e.ATP_URI_REGEX=void 0;var t=(T(),n(l)),r=fr(),i=pr();t.__exportStar(mr(),e),e.ATP_URI_REGEX=/^(at:\/\/)?((?:did:[a-z0-9:%-]+)|(?:[a-z0-9][a-z0-9.:-]*))(\/[^?#\s]*)?(\?[^#\s]+)?(#[^\s]+)?$/i;var a=/^(\/[^?#\s]*)?(\?[^#\s]+)?(#[^\s]+)?$/i;e.AtUri=class e{hash;host;pathname;searchParams;constructor(e,t){let n=t===void 0?o(e):typeof t==`string`?Object.assign(o(t),s(e)):Object.assign({host:t.host},s(e));(0,r.ensureValidAtIdentifier)(n.host),this.hash=n.hash??``,this.host=n.host,this.pathname=n.pathname??``,this.searchParams=n.searchParams}static make(t,n,r){let i=t;return n&&(i+=`/`+n),r&&(i+=`/`+r),new e(i)}get protocol(){return`at:`}get origin(){return`at://${this.host}`}get hostname(){return this.host}set hostname(e){(0,r.ensureValidAtIdentifier)(e),this.host=e}get search(){return this.searchParams.toString()}set search(e){this.searchParams=new URLSearchParams(e)}get collection(){return this.pathname.split(`/`).filter(Boolean)[0]||``}set collection(e){(0,i.ensureValidNsid)(e);let t=this.pathname.split(`/`).filter(Boolean);t[0]=e,this.pathname=t.join(`/`)}get rkey(){return this.pathname.split(`/`).filter(Boolean)[1]||``}set rkey(e){let t=this.pathname.split(`/`).filter(Boolean);t[0]||=`undefined`,t[1]=e,this.pathname=t.join(`/`)}get href(){return this.toString()}toString(){let e=this.pathname||`/`;e.startsWith(`/`)||(e=`/${e}`);let t=``;this.searchParams.size&&(t=`?${this.searchParams.toString()}`);let n=this.hash;return n&&!n.startsWith(`#`)&&(n=`#${n}`),`at://${this.host}${e}${t}${n}`}};function o(t){let n=t.match(e.ATP_URI_REGEX);if(!n)throw Error(`Invalid AT uri: ${t}`);return{host:n[2],hash:n[5],pathname:n[3],searchParams:new URLSearchParams(n[4])}}function s(e){let t=e.match(a);if(!t)throw Error(`Invalid path: ${e}`);return{hash:t[3],pathname:t[1],searchParams:new URLSearchParams(t[2])}}})),gr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.InvalidDatetimeError=e.normalizeDatetimeAlways=void 0,e.ensureValidDatetime=t,e.isValidDatetime=n,e.normalizeDatetime=r;function t(e){let t=new Date(e);if(isNaN(t.getTime()))throw new i(`datetime did not parse as ISO 8601`);if(t.toISOString().startsWith(`-`))throw new i(`datetime normalized to a negative time`);if(!/^[0-9]{4}-[01][0-9]-[0-3][0-9]T[0-2][0-9]:[0-6][0-9]:[0-6][0-9](.[0-9]{1,20})?(Z|([+-][0-2][0-9]:[0-5][0-9]))$/.test(e))throw new i(`datetime didn't validate via regex`);if(e.length>64)throw new i(`datetime is too long (64 chars max)`);if(e.endsWith(`-00:00`))throw new i(`datetime can not use "-00:00" for UTC timezone`);if(e.startsWith(`000`))throw new i(`datetime so close to year zero not allowed`)}function n(e){try{t(e)}catch{return!1}return!0}function r(e){if(n(e)){let t=new Date(e).toISOString();if(n(t))return t}if(!/.*(([+-]\d\d:?\d\d)|[a-zA-Z])$/.test(e)){let t=new Date(e+`Z`);if(!isNaN(t.getTime())){let e=t.toISOString();if(n(e))return e}}let t=new Date(e);if(isNaN(t.getTime()))throw new i(`datetime did not parse as any timestamp format`);let r=t.toISOString();if(n(r))return r;throw new i(`datetime normalized to invalid timestamp string`)}e.normalizeDatetimeAlways=e=>{try{return r(e)}catch(e){if(e instanceof i)return new Date(0).toISOString();throw e}};var i=class extends Error{};e.InvalidDatetimeError=i})),_r=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.parseLanguageString=n,e.isValidLanguage=r;var t=/^((?<grandfathered>(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang))|((?<language>([A-Za-z]{2,3}(-(?<extlang>[A-Za-z]{3}(-[A-Za-z]{3}){0,2}))?)|[A-Za-z]{4}|[A-Za-z]{5,8})(-(?<script>[A-Za-z]{4}))?(-(?<region>[A-Za-z]{2}|[0-9]{3}))?(-(?<variant>[A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-(?<extension>[0-9A-WY-Za-wy-z](-[A-Za-z0-9]{2,8})+))*(-(?<privateUseA>x(-[A-Za-z0-9]{1,8})+))?)|(?<privateUseB>x(-[A-Za-z0-9]{1,8})+))$/;function n(e){let n=e.match(t);if(!n?.groups)return null;let{groups:r}=n;return{grandfathered:r.grandfathered,language:r.language,extlang:r.extlang,script:r.script,region:r.region,variant:r.variant,extension:r.extension,privateUse:r.privateUseA||r.privateUseB}}function r(e){return t.test(e)}})),vr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.InvalidRecordKeyError=void 0,e.ensureValidRecordKey=a,e.isValidRecordKey=o;var t=512,n=1,r=new Set([`.`,`..`]),i=/^[a-zA-Z0-9_~.:-]{1,512}$/;function a(e){if(e.length>t||e.length<n)throw new s(`record key must be ${n} to ${t} characters`);if(r.has(e))throw new s(`record key can not be "." or ".."`);if(!i.test(e))throw new s(`record key syntax not valid (regex)`)}function o(e){return e.length>=n&&e.length<=t&&i.test(e)&&!r.has(e)}var s=class extends Error{};e.InvalidRecordKeyError=s})),yr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.InvalidTidError=void 0,e.ensureValidTid=r,e.isValidTid=i;var t=13,n=/^[234567abcdefghij][234567abcdefghijklmnopqrstuvwxyz]{12}$/;function r(e){if(e.length!==t)throw new a(`TID must be ${t} characters`);if(!n.test(e))throw new a(`TID syntax not valid (regex)`)}function i(e){return e.length===t&&n.test(e)}var a=class extends Error{};e.InvalidTidError=a})),br=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.isValidUri=t;function t(e){return/^\w+:(?:\/\/)?[^\s/][^\s]*$/.test(e)}})),xr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0});var t=(T(),n(l));t.__exportStar(fr(),e),t.__exportStar(hr(),e),t.__exportStar(gr(),e),t.__exportStar(ur(),e),t.__exportStar(dr(),e),t.__exportStar(pr(),e),t.__exportStar(_r(),e),t.__exportStar(vr(),e),t.__exportStar(yr(),e),t.__exportStar(br(),e)})),Sr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.isLexiconRecordKey=n,e.asLexiconRecordKey=r;var t=xr();function n(e){return e===`any`||e===`nsid`||e===`tid`||typeof e==`string`&&e.startsWith(`literal:`)&&e.length>8&&(0,t.isValidRecordKey)(e.slice(8))}function r(e){if(n(e))return e;throw Error(`Invalid record key: ${String(e)}`)}})),Cr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.success=t,e.failure=n,e.failureReason=r,e.successValue=i,e.catchall=a,e.createCatcher=o;function t(e){return{success:!0,value:e}}function n(e){return{success:!1,reason:e}}function r(e){return e.reason}function i(e){return e.value}function a(e){return e instanceof Error?n(e):n(Error(`Unknown error`,{cause:e}))}function o(e){return t=>{if(t instanceof e)return n(t);throw t}}})),wr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.arrayAgg=t;function t(e,t,n){if(e.length===0)return[];let r=[[e[0]]],i=Array(e.length);outer:for(let n=1;n<e.length;n++){if(i[n])continue;let a=e[n];for(let e=0;e<r.length;e++)if(t(a,r[e][0])){r[e].push(a),i[n]=!0;continue outer}r.push([a])}return r.map(n)}})),Tr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.IssueTooSmall=e.IssueTooBig=e.IssueRequiredKey=e.IssueInvalidValue=e.IssueInvalidType=e.IssueInvalidFormat=e.IssueCustom=e.Issue=void 0;var t=G(),n=class{code;path;input;constructor(e,t,n){this.code=e,this.path=t,this.input=n}toJSON(){return{code:this.code,path:this.path,message:this.toString()}}};e.Issue=n,e.IssueCustom=class extends n{path;input;message;constructor(e,t,n){super(`custom`,e,t),this.path=e,this.input=t,this.message=n}toString(){return`${this.message}${i(this.path)}`}},e.IssueInvalidFormat=class extends n{format;message;constructor(e,t,n,r){super(`invalid_format`,e,t),this.format=n,this.message=r}toString(){return`Invalid ${this.formatDescription}${this.message?` (${this.message})`:``}${i(this.path)} (got ${l(this.input)})`}toJSON(){return{...super.toJSON(),format:this.format}}get formatDescription(){switch(this.format){case`at-identifier`:return`AT identifier`;case`did`:return`DID`;case`nsid`:return`NSID`;case`cid`:return`CID string`;case`tid`:return`TID string`;case`record-key`:return`record key`;default:return this.format}}},e.IssueInvalidType=class extends n{expected;constructor(e,t,n){super(`invalid_type`,e,t),this.expected=n}toString(){return`Expected ${s(this.expected.map(r))} value type${i(this.path)} (got ${c(this.input)})`}toJSON(){return{...super.toJSON(),expected:this.expected}}},e.IssueInvalidValue=class extends n{values;constructor(e,t,n){super(`invalid_value`,e,t),this.values=n}toString(){return`Expected ${s(this.values.map(l))}${i(this.path)} (got ${l(this.input)})`}toJSON(){return{...super.toJSON(),values:this.values}}},e.IssueRequiredKey=class extends n{key;constructor(e,t,n){super(`required_key`,e,t),this.key=n}toString(){return`Missing required key "${String(this.key)}"${i(this.path)}`}toJSON(){return{...super.toJSON(),key:this.key}}},e.IssueTooBig=class extends n{maximum;type;actual;constructor(e,t,n,r,i){super(`too_big`,e,t),this.maximum=n,this.type=r,this.actual=i}toString(){return`${this.type} too big (maximum ${this.maximum})${i(this.path)} (got ${this.actual})`}toJSON(){return{...super.toJSON(),type:this.type,maximum:this.maximum}}},e.IssueTooSmall=class extends n{minimum;type;actual;constructor(e,t,n,r,i){super(`too_small`,e,t),this.minimum=n,this.type=r,this.actual=i}toString(){return`${this.type} too small (minimum ${this.minimum})${i(this.path)} (got ${this.actual})`}toJSON(){return{...super.toJSON(),type:this.type,minimum:this.minimum}}};function r(e){return e===`$typed`?`an object which includes the "$type" property`:e}function i(e){return` at ${a(e)}`}function a(e){return`$${e.map(o).join(``)}`}function o(e){return typeof e==`number`?`[${e}]`:/^[a-zA-Z_$][a-zA-Z0-9_]*$/.test(e)?`.${e}`:`[${JSON.stringify(e)}]`}function s(e){return e.length===0?``:e.length===1?e[0]:`one of ${e.slice(0,-1).join(`, `)} or ${e.at(-1)}`}function c(e){switch(typeof e){case`object`:return e===null?`null`:Array.isArray(e)?`array`:(0,t.ifCid)(e)?`cid`:(0,t.isLegacyBlobRef)(e)?`legacy-blob`:e instanceof Date?`date`:e instanceof RegExp?`regexp`:e instanceof Map?`map`:e instanceof Set?`set`:`object`;case`number`:return Number.isInteger(e)&&Number.isSafeInteger(e)?`integer`:Number.isNaN(e)?`NaN`:e===1/0?`Infinity`:e===-1/0?`-Infinity`:`float`;default:return typeof e}}function l(e){switch(typeof e){case`bigint`:return`${e}n`;case`number`:case`string`:case`boolean`:return JSON.stringify(e);case`object`:if(Array.isArray(e))return`[${d(e,l)}]`;if((0,t.isPlainObject)(e))return`{${d(Object.entries(e),u)}}`;default:return c(e)}}function u([e,t]){return`${JSON.stringify(e)}: ...`}function d(e,t,n=2){return e.slice(0,n).map(t).join(`, `)+(e.length>n?`, ...`:``)}})),Er=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.ValidationError=void 0;var t=G(),n=wr(),r=Cr(),i=Tr();e.ValidationError=class e extends t.LexError{name=`ValidationError`;issues;constructor(e,t){let n=o(e);super(`InvalidRequest`,n.join(`, `),t),this.issues=n}toJSON(){return{...super.toJSON(),issues:this.issues.map(e=>e.toJSON())}}static fromFailures(t){return t.length===1?(0,r.failureReason)(t[0]):new e(t.flatMap(a),{cause:t.map(r.failureReason)})}};function a(e){return e.reason.issues}function o(e){return e.length<=1||e.length===2&&e[0].code!==e[1].code?e:[...(0,n.arrayAgg)(e.filter(e=>e instanceof i.IssueInvalidType),(e,t)=>s(e.path,t.path),e=>new i.IssueInvalidType(e[0].path,e[0].input,Array.from(new Set(e.flatMap(e=>e.expected))))),...(0,n.arrayAgg)(e.filter(e=>e instanceof i.IssueInvalidValue),(e,t)=>s(e.path,t.path),e=>new i.IssueInvalidValue(e[0].path,e[0].input,Array.from(new Set(e.flatMap(e=>e.values))))),...e.filter(e=>!(e instanceof i.IssueInvalidType)&&!(e instanceof i.IssueInvalidValue))]}function s(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}})),Dr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.ValidationContext=void 0;var t=Cr(),n=Er(),r=Tr();e.ValidationContext=class e{options;static validate(t,n,r){return new e({path:r?.path??[],mode:r?.mode??`validate`}).validate(t,n)}currentPath;issues=[];constructor(e){this.options=e,this.currentPath=Array.from(e.path)}get path(){return Array.from(this.currentPath)}concatPath(e){return e==null?this.path:this.currentPath.concat(e)}validate(e,r){let i=r.validateInContext(e,this);if(i.success){if(this.issues.length>0)return(0,t.failure)(new n.ValidationError(Array.from(this.issues)));if(this.options.mode!==`parse`&&!Object.is(i.value,e))return this.issueInvalidValue(e,[i.value])}return i}validateChild(e,t,n){this.currentPath.push(t);try{return this.validate(e[t],n)}finally{this.currentPath.length--}}addIssue(e){this.issues.push(e)}success(e){return(0,t.success)(e)}failure(e){return(0,t.failure)(e)}issue(e){return this.failure(new n.ValidationError([...this.issues,e]))}issueInvalidValue(e,t){return this.issue(new r.IssueInvalidValue(this.path,e,t))}issueInvalidType(e,t){return this.issue(new r.IssueInvalidType(this.path,e,t))}issueUnexpectedType(e,t){return this.issueInvalidType(e,[t])}issueRequiredKey(e,t){return this.issue(new r.IssueRequiredKey(this.path,e,t))}issueInvalidFormat(e,t,n){return this.issue(new r.IssueInvalidFormat(this.path,e,t,n))}issueTooBig(e,t,n,i){return this.issue(new r.IssueTooBig(this.path,e,n,t,i))}issueTooSmall(e,t,n,i){return this.issue(new r.IssueTooSmall(this.path,e,n,t,i))}issueInvalidPropertyValue(e,t,n){let i=e[t],a=this.concatPath(t);return this.issue(new r.IssueInvalidValue(a,i,n))}issueInvalidPropertyType(e,t,n){let i=e[t],a=this.concatPath(t);return this.issue(new r.IssueInvalidType(a,i,[n]))}}})),Or=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.Schema=void 0;var t=Dr();e.Schema=class{assert(e){let n=t.ValidationContext.validate(e,this);if(!n.success)throw n.reason}check(e){this.assert(e)}cast(e){let n=t.ValidationContext.validate(e,this);if(n.success)return n.value;throw n.reason}matches(e){return t.ValidationContext.validate(e,this).success}ifMatches(e){return this.matches(e)?e:void 0}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.value;throw n.reason}safeParse(e,n){return t.ValidationContext.validate(e,this,{...n,mode:`parse`})}validate(e,t){let n=this.safeValidate(e,t);if(n.success)return n.value;throw n.reason}safeValidate(e,n){return t.ValidationContext.validate(e,this,{...n,mode:`validate`})}$assert(e){return this.assert(e)}$check(e){return this.check(e)}$cast(e){return this.cast(e)}$matches(e){return this.matches(e)}$ifMatches(e){return this.ifMatches(e)}$parse(e,t){return this.parse(e,t)}$safeParse(e,t){return this.safeParse(e,t)}$validate(e,t){return this.validate(e,t)}$safeValidate(e,t){return this.safeValidate(e,t)}}})),kr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.STRING_FORMATS=e.isUriString=e.isTidString=e.isRecordKeyString=e.isNsidString=e.isLanguageString=e.isHandleString=e.isDidString=e.isDatetimeString=e.isCidString=e.isAtUriString=e.isAtIdentifierString=void 0,e.isStringFormat=i,e.assertStringFormat=a,e.asStringFormat=o,e.ifStringFormat=s;var t=G(),n=xr();e.isAtIdentifierString=n.isValidAtIdentifier,e.isAtUriString=n.isValidAtUri,e.isCidString=(e=>(0,t.validateCidString)(e)),e.isDatetimeString=n.isValidDatetime,e.isDidString=n.isValidDid,e.isHandleString=n.isValidHandle,e.isLanguageString=n.isValidLanguage,e.isNsidString=n.isValidNsid,e.isRecordKeyString=n.isValidRecordKey,e.isTidString=n.isValidTid,e.isUriString=n.isValidUri;var r=Object.freeze({__proto__:null,"at-identifier":e.isAtIdentifierString,"at-uri":e.isAtUriString,cid:e.isCidString,datetime:e.isDatetimeString,did:e.isDidString,handle:e.isHandleString,language:e.isLanguageString,nsid:e.isNsidString,"record-key":e.isRecordKeyString,tid:e.isTidString,uri:e.isUriString});function i(e,t){let n=r[t];if(!n)throw TypeError(`Unknown string format: ${t}`);return n(e)}function a(e,t){if(!i(e,t))throw TypeError(`Invalid string format (${t}): ${e}`)}function o(e,t){return e}function s(e,t){return i(e,t)?e:void 0}e.STRING_FORMATS=Object.freeze(Object.keys(r))})),Ar=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0})})),K=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0});var t=(T(),n(l));t.__exportStar(cr(),e),t.__exportStar(lr(),e),t.__exportStar(Sr(),e),t.__exportStar(Cr(),e),t.__exportStar(Or(),e),t.__exportStar(kr(),e),t.__exportStar(Ar(),e),t.__exportStar(Er(),e),t.__exportStar(Tr(),e),t.__exportStar(Dr(),e)})),q=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.memoizedOptions=t,e.memoizedTransformer=n;function t(e){let t=null;return function(...n){if(n.length>0)return e(...n);if(t!=null)return t.value;let r=e(...n);return t={value:r},r}}function n(e){let t;return function(n,...r){if(r.length>0)return e(n,...r);t??=new WeakMap;let i=t.get(n);if(i)return i;let a=e(n,...r);return t.set(n,a),a}}})),jr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.array=e.ArraySchema=void 0;var t=K(),n=q(),r=class extends t.Schema{validator;options;type=`array`;constructor(e,t={}){super(),this.validator=e,this.options=t}validateInContext(e,t){if(!Array.isArray(e))return t.issueUnexpectedType(e,`array`);let{minLength:n,maxLength:r}=this.options;if(n!=null&&e.length<n)return t.issueTooSmall(e,`array`,n,e.length);if(r!=null&&e.length>r)return t.issueTooBig(e,`array`,r,e.length);let i;for(let n=0;n<e.length;n++){let r=t.validateChild(e,n,this.validator);if(!r.success)return r;if(r.value!==e[n]){if(t.options.mode===`validate`)return t.issueInvalidPropertyValue(e,n,[r.value]);i??=Array.from(e),i[n]=r.value}}return t.success(i??e)}};e.ArraySchema=r;function i(e,t){return new r(e,t)}e.array=(0,n.memoizedTransformer)(i)})),Mr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.blob=e.BlobSchema=e.isLegacyBlobRef=e.isBlobRef=void 0;var t=G();Object.defineProperty(e,`isBlobRef`,{enumerable:!0,get:function(){return t.isBlobRef}}),Object.defineProperty(e,`isLegacyBlobRef`,{enumerable:!0,get:function(){return t.isLegacyBlobRef}});var n=K(),r=q(),i=class extends n.Schema{options;type=`blob`;constructor(e){super(),this.options=e}validateInContext(e,n){let r=e?.$type===void 0?this.options?.allowLegacy===!0&&(0,t.isLegacyBlobRef)(e)?e:null:(0,t.isBlobRef)(e,this.options)?e:null;if(!r)return n.issueUnexpectedType(e,`blob`);let i=this.options?.accept;if(i&&!a(r.mimeType,i))return n.issueInvalidPropertyValue(r,`mimeType`,i);let o=this.options?.maxSize;return o!=null&&`size`in r&&r.size>o?n.issueTooBig(r,`blob`,o,r.size):n.success(r)}matchesMime(e){let t=this.options?.accept;return t?a(e,t):!0}};e.BlobSchema=i;function a(e,t){if(t.includes(`*/*`)||t.includes(e))return!0;for(let n of t)if(n.endsWith(`/*`)&&e.startsWith(n.slice(0,-1)))return!0;return!1}e.blob=(0,r.memoizedOptions)(function(e){return new i(e)})})),Nr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.boolean=e.BooleanSchema=void 0;var t=K(),n=q(),r=class extends t.Schema{type=`boolean`;validateInContext(e,t){return typeof e==`boolean`?t.success(e):t.issueUnexpectedType(e,`boolean`)}};e.BooleanSchema=r,e.boolean=(0,n.memoizedOptions)(function(){return new r})})),Pr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.bytes=e.BytesSchema=void 0;var t=G(),n=K(),r=q(),i=class extends n.Schema{options;type=`bytes`;constructor(e={}){super(),this.options=e}validateInContext(e,n){let r=n.options.mode===`parse`?(0,t.asUint8Array)(e):(0,t.ifUint8Array)(e);if(!r)return n.issueUnexpectedType(e,`bytes`);let{minLength:i}=this.options;if(i!=null&&r.length<i)return n.issueTooSmall(r,`bytes`,i,r.length);let{maxLength:a}=this.options;return a!=null&&r.length>a?n.issueTooBig(r,`bytes`,a,r.length):n.success(r)}};e.BytesSchema=i,e.bytes=(0,r.memoizedOptions)(function(e){return new i(e)})})),Fr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.cid=e.CidSchema=void 0;var t=G(),n=K(),r=q(),i=class extends n.Schema{options;type=`cid`;constructor(e){super(),this.options=e}validateInContext(e,n){return(0,t.isCid)(e,this.options)?n.success(e):n.issueUnexpectedType(e,`cid`)}};e.CidSchema=i,e.cid=(0,r.memoizedOptions)(function(e){return new i(e)})})),Ir=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.DictSchema=void 0,e.dict=i;var t=G(),n=K(),r=class extends n.Schema{keySchema;valueSchema;type=`dict`;constructor(e,t){super(),this.keySchema=e,this.valueSchema=t}validateInContext(e,n,r){if(!(0,t.isPlainObject)(e))return n.issueUnexpectedType(e,`dict`);let i;for(let t in e){if(r?.ignoredKeys?.has(t))continue;let a=n.validate(t,this.keySchema);if(!a.success)return a;if(a.value!==t)return n.issueRequiredKey(e,t);let o=n.validateChild(e,t,this.valueSchema);if(!o.success)return o;if(!Object.is(o.value,e[t])){if(n.options.mode===`validate`)return n.issueInvalidPropertyValue(e,t,[o.value]);i??={...e},i[t]=o.value}}return n.success(i??e)}};e.DictSchema=r;function i(e,t){return new r(e,t)}})),Lr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.EnumSchema=void 0,e.enumSchema=r,e.enum=r;var t=K(),n=class extends t.Schema{values;type=`enum`;constructor(e){super(),this.values=e}validateInContext(e,t){return this.values.includes(e)?t.success(e):t.issueInvalidValue(e,this.values)}};e.EnumSchema=n;function r(e){return new n(e)}})),Rr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.integer=e.IntegerSchema=void 0;var t=K(),n=q(),r=class extends t.Schema{options;type=`integer`;constructor(e){super(),this.options=e}validateInContext(e,t){return i(e)?this.options?.minimum!=null&&e<this.options.minimum?t.issueTooSmall(e,`integer`,this.options.minimum,e):this.options?.maximum!=null&&e>this.options.maximum?t.issueTooBig(e,`integer`,this.options.maximum,e):t.success(e):t.issueUnexpectedType(e,`integer`)}};e.IntegerSchema=r;function i(e){return Number.isSafeInteger(e)}e.integer=(0,n.memoizedOptions)(function(e){return new r(e)})})),zr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.lexValue=e.LexValueSchema=void 0;var t=G(),n=K(),r=q(),i=Object.freeze([`null`,`boolean`,`integer`,`string`,`cid`,`bytes`,`array`,`object`]),a=class extends n.Schema{type=`lexValue`;validateInContext(e,n){if((0,t.isPlainObject)(e))for(let t of Object.keys(e)){let r=n.validateChild(e,t,this);if(!r.success)return r}else if(Array.isArray(e))for(let t=0;t<e.length;t++){let r=n.validateChild(e,t,this);if(!r.success)return r}else if(!(0,t.isLexScalar)(e))return n.issueInvalidType(e,i);return n.success(e)}};e.LexValueSchema=a,e.lexValue=(0,r.memoizedOptions)(function(){return new a})})),Br=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.unknownObject=e.lexMap=e.LexMapSchema=void 0;var t=G(),n=K(),r=q(),i=(0,zr().lexValue)(),a=class extends n.Schema{type=`lexMap`;validateInContext(e,n){if(!(0,t.isPlainObject)(e))return n.issueUnexpectedType(e,`object`);for(let t of Object.keys(e)){let r=n.validateChild(e,t,i);if(!r.success)return r}return n.success(e)}};e.LexMapSchema=a,e.lexMap=(0,r.memoizedOptions)(function(){return new a}),e.unknownObject=e.lexMap})),J=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.LiteralSchema=void 0,e.literal=r;var t=K(),n=class extends t.Schema{value;type=`literal`;constructor(e){super(),this.value=e}validateInContext(e,t){return e===this.value?t.success(this.value):t.issueInvalidValue(e,[this.value])}};e.LiteralSchema=n;function r(e){return new n(e)}})),Vr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.never=e.NeverSchema=void 0;var t=K(),n=q(),r=class extends t.Schema{type=`never`;validateInContext(e,t){return t.issueUnexpectedType(e,`never`)}};e.NeverSchema=r,e.never=(0,n.memoizedOptions)(function(){return new r})})),Hr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.null=e.nullSchema=e.NullSchema=void 0;var t=K(),n=q(),r=class extends t.Schema{type=`null`;validateInContext(e,t){return e===null?t.success(null):t.issueUnexpectedType(e,`null`)}};e.NullSchema=r,e.nullSchema=(0,n.memoizedOptions)(function(){return new r}),e.null=e.nullSchema})),Ur=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.lazyProperty=t;function t(e,t,n){return Object.defineProperty(e,t,{value:n,writable:!1,enumerable:!1,configurable:!0}),n}})),Wr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.ObjectSchema=void 0,e.object=a;var t=G(),n=K(),r=Ur(),i=class extends n.Schema{shape;type=`object`;constructor(e){super(),this.shape=e}get validatorsMap(){let e=new Map(Object.entries(this.shape));return(0,r.lazyProperty)(this,`validatorsMap`,e)}validateInContext(e,n){if(!(0,t.isPlainObject)(e))return n.issueUnexpectedType(e,`object`);let r;for(let[t,i]of this.validatorsMap){let a=n.validateChild(e,t,i);if(!a.success)return t in e?a:n.issueRequiredKey(e,t);if(!(a.value===void 0&&!(t in e))&&!Object.is(a.value,e[t])){if(n.options.mode===`validate`)return n.issueInvalidPropertyValue(e,t,[a.value]);r??={...e},r[t]=a.value}}return n.success(r??e)}};e.ObjectSchema=i;function a(e){return new i(e)}})),Gr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.RegexpSchema=void 0,e.regexp=r;var t=K(),n=class extends t.Schema{pattern;type=`regexp`;constructor(e){super(),this.pattern=e}validateInContext(e,t){return typeof e==`string`?this.pattern.test(e)?t.success(e):t.issueInvalidFormat(e,this.pattern.toString()):t.issueUnexpectedType(e,`string`)}};e.RegexpSchema=n;function r(e){return new n(e)}})),Kr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.TokenSchema=void 0,e.token=r;var t=K(),n=class e extends t.Schema{value;type=`token`;constructor(e){super(),this.value=e}validateInContext(t,n){return t===this.value||t instanceof e&&t.value===this.value?n.success(this.value):typeof t==`string`?n.issueInvalidValue(t,[this.value]):n.issueUnexpectedType(t,`token`)}toJSON(){return this.value}toString(){return this.value}};e.TokenSchema=n;function r(e,r=`main`){return new n((0,t.$type)(e,r))}})),qr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.string=e.StringSchema=void 0,e.coerceToString=o;var t=G(),n=K(),r=q(),i=Kr(),a=class extends n.Schema{type=`string`;options;constructor(e){super(),this.options=e}validateInContext(e,r){let i=o(e);if(i==null)return r.issueUnexpectedType(e,`string`);let a,s=this.options.minLength;if(s!=null&&(a??=(0,t.utf8Len)(i))<s)return r.issueTooSmall(i,`string`,s,a);let c=this.options.maxLength;if(c!=null&&!(i.length*3<=c)&&(a??=(0,t.utf8Len)(i))>c)return r.issueTooBig(i,`string`,c,a);let l,u=this.options.minGraphemes;if(u!=null){if(i.length<u)return r.issueTooSmall(i,`grapheme`,u,i.length);if((l??=(0,t.graphemeLen)(i))<u)return r.issueTooSmall(i,`grapheme`,u,l)}let d=this.options.maxGraphemes;if(d!=null&&(l??=(0,t.graphemeLen)(i))>d)return r.issueTooBig(i,`grapheme`,d,l);let f=this.options.format;return f!=null&&!(0,n.isStringFormat)(i,f)?r.issueInvalidFormat(i,f):r.success(i)}};e.StringSchema=a;function o(e){switch(typeof e){case`string`:return e;case`object`:{if(e==null)return null;if(e instanceof i.TokenSchema)return e.toString();if(e instanceof Date)return Number.isNaN(e.getTime())?null:e.toISOString();if(e instanceof URL)return e.toString();let n=(0,t.ifCid)(e);if(n)return n.toString();if(e instanceof String)return e.valueOf()}default:return null}}function s(e={}){return new a(e)}e.string=(0,r.memoizedOptions)(s)})),Jr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.unknown=e.UnknownSchema=void 0;var t=K(),n=q(),r=class extends t.Schema{type=`unknown`;validateInContext(e,t){return t.success(e)}};e.UnknownSchema=r,e.unknown=(0,n.memoizedOptions)(function(){return new r})})),Yr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.CustomSchema=void 0,e.custom=r;var t=K(),n=class extends t.Schema{assertion;message;path;type=`custom`;constructor(e,t,n){super(),this.assertion=e,this.message=t,this.path=n}validateInContext(e,n){if(!this.assertion.call(null,e,n)){let r=n.concatPath(this.path);return n.issue(new t.IssueCustom(r,e,this.message))}return n.success(e)}};e.CustomSchema=n;function r(e,t,r){return new n(e,t,r)}})),Xr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.DiscriminatedUnionSchema=void 0,e.discriminatedUnion=s;var t=G(),n=K(),r=Lr(),i=J(),a=class extends n.Schema{discriminator;variants;type=`discriminatedUnion`;variantsMap;constructor(e,t){super(),this.discriminator=e,this.variants=t,this.variantsMap=o(e,t)}validateInContext(e,n){if(!(0,t.isPlainObject)(e))return n.issueUnexpectedType(e,`object`);let{discriminator:r}=this;if(!Object.hasOwn(e,r))return n.issueRequiredKey(e,r);let i=e[r],a=this.variantsMap.get(i);return a?n.validate(e,a):n.issueInvalidPropertyValue(e,r,[...this.variantsMap.keys()])}};e.DiscriminatedUnionSchema=a;function o(e,t){let n=new Map;for(let a of t){let t=a.shape[e];if(t instanceof i.LiteralSchema){if(n.has(t.value))throw TypeError(`Overlapping discriminator value: ${t.value}`);n.set(t.value,a)}else if(t instanceof r.EnumSchema)for(let e of t.values){if(n.has(e))throw TypeError(`Overlapping discriminator value: ${e}`);n.set(e,a)}else throw TypeError(`Discriminator schema must be a LiteralSchema or EnumSchema`)}return n}function s(e,t){return new a(e,t)}})),Zr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.IntersectionSchema=void 0,e.intersection=r;var t=K(),n=class extends t.Schema{left;right;type=`intersection`;constructor(e,t){super(),this.left=e,this.right=t}validateInContext(e,t){let n=t.validate(e,this.left);return n.success?this.right.validateInContext(n.value,t,{ignoredKeys:this.left.validatorsMap}):n}};e.IntersectionSchema=n;function r(e,t){return new n(e,t)}})),Qr=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.nullable=e.NullableSchema=void 0;var t=K(),n=q(),r=class extends t.Schema{validator;type=`nullable`;constructor(e){super(),this.validator=e}validateInContext(e,t){return e===null?t.success(null):t.validate(e,this.validator)}};e.NullableSchema=r,e.nullable=(0,n.memoizedTransformer)(function(e){return new r(e)})})),$r=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.optional=e.OptionalSchema=void 0;var t=K(),n=q(),r=class extends t.Schema{validator;type=`optional`;constructor(e){super(),this.validator=e}validateInContext(e,t){if(e===void 0&&t.options.mode===`validate`)return t.success(e);let n=t.validate(e,this.validator);return n.success?n:e===void 0?t.success(e):n}};e.OptionalSchema=r,e.optional=(0,n.memoizedTransformer)(function(e){return new r(e)})})),ei=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.RefSchema=void 0,e.ref=r;var t=K(),n=class extends t.Schema{type=`ref`;#e;constructor(e){super(),this.#e=e}get validator(){return this.#e.call(null)}unwrap(){return this.validator}validateInContext(e,t){return t.validate(e,this.validator)}};e.RefSchema=n;function r(e){return new n(e)}})),ti=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.refine=n;var t=K();function n(e,t){return Object.create(e,{validateInContext:{value:r.bind({schema:e,refinement:t}),enumerable:!1,writable:!1,configurable:!0}})}function r(e,n){let r=n.validate(e,this.schema);if(!r.success)return r;if(!this.refinement.check.call(null,r.value,n)){let r=n.concatPath(this.refinement.path);return n.issue(new t.IssueCustom(r,e,this.refinement.message))}return r}})),ni=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.UnionSchema=void 0,e.union=r;var t=K(),n=class extends t.Schema{validators;type=`union`;constructor(e){super(),this.validators=e}validateInContext(e,n){let r=[];for(let t of this.validators){let i=n.validate(e,t);if(i.success)return i;r.push(i)}return n.failure(t.ValidationError.fromFailures(r))}};e.UnionSchema=n;function r(e){return new n(e)}})),ri=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.WithDefaultSchema=void 0,e.withDefault=r;var t=K(),n=class extends t.Schema{validator;defaultValue;type=`withDefault`;constructor(e,t){super(),this.validator=e,this.defaultValue=t}validateInContext(e,t){return e===void 0&&t.options.mode!==`validate`?t.validate(this.defaultValue,this.validator):t.validate(e,this.validator)}};e.WithDefaultSchema=n;function r(e,t){return new n(e,t)}})),ii=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.params=e.ParamsSchema=e.paramsSchema=e.paramSchema=void 0;var t=G(),n=K(),r=Ur(),i=q(),a=jr(),o=Nr(),s=Ir(),c=Lr(),l=Rr(),u=J(),d=$r(),f=qr(),p=ni(),m=ri(),h=(0,p.union)([(0,o.boolean)(),(0,l.integer)(),(0,f.string)()]);e.paramSchema=(0,p.union)([h,(0,a.array)((0,o.boolean)()),(0,a.array)((0,l.integer)()),(0,a.array)((0,f.string)())]),e.paramsSchema=(0,s.dict)((0,f.string)(),(0,d.optional)(e.paramSchema));var g=class extends n.Schema{shape;type=`params`;constructor(e){super(),this.shape=e}get shapeValidators(){let e=new Map(Object.entries(this.shape));return(0,r.lazyProperty)(this,`shapeValidators`,e)}validateInContext(n,r){if(!(0,t.isPlainObject)(n))return r.issueUnexpectedType(n,`object`);let i;for(let t in n){if(this.shapeValidators.has(t))continue;let a=r.validateChild(n,t,e.paramSchema);if(!a.success)return a;if(a.value!==n[t]){if(r.options.mode===`validate`)return r.issueInvalidPropertyValue(n,t,[a.value]);i??={...n},i[t]=a.value}}for(let[e,t]of this.shapeValidators){let a=r.validateChild(n,e,t);if(!a.success)return e in n?a:r.issueRequiredKey(n,e);if(!(a.value===void 0&&!(e in n))&&!Object.is(a.value,n[e])){if(r.options.mode===`validate`)return r.issueInvalidPropertyValue(n,e,[a.value]);i??={...n},i[e]=a.value}}return r.success(i??n)}fromURLSearchParams(e,t){let n={},r=typeof e==`string`?new URLSearchParams(e):e,i=r instanceof URLSearchParams?r.entries():r;for(let[e,r]of i){let i=this.shapeValidators.get(e),o=i?y(i):void 0,s=o instanceof a.ArraySchema,c=_(e,r,s?y(o.validator):o,t),l=n[e];l===void 0?n[e]=s?[c]:c:Array.isArray(l)?l.push(c):n[e]=[l,c]}return this.parse(n,t)}toURLSearchParams(e){let t=new URLSearchParams,n=this.parse(e);for(let[e,r]of Object.entries(n))if(Array.isArray(r))for(let n of r)t.append(e,String(n));else r!==void 0&&t.append(e,String(r));return t}};e.ParamsSchema=g;function _(e,t,r,i){let a;if(!r||r instanceof f.StringSchema)return t;if(r instanceof l.IntegerSchema){if(/^-?\d+$/.test(t))return Number(t);a=new n.IssueInvalidType(v(e,i),t,[`integer`])}else if(r instanceof o.BooleanSchema){if(t===`true`)return!0;if(t===`false`)return!1;a=new n.IssueInvalidType(v(e,i),t,[`boolean`])}else if(r instanceof u.LiteralSchema){let{value:o}=r;if(String(o)===t)return o;a=new n.IssueInvalidValue(v(e,i),t,[o])}else if(r instanceof c.EnumSchema){let{values:o}=r;for(let e of o)if(String(e)===t)return e;a=new n.IssueInvalidValue(v(e,i),t,o)}else throw Error(`Unsupported schema type for param coercion: ${r}`);throw new n.ValidationError([a])}function v(e,t){return t?.path?[...t.path,e]:[e]}e.params=(0,i.memoizedOptions)(function(e={}){return new g(e)});function y(e){for(;e instanceof d.OptionalSchema||e instanceof m.WithDefaultSchema;)return y(e.validator);return e}})),ai=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.Payload=void 0,e.payload=r,e.jsonPayload=i;var t=Wr(),n=class{encoding;schema;constructor(e,t){if(this.encoding=e,this.schema=t,e===void 0&&t!==void 0)throw TypeError(`schema cannot be defined when encoding is undefined`)}matchesEncoding(e){let{encoding:t}=this;if(t===void 0)return e==null;if(e==null)return!1;if(t===`*/*`)return!0;let n=e?.split(`;`,1)[0].trim();return t.endsWith(`/*`)?n.startsWith(t.slice(0,-1)):t.includes(`*`)?!1:t===n}};e.Payload=n;function r(e=void 0,t=void 0){return new n(e,t)}function i(e){return r(`application/json`,(0,t.object)(e))}})),oi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.PermissionSet=void 0,e.permissionSet=n;var t=class{nsid;permissions;options;constructor(e,t,n={}){this.nsid=e,this.permissions=t,this.options=n}};e.PermissionSet=t;function n(e,n,r){return new t(e,n,r)}})),si=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.Permission=void 0,e.permission=n;var t=class{resource;options;constructor(e,t){this.resource=e,this.options=t}};e.Permission=t;function n(e,n={}){return new t(e,n)}})),ci=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.Procedure=void 0,e.procedure=n;var t=class{nsid;parameters;input;output;errors;type=`procedure`;constructor(e,t,n,r,i){this.nsid=e,this.parameters=t,this.input=n,this.output=r,this.errors=i}};e.Procedure=t;function n(e,n,r,i,a=void 0){return new t(e,n,r,i,a)}})),li=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.Query=void 0,e.query=n;var t=class{nsid;parameters;output;errors;type=`query`;constructor(e,t,n,r){this.nsid=e,this.parameters=t,this.output=n,this.errors=r}};e.Query=t;function n(e,n,r,i=void 0){return new t(e,n,r,i)}})),ui=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.RecordSchema=void 0,e.record=u;var t=K(),n=J(),r=qr(),i=class extends t.Schema{key;$type;schema;type=`record`;keySchema;constructor(e,t,n){super(),this.key=e,this.$type=t,this.schema=n,this.keySchema=l(e)}isTypeOf(e){return e.$type===this.$type}build(e){return this.parse((0,t.$typed)(e,this.$type))}$isTypeOf(e){return this.isTypeOf(e)}$build(e){return this.build(e)}validateInContext(e,t){let n=t.validate(e,this.schema);return n.success?n.value.$type===this.$type?n:t.issueInvalidPropertyValue(n.value,`$type`,[this.$type]):n}};e.RecordSchema=i;var a=(0,r.string)({minLength:1}),o=(0,r.string)({format:`tid`}),s=(0,r.string)({format:`nsid`}),c=(0,n.literal)(`self`);function l(e){if(e===`any`)return a;if(e===`tid`)return o;if(e===`nsid`)return s;if(e.startsWith(`literal:`)){let t=e.slice(8);return t===`self`?c:(0,n.literal)(t)}throw Error(`Unsupported record key type: ${e}`)}function u(e,t,n){return new i(e,t,n)}})),di=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.Subscription=void 0,e.subscription=n;var t=class{nsid;parameters;message;errors;type=`subscription`;constructor(e,t,n,r){this.nsid=e,this.parameters=t,this.message=n,this.errors=r}};e.Subscription=t;function n(e,n,r,i=void 0){return new t(e,n,r,i)}})),fi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.TypedObjectSchema=void 0,e.typedObject=i;var t=G(),n=K(),r=class extends n.Schema{$type;schema;type=`typedObject`;constructor(e,t){super(),this.$type=e,this.schema=t}isTypeOf(e){return e.$type===void 0||e.$type===this.$type}build(e){return this.parse((0,n.$typed)(e,this.$type))}$isTypeOf(e){return this.isTypeOf(e)}$build(e){return this.build(e)}validateInContext(e,n){return(0,t.isPlainObject)(e)?`$type`in e&&e.$type!==void 0&&e.$type!==this.$type?n.issueInvalidPropertyValue(e,`$type`,[this.$type]):n.validate(e,this.schema):n.issueUnexpectedType(e,`object`)}};e.TypedObjectSchema=r;function i(e,t,i){return new r((0,n.$type)(e,t),i)}})),pi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.TypedRefSchema=void 0,e.typedRef=r;var t=K(),n=class extends t.Schema{type=`typedRef`;#e;constructor(e){super(),this.#e=e}get validator(){return this.#e.call(null)}get $type(){return this.validator.$type}validateInContext(e,t){let n=t.validate(e,this.validator);return n.success?n.value.$type===this.$type?n:t.issueInvalidPropertyValue(n.value,`$type`,[this.$type]):n}};e.TypedRefSchema=n;function r(e){return new n(e)}})),mi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.TypedUnionSchema=void 0,e.typedUnion=a;var t=G(),n=K(),r=Ur(),i=class extends n.Schema{validators;closed;type=`typedUnion`;constructor(e,t){super(),this.validators=e,this.closed=t}get validatorsMap(){let e=new Map;for(let t of this.validators)e.set(t.$type,t);return(0,r.lazyProperty)(this,`validatorsMap`,e)}get $types(){return Array.from(this.validatorsMap.keys())}validateInContext(e,n){if(!(0,t.isPlainObject)(e)||!(`$type`in e))return n.issueUnexpectedType(e,`$typed`);let{$type:r}=e,i=this.validatorsMap.get(r);return i?n.validate(e,i):this.closed?n.issueInvalidPropertyValue(e,`$type`,this.$types):typeof r==`string`?n.success(e):n.issueInvalidPropertyType(e,`$type`,`string`)}};e.TypedUnionSchema=i;function a(e,t){return new i(e,t)}})),hi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0});var t=(T(),n(l));t.__exportStar(jr(),e),t.__exportStar(Mr(),e),t.__exportStar(Nr(),e),t.__exportStar(Pr(),e),t.__exportStar(Fr(),e),t.__exportStar(Ir(),e),t.__exportStar(Lr(),e),t.__exportStar(Rr(),e),t.__exportStar(Br(),e),t.__exportStar(zr(),e),t.__exportStar(J(),e),t.__exportStar(Vr(),e),t.__exportStar(Hr(),e),t.__exportStar(Wr(),e),t.__exportStar(Gr(),e),t.__exportStar(qr(),e),t.__exportStar(Jr(),e),t.__exportStar(Yr(),e),t.__exportStar(Xr(),e),t.__exportStar(Zr(),e),t.__exportStar(Qr(),e),t.__exportStar($r(),e),t.__exportStar(ei(),e),t.__exportStar(ti(),e),t.__exportStar(ni(),e),t.__exportStar(ri(),e),t.__exportStar(ii(),e),t.__exportStar(ai(),e),t.__exportStar(oi(),e),t.__exportStar(si(),e),t.__exportStar(ci(),e),t.__exportStar(li(),e),t.__exportStar(ui(),e),t.__exportStar(di(),e),t.__exportStar(Kr(),e),t.__exportStar(fi(),e),t.__exportStar(pi(),e),t.__exportStar(mi(),e)})),gi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.lexErrorDataSchema=void 0,e.getMain=n;var t=hi();function n(e){return`main`in e?e.main:e}e.lexErrorDataSchema=(0,t.object)({error:(0,t.string)({minLength:1}),message:(0,t.optional)((0,t.string)())})})),_i=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0});var t=(T(),n(l));t.__exportStar(K(),e),t.__exportStar(gi(),e),t.__exportStar(hi(),e)})),Y=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.l=void 0;var t=(T(),n(l));e.l=t.__importStar(_i()),t.__exportStar(_i(),e)})),X=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.commitMeta=e.$nsid=void 0;var t=Y(),n=`com.atproto.repo.defs`;e.$nsid=n,e.commitMeta=t.l.typedObject(n,`commitMeta`,t.l.object({cid:t.l.string({format:`cid`}),rev:t.l.string({format:`tid`})}))})),vi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$output=e.$input=e.$params=e.$lxm=e.main=e.$nsid=void 0;var t=(T(),n(l)),r=Y(),i=t.__importStar(X()),a=`com.atproto.repo.createRecord`;e.$nsid=a;var o=r.l.procedure(a,r.l.params(),r.l.jsonPayload({repo:r.l.string({format:`at-identifier`}),collection:r.l.string({format:`nsid`}),rkey:r.l.optional(r.l.string({format:`record-key`,maxLength:512})),validate:r.l.optional(r.l.boolean()),record:r.l.lexMap(),swapCommit:r.l.optional(r.l.string({format:`cid`}))}),r.l.jsonPayload({uri:r.l.string({format:`at-uri`}),cid:r.l.string({format:`cid`}),commit:r.l.optional(r.l.ref((()=>i.commitMeta))),validationStatus:r.l.optional(r.l.string())}),[`InvalidSwap`]);e.main=o,e.$lxm=o.nsid,e.$params=o.parameters,e.$input=o.input,e.$output=o.output})),yi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$defs=void 0;var t=(T(),n(l));t.__exportStar(vi(),e),e.$defs=t.__importStar(vi())})),bi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$output=e.$input=e.$params=e.$lxm=e.main=e.$nsid=void 0;var t=(T(),n(l)),r=Y(),i=t.__importStar(X()),a=`com.atproto.repo.deleteRecord`;e.$nsid=a;var o=r.l.procedure(a,r.l.params(),r.l.jsonPayload({repo:r.l.string({format:`at-identifier`}),collection:r.l.string({format:`nsid`}),rkey:r.l.string({format:`record-key`}),swapRecord:r.l.optional(r.l.string({format:`cid`})),swapCommit:r.l.optional(r.l.string({format:`cid`}))}),r.l.jsonPayload({commit:r.l.optional(r.l.ref((()=>i.commitMeta)))}),[`InvalidSwap`]);e.main=o,e.$lxm=o.nsid,e.$params=o.parameters,e.$input=o.input,e.$output=o.output})),xi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$defs=void 0;var t=(T(),n(l));t.__exportStar(bi(),e),e.$defs=t.__importStar(bi())})),Si=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$output=e.$params=e.$lxm=e.main=e.$nsid=void 0;var t=Y(),n=`com.atproto.repo.getRecord`;e.$nsid=n;var r=t.l.query(n,t.l.params({repo:t.l.string({format:`at-identifier`}),collection:t.l.string({format:`nsid`}),rkey:t.l.string({format:`record-key`}),cid:t.l.optional(t.l.string({format:`cid`}))}),t.l.jsonPayload({uri:t.l.string({format:`at-uri`}),cid:t.l.optional(t.l.string({format:`cid`})),value:t.l.lexMap()}),[`RecordNotFound`]);e.main=r,e.$lxm=r.nsid,e.$params=r.parameters,e.$output=r.output})),Ci=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$defs=void 0;var t=(T(),n(l));t.__exportStar(Si(),e),e.$defs=t.__importStar(Si())})),wi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.record=e.$output=e.$params=e.$lxm=e.main=e.$nsid=void 0;var t=Y(),n=`com.atproto.repo.listRecords`;e.$nsid=n;var r=t.l.query(n,t.l.params({repo:t.l.string({format:`at-identifier`}),collection:t.l.string({format:`nsid`}),limit:t.l.optional(t.l.withDefault(t.l.integer({minimum:1,maximum:100}),50)),cursor:t.l.optional(t.l.string()),reverse:t.l.optional(t.l.boolean())}),t.l.jsonPayload({cursor:t.l.optional(t.l.string()),records:t.l.array(t.l.ref((()=>i)))}));e.main=r,e.$lxm=r.nsid,e.$params=r.parameters,e.$output=r.output;var i=t.l.typedObject(n,`record`,t.l.object({uri:t.l.string({format:`at-uri`}),cid:t.l.string({format:`cid`}),value:t.l.lexMap()}));e.record=i})),Ti=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$defs=void 0;var t=(T(),n(l));t.__exportStar(wi(),e),e.$defs=t.__importStar(wi())})),Ei=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$output=e.$input=e.$params=e.$lxm=e.main=e.$nsid=void 0;var t=(T(),n(l)),r=Y(),i=t.__importStar(X()),a=`com.atproto.repo.putRecord`;e.$nsid=a;var o=r.l.procedure(a,r.l.params(),r.l.jsonPayload({repo:r.l.string({format:`at-identifier`}),collection:r.l.string({format:`nsid`}),rkey:r.l.string({format:`record-key`,maxLength:512}),validate:r.l.optional(r.l.boolean()),record:r.l.lexMap(),swapRecord:r.l.optional(r.l.nullable(r.l.string({format:`cid`}))),swapCommit:r.l.optional(r.l.string({format:`cid`}))}),r.l.jsonPayload({uri:r.l.string({format:`at-uri`}),cid:r.l.string({format:`cid`}),commit:r.l.optional(r.l.ref((()=>i.commitMeta))),validationStatus:r.l.optional(r.l.string())}),[`InvalidSwap`]);e.main=o,e.$lxm=o.nsid,e.$params=o.parameters,e.$input=o.input,e.$output=o.output})),Di=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$defs=void 0;var t=(T(),n(l));t.__exportStar(Ei(),e),e.$defs=t.__importStar(Ei())})),Oi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$output=e.$input=e.$params=e.$lxm=e.main=e.$nsid=void 0;var t=Y(),n=`com.atproto.repo.uploadBlob`;e.$nsid=n;var r=t.l.procedure(n,t.l.params(),t.l.payload(`*/*`),t.l.jsonPayload({blob:t.l.blob({allowLegacy:!1})}));e.main=r,e.$lxm=r.nsid,e.$params=r.parameters,e.$input=r.input,e.$output=r.output})),ki=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$defs=void 0;var t=(T(),n(l));t.__exportStar(Oi(),e),e.$defs=t.__importStar(Oi())})),Ai=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$defs=void 0;var t=(T(),n(l));t.__exportStar(X(),e),e.$defs=t.__importStar(X())})),ji=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.defs=e.uploadBlob=e.putRecord=e.listRecords=e.getRecord=e.deleteRecord=e.createRecord=void 0;var t=(T(),n(l));e.createRecord=t.__importStar(yi()),e.deleteRecord=t.__importStar(xi()),e.getRecord=t.__importStar(Ci()),e.listRecords=t.__importStar(Ti()),e.putRecord=t.__importStar(Di()),e.uploadBlob=t.__importStar(ki()),e.defs=t.__importStar(Ai())})),Mi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$output=e.$params=e.$lxm=e.main=e.$nsid=void 0;var t=Y(),n=`com.atproto.sync.getBlob`;e.$nsid=n;var r=t.l.query(n,t.l.params({did:t.l.string({format:`did`}),cid:t.l.string({format:`cid`})}),t.l.payload(`*/*`),[`BlobNotFound`,`RepoNotFound`,`RepoTakendown`,`RepoSuspended`,`RepoDeactivated`]);e.main=r,e.$lxm=r.nsid,e.$params=r.parameters,e.$output=r.output})),Ni=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.$defs=void 0;var t=(T(),n(l));t.__exportStar(Mi(),e),e.$defs=t.__importStar(Mi())})),Pi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.getBlob=void 0,e.getBlob=(T(),n(l)).__importStar(Ni())})),Fi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.sync=e.repo=void 0;var t=(T(),n(l));e.repo=t.__importStar(ji()),e.sync=t.__importStar(Pi())})),Ii=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.atproto=void 0,e.atproto=(T(),n(l)).__importStar(Fi())})),Li=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.com=void 0,e.com=(T(),n(l)).__importStar(Ii())})),Ri=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.isBlobLike=t,e.isAsyncIterable=n,e.buildAtprotoHeaders=r,e.toReadableStream=i;function t(e){if(typeof e!=`object`||!e)return!1;if(typeof Blob==`function`&&e instanceof Blob)return!0;let t=e[Symbol.toStringTag];return t===`Blob`||t===`File`?`stream`in e&&typeof e.stream==`function`:!1}function n(e){return e!=null&&typeof e[Symbol.asyncIterator]==`function`}function r(e){let t=new Headers(e?.headers);return e.service&&!t.has(`atproto-proxy`)&&t.set(`atproto-proxy`,e.service),e.labelers&&t.set(`atproto-accept-labelers`,[...e.labelers,t.get(`atproto-accept-labelers`)?.trim()].filter(Boolean).join(`, `)),t}function i(e){if(`from`in ReadableStream&&typeof ReadableStream.from==`function`)return ReadableStream.from(e);let t;return new ReadableStream({async pull(n){try{t??=e[Symbol.asyncIterator]();let r=await t.next();r.done?n.close():n.enqueue(r.value)}catch(e){n.error(e),t=void 0}},async cancel(){await t?.return?.(),t=void 0}})}})),zi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.parseLexBytes=n,e.encodeLexBytes=r;var t=G();function n(e){if(!(!e||!(`$bytes`in e))){for(let t in e)if(t!==`$bytes`)return;if(typeof e.$bytes==`string`)try{return(0,t.fromBase64)(e.$bytes)}catch{return}}}function r(e){return{$bytes:(0,t.toBase64)(e)}}})),Bi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0})})),Vi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.parseLexLink=n,e.encodeLexLink=r;var t=G();function n(e,n){if(!e||!(`$link`in e))return;for(let t in e)if(t!==`$link`)return;let{$link:r}=e;if(typeof r==`string`&&r.length!==0&&!(r.length>2048))try{return(0,t.parseCid)(r,n)}catch{return}}function r(e){return{$link:e.toString()}}})),Hi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.parseBlobRef=r;var t=G(),n=Vi();function r(e,r){if(e.$type!==`blob`)return;let i=e?.ref;if(!(!i||typeof i!=`object`)){if(`$link`in i){let a=(0,n.parseLexLink)(i);if(!a)return;let o={...e,ref:a};if((0,t.isBlobRef)(o,r))return o}if((0,t.isBlobRef)(e))return e}}})),Ui=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.lexStringify=a,e.lexParse=o,e.jsonToLex=s,e.lexToJson=u;var t=G(),n=Hi(),r=zi(),i=Vi();function a(e){return JSON.stringify(u(e))}function o(e,t={strict:!1}){return JSON.parse(e,function(e,n){switch(typeof n){case`object`:return n===null?null:Array.isArray(n)?n:p(n,t)??n;case`number`:if(Number.isSafeInteger(n))return n;if(t.strict)throw TypeError(`Invalid non-integer number: ${n}`);default:return n}})}function s(e,t={strict:!1}){switch(typeof e){case`object`:return e===null?null:Array.isArray(e)?c(e,t):p(e,t)??l(e,t);case`number`:if(Number.isSafeInteger(e))return e;if(t.strict)throw TypeError(`Invalid non-integer number: ${e}`);case`boolean`:case`string`:return e;default:throw TypeError(`Invalid JSON value: ${typeof e}`)}}function c(e,t){let n;for(let r=0;r<e.length;r++){let i=e[r],a=s(i,t);a!==i&&(n??=Array.from(e),n[r]=a)}return n??e}function l(e,t){let n;for(let[r,i]of Object.entries(e)){if(r===`__proto__`)throw TypeError(`Invalid key: __proto__`);if(i===void 0){n??={...e},delete n[r];continue}let a=s(i,t);a!==i&&(n??={...e},n[r]=a)}return n??e}function u(e){switch(typeof e){case`object`:return e===null?e:Array.isArray(e)?d(e):(0,t.isCid)(e)?(0,i.encodeLexLink)(e):ArrayBuffer.isView(e)?(0,r.encodeLexBytes)(e):f(e);case`boolean`:case`string`:case`number`:return e;default:throw TypeError(`Invalid Lex value: ${typeof e}`)}}function d(e){let t;for(let n=0;n<e.length;n++){let r=e[n],i=u(r);i!==r&&(t??=Array.from(e),t[n]=i)}return t??e}function f(e){let t;for(let[n,r]of Object.entries(e)){if(n===`__proto__`)throw TypeError(`Invalid key: __proto__`);if(r===void 0){t??={...e},delete t[n];continue}let i=u(r);i!==r&&(t??={...e},t[n]=i)}return t??e}function p(e,t){if(e.$link!==void 0){let n=(0,i.parseLexLink)(e);if(n)return n;if(t.strict)throw TypeError(`Invalid $link object`)}else if(e.$bytes!==void 0){let n=(0,r.parseLexBytes)(e);if(n)return n;if(t.strict)throw TypeError(`Invalid $bytes object`)}else if(e.$type!==void 0&&t.strict){if(e.$type===`blob`){let r=(0,n.parseBlobRef)(e,t);if(r)return r;throw TypeError(`Invalid blob object`)}else if(typeof e.$type!=`string`)throw TypeError(`Invalid $type property (${typeof e.$type})`);else if(e.$type.length===0)throw TypeError(`Empty $type property`)}}})),Z=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0});var t=(T(),n(l));t.__exportStar(zi(),e),t.__exportStar(Bi(),e),t.__exportStar(Ui(),e),t.__exportStar(Vi(),e)})),Wi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.parseWWWAuthenticateHeader=t;function t(e){if(typeof e!=`string`)return;let t={},n=e.trim();if(!n)return t;let r=n.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/),i=null;for(let e of r){let n=e.trim().match(/^([^"=\s]+)(\s+.*)?$/);if(n){let r=n[1];if(Object.hasOwn(t,r))return;let a=n[2]?.trim();if(!a){i=null,t[r]=Object.create(null);continue}if(!a.includes(`=`)){i=null,t[r]=a;continue}i=Object.create(null),t[r]=i,e=a}if(!i)return;let r=e.match(/^\s*([^"\s=]+)=(?:("[^"\\]*(?:\\.[^"\\]*)*")|([^\s,"]*))\s*$/);if(!r)return;let a=r[1],o=r[3]??r[2].slice(1,-1).replaceAll(/\\(.)/g,`$1`);i[a]=o}return t}})),Gi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.XrpcInternalError=e.XrpcUpstreamError=e.XrpcAuthenticationError=e.XrpcResponseError=e.XrpcError=e.LexError=e.RETRYABLE_HTTP_STATUS_CODES=void 0,e.isXrpcErrorPayload=i,e.asXrpcFailure=l;var t=G();Object.defineProperty(e,`LexError`,{enumerable:!0,get:function(){return t.LexError}});var n=Y(),r=Wi();e.RETRYABLE_HTTP_STATUS_CODES=new Set([408,425,429,500,502,503,504,522,524]);function i(e){return e!=null&&e.encoding===`application/json`&&n.lexErrorDataSchema.matches(e.body)}var a=class extends t.LexError{method;name=`XrpcError`;constructor(e,t,n=`${t} Lexicon RPC error`,r){super(t,n,r),this.method=e}success=!1;matchesSchema(){return this.method.errors?.includes(this.error)??!1}};e.XrpcError=a;var o=class extends a{response;payload;name=`XrpcResponseError`;constructor(e,t,n,r){let{error:i,message:a}=n.body;super(e,i,a,r),this.response=t,this.payload=n}get reason(){return this}shouldRetry(){return e.RETRYABLE_HTTP_STATUS_CODES.has(this.response.status)}toJSON(){return this.payload.body}toResponse(){if(this.matchesSchema()){let e=this.response.status>=500?502:this.response.status;return Response.json(this.toJSON(),{status:e})}return this.response.status>=500?Response.json({error:`UpstreamFailure`},{status:502}):Response.json({error:`InternalServerError`},{status:500})}get body(){return this.payload.body}};e.XrpcResponseError=o,e.XrpcAuthenticationError=class extends o{name=`XrpcAuthenticationError`;shouldRetry(){return!1}#e;get wwwAuthenticate(){return this.#e??=(0,r.parseWWWAuthenticateHeader)(this.response.headers.get(`www-authenticate`))??{}}};var s=class extends a{response;payload;name=`XrpcUpstreamError`;constructor(e,t,n=null,r=`Unexpected upstream XRPC response`,i){super(e,`UpstreamFailure`,r,i),this.response=t,this.payload=n}get reason(){return this}shouldRetry(){return e.RETRYABLE_HTTP_STATUS_CODES.has(this.response.status)}toResponse(){return Response.json(this.toJSON(),{status:502})}};e.XrpcUpstreamError=s;var c=class extends a{name=`XrpcInternalError`;constructor(e,t,n){super(e,`InternalServerError`,t??`Unable to fulfill XRPC request`,n)}get reason(){return this}shouldRetry(){return!0}toResponse(){return Response.json({error:this.error},{status:500})}};e.XrpcInternalError=c;function l(e,t){return(t instanceof o||t instanceof s||t instanceof c)&&t.method===e?t:new c(e,void 0,{cause:t})}})),Ki=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.XrpcResponse=void 0;var t=Z(),n=Gi(),r=`application/octet-stream`,i=`application/json`;e.XrpcResponse=class e{method;status;headers;payload;success=!0;get value(){return this}constructor(e,t,n,r){this.method=e,this.status=t,this.headers=n,this.payload=r}get isParsed(){return this.method.output.encoding===i}get encoding(){return this.payload?.encoding}get body(){return this.payload?.body}static async fromFetchResponse(t,r,o){if(r.status<200||r.status>=300){let e=await a(r,{parse:!0}).catch(e=>{throw new n.XrpcUpstreamError(t,r,null,`Unable to parse response payload`,{cause:e})});throw r.status>=400&&(0,n.isXrpcErrorPayload)(e)?r.status===401?new n.XrpcAuthenticationError(t,r,e):new n.XrpcResponseError(t,r,e):new n.XrpcUpstreamError(t,r,e,r.status>=500?`Upstream server encountered an error`:r.status>=400?`Invalid response payload`:`Invalid response status code`)}let s=await a(r,{parse:t.output.encoding===i}).catch(e=>{throw new n.XrpcUpstreamError(t,r,null,`Unable to parse response payload`,{cause:e})});if(t.output.encoding==null){if(s)throw new n.XrpcUpstreamError(t,r,s,`Expected response with no body, got ${s.encoding}`)}else{if(!s||!t.output.matchesEncoding(s.encoding))throw new n.XrpcUpstreamError(t,r,s,s?`Expected ${t.output.encoding} response, got ${s.encoding}`:`Expected non-empty response with content-type ${t.output.encoding}`);if(t.output.schema&&o?.validateResponse!==!1){let e=t.output.schema.safeParse(s.body);if(!e.success)throw new n.XrpcUpstreamError(t,r,s,`Response validation failed: ${e.reason.message}`,{cause:e.reason})}}return new e(t,r.status,r.headers,s)}};async function a(e,n){let a=e.headers.get(`content-type`)?.split(`;`)[0].trim().toLowerCase();if(!a){let t=await e.arrayBuffer();return t.byteLength===0?void 0:{encoding:r,body:new Uint8Array(t)}}if(n?.parse&&a===i){let n=await e.text();return{encoding:a,body:(0,t.lexParse)(n)}}return{encoding:a,body:new Uint8Array(await e.arrayBuffer())}}})),qi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.xrpc=c,e.xrpcSafe=l;var t=G(),n=Z(),r=Y(),i=Se(),a=Gi(),o=Ki(),s=Ri();async function c(e,t,n={}){let r=await l(e,t,n);if(r.success)return r;throw r}async function l(e,t,n={}){n.signal?.throwIfAborted();let s=(0,r.getMain)(t);try{let t=(0,i.buildAgent)(e),r=u(s,n),a=d(s,n),c=await t.fetchHandler(r,a);return await o.XrpcResponse.fromFetchResponse(s,c,n)}catch(e){return(0,a.asXrpcFailure)(s,e)}}function u(e,t){let n=`/xrpc/${e.nsid}`,r=e.parameters?.toURLSearchParams(t.params??{}).toString();return r?`${n}?${r}`:n}function d(e,t){let n=(0,s.buildAtprotoHeaders)(t);if(e.output.encoding&&n.set(`accept`,e.output.encoding),n.has(`content-type`)){let e=n.get(`content-type`);throw TypeError(`Unexpected content-type header (${e})`)}if(`input`in e){let r=t.encoding,i=f(e,t,r);if(i)n.set(`content-type`,i.encoding);else if(r!=null)throw TypeError(`Unexpected encoding hint (${r})`);return{duplex:`half`,redirect:`follow`,referrerPolicy:`strict-origin-when-cross-origin`,mode:`cors`,signal:t.signal,method:`POST`,headers:n,body:i?.body}}return{duplex:`half`,redirect:`follow`,referrerPolicy:`strict-origin-when-cross-origin`,mode:`cors`,signal:t.signal,method:`GET`,headers:n}}function f(e,r,i){let{input:a}=e,{body:o}=r;if(r.validateRequest&&a.schema?.check(o),a.encoding===`application/json`){if(!(0,t.isLexScalar)(o)&&!(0,t.isPlainObject)(o)&&!Array.isArray(o))throw TypeError(`Expected LexValue body, got ${typeof o}`);return p(a,(0,n.lexStringify)(o),i)}switch(typeof o){case`undefined`:case`string`:return p(a,o,i);case`object`:if(o===null)break;if(ArrayBuffer.isView(o)||o instanceof ArrayBuffer||o instanceof ReadableStream)return p(a,o,i);if((0,s.isAsyncIterable)(o))return p(a,(0,s.toReadableStream)(o),i);if((0,s.isBlobLike)(o))return p(a,o,i||o.type)}throw TypeError(`Invalid ${typeof o} body for ${a.encoding} encoding`)}function p(e,t,n){if(e.encoding===void 0){if(t!==void 0)throw TypeError(`Cannot send a ${typeof t} body with undefined encoding`);return null}if(t===void 0)throw TypeError(`A request body is expected but none was provided`);return{encoding:m(e,n),body:t}}function m(e,t){if(!e.encoding)throw TypeError(`Unexpected payload`);if(t?.length){if(!e.matchesEncoding(t))throw TypeError(`Cannot send a body with content-type "${t}" for "${e.encoding}" encoding`);return t}if(e.encoding===`*/*`)return`application/octet-stream`;if(e.encoding.startsWith(`text/`))return e.encoding.includes(`*`)?`text/plain; charset=utf-8`:`${e.encoding}; charset=utf-8`;if(!e.encoding.includes(`*`))return e.encoding;throw TypeError(`Unable to determine payload encoding. Please provide a 'content-type' header matching ${e.encoding}.`)}})),Ji=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.Client=void 0;var t=G(),n=Y(),r=Se(),i=Li(),a=Ri(),o=qi();e.Client=class{static appLabelers=[];static configure(e){e.appLabelers&&(this.appLabelers=[...e.appLabelers])}agent;headers;service;labelers;constructor(e,t={}){this.agent=(0,r.buildAgent)(e),this.service=t.service,this.labelers=new Set(t.labelers),this.headers=new Headers(t.headers)}get did(){return this.agent.did}get assertDid(){return this.assertAuthenticated(),this.did}assertAuthenticated(){if(!this.did)throw new t.LexError(`AuthenticationRequired`)}setLabelers(e=[]){this.clearLabelers(),this.addLabelers(e)}addLabelers(e){for(let t of e)this.labelers.add(t)}clearLabelers(){this.labelers.clear()}fetchHandler(e,t){let n=(0,a.buildAtprotoHeaders)({headers:t.headers,service:this.service,labelers:[...this.constructor.appLabelers.map(e=>`${e};redact`),...this.labelers]});for(let[e,t]of this.headers)n.has(e)||n.set(e,t);return this.agent.fetchHandler(e,{...t,headers:n})}async xrpc(e,t={}){return(0,o.xrpc)(this,e,t)}async xrpcSafe(e,t={}){return(0,o.xrpcSafe)(this,e,t)}async createRecord(e,t,n){return this.xrpc(i.com.atproto.repo.createRecord.main,{...n,body:{repo:n?.repo??this.assertDid,collection:e.$type,record:e,rkey:t,validate:n?.validate,swapCommit:n?.swapCommit}})}async deleteRecord(e,t,n){return this.xrpc(i.com.atproto.repo.deleteRecord.main,{...n,body:{repo:n?.repo??this.assertDid,collection:e,rkey:t,swapCommit:n?.swapCommit,swapRecord:n?.swapRecord}})}async getRecord(e,t,n){return this.xrpc(i.com.atproto.repo.getRecord.main,{...n,params:{repo:n?.repo??this.assertDid,collection:e,rkey:t}})}async putRecord(e,t,n){return this.xrpc(i.com.atproto.repo.putRecord.main,{...n,body:{repo:n?.repo??this.assertDid,collection:e.$type,rkey:t,record:e,validate:n?.validate,swapCommit:n?.swapCommit,swapRecord:n?.swapRecord}})}async listRecords(e,t){return this.xrpc(i.com.atproto.repo.listRecords.main,{...t,params:{repo:t?.repo??this.assertDid,collection:e,cursor:t?.cursor,limit:t?.limit,reverse:t?.reverse}})}async uploadBlob(e,t){return this.xrpc(i.com.atproto.repo.uploadBlob.main,{...t,body:e})}async getBlob(e,t,n){return this.xrpc(i.com.atproto.sync.getBlob.main,{...n,params:{did:e,cid:t}})}async call(e,t,r={}){let i=(0,n.getMain)(e);if(typeof i==`function`)return i(this,t,r);if(i instanceof n.Procedure)return(await this.xrpc(i,{...r,body:t})).body;if(i instanceof n.Query)return(await this.xrpc(i,{...r,params:t})).body;throw TypeError(`Invalid lexicon`)}async create(e,t,r={}){let i=(0,n.getMain)(e),a=i.build(t),o=r.rkey??s(i);return o!==void 0&&i.keySchema.assert(o),(await this.createRecord(a,o,r)).body}async delete(e,t={}){let r=(0,n.getMain)(e),i=r.keySchema.parse(t.rkey??c(r));return(await this.deleteRecord(r.$type,i,t)).body}async get(e,t={}){let r=(0,n.getMain)(e),i=r.keySchema.parse(t.rkey??c(r)),a=await this.getRecord(r.$type,i,t),o=r.validate(a.body.value);return{...a.body,value:o}}async put(e,t,r={}){let i=(0,n.getMain)(e),a=i.build(t),o=r.rkey??c(i);return(await this.putRecord(a,o,r)).body}async list(e,t){let r=(0,n.getMain)(e),{body:i}=await this.listRecords(r.$type,t),a=[],o=[];for(let e of i.records){let t=r.safeValidate(e.value);t.success?a.push({...e,value:t.value}):o.push(e.value)}return{...i,records:a,invalid:o}}};function s(e){if(e.key!==`tid`&&e.key!==`any`)return c(e)}function c(e){if(e.key.startsWith(`literal:`))return e.key.slice(8);throw TypeError(`An "rkey" must be provided for record key type "${e.key}" (${e.$type})`)}})),Yi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0})})),Xi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0});var t=(T(),n(l));t.__exportStar(Se(),e),t.__exportStar(Ji(),e),t.__exportStar(Gi(),e),t.__exportStar(Ki(),e),t.__exportStar(Yi(),e),t.__exportStar(qi(),e)})),Zi=r((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.lexToJson=e.lexStringify=e.lexParse=e.jsonToLex=e.l=e.xrpcSafe=e.xrpc=e.Client=void 0;var t=(T(),n(l)),r=Xi();Object.defineProperty(e,`Client`,{enumerable:!0,get:function(){return r.Client}}),Object.defineProperty(e,`xrpc`,{enumerable:!0,get:function(){return r.xrpc}}),Object.defineProperty(e,`xrpcSafe`,{enumerable:!0,get:function(){return r.xrpcSafe}}),t.__exportStar(Xi(),e);var i=Y();Object.defineProperty(e,`l`,{enumerable:!0,get:function(){return i.l}}),t.__exportStar(Y(),e),t.__exportStar(G(),e);var a=Z();Object.defineProperty(e,`jsonToLex`,{enumerable:!0,get:function(){return a.jsonToLex}}),Object.defineProperty(e,`lexParse`,{enumerable:!0,get:function(){return a.lexParse}}),Object.defineProperty(e,`lexStringify`,{enumerable:!0,get:function(){return a.lexStringify}}),Object.defineProperty(e,`lexToJson`,{enumerable:!0,get:function(){return a.lexToJson}}),t.__exportStar(Z(),e)})),Q=Zi(),Qi=Q.l.typedObject(`com.atproto.repo.strongRef`,`main`,Q.l.object({cid:Q.l.string({format:`cid`}),uri:Q.l.string({format:`at-uri`})}));Qi.$type;var $i=`dev.npmx.feed.like`;Q.l.record(`tid`,$i,Q.l.object({createdAt:Q.l.string({format:`datetime`}),subject:Q.l.optional(Q.l.ref((()=>Qi))),subjectRef:Q.l.string({format:`uri`})})).$type;const ea=`https://docs.npmx.dev`,ta=`https://public.api.bsky.app`,na=`https://registry.npmjs.org`,ra=`https://api.npmjs.org`,ia=`User needs to reauthenticate`;`${$i}`;const aa={light:{sky:`oklch(0.53 0.16 247.27)`,coral:`oklch(0.56 0.17 10.75)`,amber:`oklch(0.58 0.18 46.34)`,emerald:`oklch(0.51 0.13 162.4)`,violet:`oklch(0.56 0.13 282.067)`,magenta:`oklch(0.56 0.14 325)`,neutral:`oklch(0.145 0 0)`},dark:{sky:`oklch(0.787 0.128 230.318)`,coral:`oklch(0.704 0.177 14.75)`,amber:`oklch(0.828 0.165 84.429)`,emerald:`oklch(0.792 0.153 166.95)`,violet:`oklch(0.78 0.148 286.067)`,magenta:`oklch(0.78 0.15 330)`,neutral:`oklch(1 0 0)`}},oa={neutral:`oklch(0.555 0 0)`,stone:`oklch(0.555 0.013 58.123)`,zinc:`oklch(0.555 0.016 285.931)`,slate:`oklch(0.555 0.046 257.407)`,black:`oklch(0.4 0 0)`},sa=/^at:\/\/(did:plc:[a-z0-9]+)\/app\.bsky\.feed\.post\/([a-z0-9]+)$/,ca=()=>o(`color-mode`).value;var la={relativeDates:!1,includeTypesInInstall:!0,accentColorId:null,hidePlatformPackages:!0,selectedLocale:null,preferredBackgroundTheme:null,searchProvider:`algolia`,keyboardShortcuts:!0,connector:{autoOpenURL:!1},sidebar:{collapsed:[],animateSparkline:!0},chartFilter:{averageWindow:0,smoothingTau:1,anomaliesFixed:!0}},ua=`npmx-settings`,da=null;function $(){return da||=c(ua,la,{mergeDefaults:!0}),{settings:da}}function fa(){let{settings:e}=$();return i(()=>e.value.relativeDates)}const pa=s(function(){let{settings:e}=$(),t=i(()=>e.value.keyboardShortcuts);return a(t,e=>{e?delete document.documentElement.dataset.kbdShortcuts:document.documentElement.dataset.kbdShortcuts=`false`},{immediate:!0}),t});function ma(){let{settings:e}=$(),t=ca(),n=i(()=>{let e=t.value===`dark`?aa.dark:aa.light;return Object.entries(e).map(([e,t])=>({id:e,name:e,value:t}))});function r(t){t?document.documentElement.style.setProperty(`--accent-color`,`var(--swatch-${t})`):document.documentElement.style.removeProperty(`--accent-color`),e.value.accentColorId=t}return{accentColors:n,selectedAccentColor:i(()=>e.value.accentColorId),setAccentColor:r}}function ha(){let{settings:e}=$(),t=i({get:()=>e.value.searchProvider,set:t=>{e.value.searchProvider=t}}),n=i(()=>t.value===`algolia`);function r(){t.value=t.value===`npm`?`algolia`:`npm`}return{searchProvider:t,isAlgolia:n,toggle:r}}function ga(){let e=Object.entries(oa).map(([e,t])=>({id:e,name:e,value:t})),{settings:t}=$();function n(e){e?document.documentElement.dataset.bgTheme=e:document.documentElement.removeAttribute(`data-bg-theme`),t.value.preferredBackgroundTheme=e}return{backgroundThemes:e,selectedBackgroundTheme:i(()=>t.value.preferredBackgroundTheme),setBackgroundTheme:n}}export{ha as a,ta as c,ea as d,ra as f,fa as i,sa as l,Zi as m,ga as n,$ as o,na as p,pa as r,ca as s,ma as t,ia as u};