import{A as e,At as t,C as n,D as r,Dt as i,J as a,Nt as o,O as s,S as c,St as l,Z as ee,b as u,lt as d,m as te,ot as f,w as p,x as m}from"./BLt7TXlb.js";import{b as h,t as ne,u as re,z as g}from"./CreLCcZP.js";import"./ByNgdIzL.js";import"./Cr_GQgS6.js";import"./B2KNUzwv.js";import"./BFu3gPrq.js";import{n as _}from"./DZubR30v.js";import"./mPlC9-cP.js";import{t as ie}from"./CPwDbSjG.js";import{t as ae}from"./Cend_Z8Q.js";import{u as v}from"./Brdikwlz.js";import{t as y}from"./Cf-Ej6y2.js";import{t as oe}from"./HQH6yG0Z.js";import{t as se}from"./Dvsci_WM.js";import{t as ce}from"./DDB7HE7E.js";var le={class:`container flex-1 py-8 sm:py-12 w-full`},b={class:`mb-8 pb-8 border-b border-border`},x={class:`flex flex-wrap items-center gap-4 mb-4`},S={class:`font-mono text-2xl sm:text-3xl font-medium`},C={class:`text-fg-muted text-sm mt-1`},w={"aria-labelledby":`back-to-profile`},T={key:0,class:`py-12 text-center`},E={class:`text-fg-muted mb-4`},D={class:`text-fg-subtle text-sm`},O={key:1,class:`py-12 text-center`},k={class:`text-fg-muted`},A={key:3,role:`alert`,class:`py-12 text-center`},j={class:`text-fg-muted mb-4`},M={key:4,class:`py-12 text-center`},N={class:`text-fg-muted`},P={class:`text-fg-subtle text-sm mt-2`},F=[`aria-label`],I={class:`text-xs text-fg-subtle uppercase tracking-wider mb-4`},L={class:`grid gap-4 sm:grid-cols-2 lg:grid-cols-3`},R={class:`flex items-start gap-4 mb-4`},z={class:`w-14 h-14 rounded-lg bg-bg-muted border border-border flex items-center justify-center flex-shrink-0`,"aria-hidden":`true`},ue={class:`text-2xl text-fg-subtle font-mono`},B={class:`min-w-0 flex-1`},V={class:`font-mono text-lg text-fg truncate`},H={class:`flex items-center gap-4 text-sm text-fg-muted`},U={class:`flex items-center gap-1.5`},de={key:0},fe={key:2,class:`text-fg-subtle`},W=e({__name:`orgs`,setup(e){let{t:W}=_(),pe=g(`~username-orgs`),G=u(()=>pe.params.username),{isConnected:K,npmUser:q,listUserOrgs:me,listOrgUsers:J}=v(),Y=u(()=>K.value&&q.value?.toLowerCase()===G.value.toLowerCase()),X=l(!0),Z=l([]),Q=l(null);async function he(e){e.isLoadingDetails=!0;try{e.packageCount=(await $fetch(`/api/registry/org/${encodeURIComponent(e.name)}/packages`,{timeout:5e3})).count}catch{e.packageCount=null}try{let t=await J(e.name);if(t&&q.value){let n=q.value.toLowerCase();e.role=Object.entries(t).find(([e])=>e.toLowerCase()===n)?.[1]??null}}catch{e.role=null}e.isLoadingDetails=!1}async function $(){if(!Y.value){X.value=!1;return}X.value=!0,Q.value=null;try{let e=await me();e?(Z.value=e.map(e=>({name:e,role:null,packageCount:null,isLoadingDetails:!0})),await Promise.all(Z.value.map(e=>he(e)))):Q.value=W(`header.orgs_dropdown.error`)}catch(e){Q.value=e instanceof Error?e.message:W(`header.orgs_dropdown.error`)}finally{X.value=!1}}Q.value=W(`header.orgs_dropdown.error`),f(Y,$,{immediate:!0});function ge(e){switch(e){case`owner`:return`bg-purple-500/20 text-purple-300`;case`admin`:return`bg-blue-500/20 text-blue-300`;case`developer`:return`bg-green-500/20 text-green-300`;default:return`bg-fg-subtle/20 text-fg-muted`}}return h({title:()=>`@${G.value} Organizations - npmx`,ogTitle:()=>`@${G.value} Organizations - npmx`,twitterTitle:()=>`@${G.value} Organizations - npmx`,description:()=>`npm organizations for ${G.value}`,ogDescription:()=>`npm organizations for ${G.value}`,twitterDescription:()=>`npm organizations for ${G.value}`}),y(`Default`,{title:()=>`@${G.value}`,description:()=>{if(X.value)return`npm organizations`;if(Z.value.length===0)return`No organizations found`;let e=Z.value.length;return`${e} ${e===1?`organization`:`organizations`}`},primaryColor:`#60a5fa`}),(e,l)=>{let u=ce,f=ne,h=ie,g=oe,_=ae,v=se,y=re;return a(),p(`main`,le,[m(`header`,b,[m(`div`,x,[s(u,{username:i(G)},null,8,[`username`]),m(`div`,null,[m(`h1`,S,`~`+o(i(G)),1),m(`p`,C,o(i(W)(`user.orgs_page.title`)),1)])]),m(`nav`,w,[s(f,{to:{name:`~username`,params:{username:i(G)}},id:`back-to-profile`,class:`link-subtle font-mono text-sm inline-flex items-center gap-1.5`},{default:d(()=>[l[0]||=m(`span`,{class:`i-lucide:arrow-left rtl-flip w-4 h-4`,"aria-hidden":`true`},null,-1),r(` `+o(i(W)(`user.orgs_page.back_to_profile`)),1)]),_:1},8,[`to`])])]),s(y,null,{default:d(()=>[i(K)?i(Y)?i(X)?(a(),c(g,{key:2,text:i(W)(`user.orgs_page.loading`)},null,8,[`text`])):i(Q)?(a(),p(`div`,A,[m(`p`,j,o(i(Q)),1),s(_,{onClick:$},{default:d(()=>[r(o(i(W)(`common.try_again`)),1)]),_:1})])):i(Z).length===0?(a(),p(`div`,M,[m(`p`,N,o(i(W)(`user.orgs_page.empty`)),1),m(`p`,P,o(i(W)(`user.orgs_page.empty_hint`)),1)])):(a(),p(`section`,{key:5,"aria-label":i(W)(`user.orgs_page.title`)},[m(`h2`,I,o(i(W)(`user.orgs_page.count`,{count:i(Z).length},i(Z).length)),1),m(`ul`,L,[(a(!0),p(te,null,ee(i(Z),e=>(a(),p(`li`,{key:e.name},[s(f,{to:{name:`org`,params:{org:e.name}},class:`block p-5 bg-bg-subtle border border-border rounded-lg hover:border-fg-subtle transition-colors h-full`},{default:d(()=>[m(`div`,R,[m(`div`,z,[m(`span`,ue,o(e.name.charAt(0).toUpperCase()),1)]),m(`div`,B,[m(`h3`,V,`@`+o(e.name),1),e.role?(a(),p(`span`,{key:0,class:t([`inline-block mt-1 px-2 py-0.5 text-xs font-mono rounded`,ge(e.role)])},o(e.role),3)):e.isLoadingDetails?(a(),c(v,{key:1,class:`mt-1 h-5 w-16 rounded`})):n(``,!0)])]),m(`div`,H,[m(`div`,U,[l[2]||=m(`span`,{class:`i-lucide:box w-4 h-4`,"aria-hidden":`true`},null,-1),e.packageCount===null?e.isLoadingDetails?(a(),c(v,{key:1,class:`h-4 w-20`})):(a(),p(`span`,fe,`â€”`)):(a(),p(`span`,de,o(i(W)(`user.orgs_page.packages_count`,{count:e.packageCount},e.packageCount)),1))])])]),_:2},1032,[`to`])]))),128))])],8,F)):(a(),p(`div`,O,[m(`p`,k,o(i(W)(`user.orgs_page.own_orgs_only`)),1),s(h,{variant:`button-secondary`,to:{name:`~username-orgs`,params:{username:i(q)}},class:`mt-4`},{default:d(()=>[r(o(i(W)(`user.orgs_page.view_your_orgs`)),1)]),_:1},8,[`to`])])):(a(),p(`div`,T,[m(`p`,E,o(i(W)(`user.orgs_page.connect_required`)),1),m(`p`,D,[r(o(i(W)(`user.orgs_page.connect_hint_prefix`))+` `,1),l[1]||=m(`code`,{class:`font-mono bg-bg-subtle px-1.5 py-0.5 rounded`},`npx @npmx.dev/cli`,-1),r(` `+o(i(W)(`user.orgs_page.connect_hint_suffix`)),1)])]))]),_:1})])}}});export{W as default};