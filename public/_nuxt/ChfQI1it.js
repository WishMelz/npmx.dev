import{A as e,At as t,C as n,D as r,Dt as i,Et as a,J as o,Nt as s,O as c,S as l,St as u,Z as d,b as f,ht as p,lt as ee,m,ot as h,p as g,w as _,x as v,yt as y}from"./BLt7TXlb.js";import{B as b,F as te,N as x,b as ne,c as S,f as re,t as C,u as w,y as T,z as E}from"./CreLCcZP.js";import"./ByNgdIzL.js";import"./Cr_GQgS6.js";import"./B2KNUzwv.js";import"./BFu3gPrq.js";import{n as D}from"./DZubR30v.js";import{a as O}from"./mPlC9-cP.js";import{t as k}from"./CPwDbSjG.js";import{n as A}from"./DkotcqDl.js";import"./Cend_Z8Q.js";import"./CdWQmgpE.js";import"./JOw9R0Rj.js";import{m as j,u as ie}from"./Brdikwlz.js";import{t as M}from"./Cf-Ej6y2.js";import"./gZojCxWl.js";import"./Z_xnzAqw.js";import{t as N}from"./DQw8S1UI.js";import{n as P,r as F,t as I}from"./B_LT0yGC.js";import{t as L}from"./HQH6yG0Z.js";import{t as R}from"./CAwcA5eI.js";import{t as z}from"./CSgzCAtO.js";import{i as B,n as V,r as H,t as U}from"./DTGHBlvF.js";import{t as W}from"./Dg50IizM.js";import"./BDOMo5uf.js";var ae={key:0,class:`bg-bg-subtle border border-border rounded-lg overflow-hidden`},G={class:`flex items-center justify-between p-4 border-b border-border`},K={id:`members-heading`,class:`font-mono text-sm font-medium flex items-center gap-2`},q={key:0,class:`text-fg-muted`},oe=[`aria-label`,`disabled`],se={class:`flex flex-wrap items-center gap-2 p-3 border-b border-border bg-bg`},ce={class:`flex-1 min-w-[150px] relative`},le={for:`members-search`,class:`sr-only`},ue=[`aria-label`],de=[`aria-pressed`,`onClick`],fe={key:0,class:`text-fg-subtle`},pe={key:0},me=[`aria-label`],he=[`aria-pressed`],ge={key:0},J=[`aria-pressed`],_e={key:0},ve={key:0,class:`p-8 text-center`},ye={class:`font-mono text-sm text-fg-muted mt-2`},be={key:1,class:`p-4 text-center`,role:`alert`},xe={class:`font-mono text-sm text-red-400`},Y={key:2,class:`p-8 text-center`},Se={class:`font-mono text-sm text-fg-muted`},Ce=[`aria-label`],we={class:`flex items-center justify-between`},Te={class:`flex items-center gap-3`},Ee={class:`flex items-center gap-1`},De=[`for`],Oe=[`aria-label`,`onClick`],ke={key:0,class:`flex flex-wrap gap-1 ps-0`},Ae=[`aria-label`,`onClick`],je={key:4,class:`p-4 text-center`},Me={class:`font-mono text-sm text-fg-muted`},Ne={class:`p-3 border-t border-border`},Pe={key:0},Fe={for:`new-member-username`,class:`sr-only`},Ie={class:`flex items-center gap-2`},Le=[`disabled`],Re=[`aria-label`],X=e({__name:`MembersPanel`,props:{orgName:{}},emits:[`select-team`],setup(e,{emit:a}){let{t:l}=D(),b=e,te=a,{isConnected:x,lastExecutionTime:ne,listOrgUsers:S,listOrgTeams:re,listTeamUsers:w,addOperation:T,error:E}=ie(),O=u({}),k=u(!1),A=u(null),M=y({}),N=u(!1),P=u(``),F=u(`all`),I=u(``),L=u(`name`),B=u(`asc`),V=u(!1),H=u(``),U=u(`developer`),W=u(``),X=u(!1),ze={owner:0,admin:1,developer:2};function Be(e){let t=[];for(let[n,r]of Object.entries(M.value))r.includes(e)&&t.push(n);return t.sort()}let Ve=f(()=>Object.keys(M.value).sort()),Z=f(()=>Object.entries(O.value).map(([e,t])=>({name:e,role:t,teams:Be(e)}))),He=f(()=>{let e=Z.value;if(P.value.trim()){let t=P.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t))}return F.value!==`all`&&(e=e.filter(e=>e.role===F.value)),I.value&&(e=e.filter(e=>e.teams.includes(I.value))),e=[...e].sort((e,t)=>{if(L.value===`name`)return B.value===`asc`?e.name.localeCompare(t.name):t.name.localeCompare(e.name);{let n=ze[e.role]-ze[t.role];return B.value===`asc`?n:-n}}),e}),Ue=f(()=>{let e={developer:0,admin:0,owner:0};for(let t of Object.values(O.value))e[t]++;return e});function We(){Q(),Ge()}async function Q(){if(x.value){k.value=!0,A.value=null;try{let e=await S(b.orgName);e?O.value=e:A.value=E.value||`Failed to load members`}finally{k.value=!1}}}async function Ge(){if(x.value){N.value=!0;try{let e=await re(b.orgName);if(e){let t=e.map(async e=>{let t=e.replace(`${b.orgName}:`,``),n=await w(z(b.orgName,t));n&&(M.value[t]=n)});await Promise.all(t)}}finally{N.value=!1}}}async function Ke(){if(H.value.trim()){X.value=!0;try{let e=H.value.trim().replace(/^@/,``),t=await T({type:`org:add-user`,params:{org:b.orgName,user:e,role:U.value},description:`Add @${e} to @${b.orgName} as ${U.value}`,command:`npm org set ${b.orgName} ${e} ${U.value}`});if(W.value&&t){let n=z(b.orgName,W.value);await T({type:`team:add-user`,params:{scopeTeam:n,user:e},description:`Add @${e} to team ${W.value}`,command:`npm team add ${n} ${e}`,dependsOn:t.id})}H.value=``,W.value=``,V.value=!1}finally{X.value=!1}}}async function qe(e){await T({type:`org:rm-user`,params:{org:b.orgName,user:e},description:`Remove @${e} from @${b.orgName}`,command:`npm org rm ${b.orgName} ${e}`})}async function Je(e,t){await T({type:`org:add-user`,params:{org:b.orgName,user:e,role:t},description:`Change @${e} role to ${t} in @${b.orgName}`,command:`npm org set ${b.orgName} ${e} ${t}`})}function Ye(e){L.value===e?B.value=B.value===`asc`?`desc`:`asc`:(L.value=e,B.value=`asc`)}function Xe(e){switch(e){case`owner`:return`bg-purple-500/20 text-purple-400 border-purple-500/30`;case`admin`:return`bg-blue-500/20 text-blue-400 border-blue-500/30`;default:return`bg-fg-subtle/20 text-fg-muted border-border`}}let Ze=f(()=>({owner:l(`org.members.role.owner`),admin:l(`org.members.role.admin`),developer:l(`org.members.role.developer`),all:l(`org.members.role.all`)}));function $(e){return Ze.value[e]}function Qe(e){te(`select-team`,e)}return h(x,e=>{e&&(Q(),Ge())},{immediate:!0}),h(ne,()=>{x.value&&(Q(),Ge())}),(e,a)=>{let u=j,f=R,h=C;return i(x)?(o(),_(`section`,ae,[v(`div`,G,[v(`h2`,K,[a[9]||=v(`span`,{class:`i-lucide:users w-4 h-4 text-fg-muted`,"aria-hidden":`true`},null,-1),r(` `+s(i(l)(`org.members.title`))+` `,1),i(Z).length>0?(o(),_(`span`,q,`(`+s(i(Z).length)+`)`,1)):n(``,!0)]),v(`button`,{type:`button`,class:`p-1.5 text-fg-muted hover:text-fg transition-colors duration-200 rounded focus-visible:outline-accent/70`,"aria-label":i(l)(`org.members.refresh`),disabled:i(k),onClick:We},[v(`span`,{class:t([`i-lucide:refresh-ccw w-4 h-4`,{"motion-safe:animate-spin":i(k)||i(N)}]),"aria-hidden":`true`},null,2)],8,oe)]),v(`div`,se,[v(`div`,ce,[a[10]||=v(`span`,{class:`absolute inset-is-2 top-1/2 -translate-y-1/2 i-lucide:search w-3.5 h-3.5 text-fg-subtle`,"aria-hidden":`true`},null,-1),v(`label`,le,s(i(l)(`org.members.filter_label`)),1),c(u,{id:`members-search`,modelValue:i(P),"onUpdate:modelValue":a[0]||=e=>p(P)?P.value=e:null,type:`search`,name:`members-search`,placeholder:i(l)(`org.members.filter_placeholder`),"no-correct":``,class:`w-full min-w-25 ps-7`,size:`small`},null,8,[`modelValue`,`placeholder`])]),v(`div`,{class:`flex items-center gap-1`,role:`group`,"aria-label":i(l)(`org.members.filter_by_role`)},[(o(),_(m,null,d([`all`,`owner`,`admin`,`developer`],e=>v(`button`,{key:e,type:`button`,class:t([`px-2 py-1 font-mono text-xs rounded transition-colors duration-200 focus-visible:outline-accent/70`,i(F)===e?`bg-bg-muted text-fg`:`text-fg-muted hover:text-fg`]),"aria-pressed":i(F)===e,onClick:t=>F.value=e},[r(s($(e))+` `,1),e===`all`?n(``,!0):(o(),_(`span`,fe,`(`+s(i(Ue)[e])+`)`,1))],10,de)),64))],8,ue),i(Ve).length>0?(o(),_(`div`,pe,[c(f,{label:i(l)(`org.members.filter_by_team`),"hidden-label":``,id:`team-filter`,modelValue:i(I),"onUpdate:modelValue":a[1]||=e=>p(I)?I.value=e:null,name:`team-filter`,block:``,size:`sm`,items:[{label:i(l)(`org.members.all_teams`),value:``},...i(Ve).map(e=>({label:e,value:e}))]},null,8,[`label`,`modelValue`,`items`])])):n(``,!0),v(`div`,{class:`flex items-center gap-1 text-xs`,role:`group`,"aria-label":i(l)(`org.members.sort_by`)},[v(`button`,{type:`button`,class:t([`px-2 py-1 font-mono rounded transition-colors duration-200 focus-visible:outline-accent/70`,i(L)===`name`?`bg-bg-muted text-fg`:`text-fg-muted hover:text-fg`]),"aria-pressed":i(L)===`name`,onClick:a[2]||=e=>Ye(`name`)},[r(s(i(l)(`common.sort.name`))+` `,1),i(L)===`name`?(o(),_(`span`,ge,s(i(B)===`asc`?`↑`:`↓`),1)):n(``,!0)],10,he),v(`button`,{type:`button`,class:t([`px-2 py-1 font-mono rounded transition-colors duration-200 focus-visible:outline-accent/70`,i(L)===`role`?`bg-bg-muted text-fg`:`text-fg-muted hover:text-fg`]),"aria-pressed":i(L)===`role`,onClick:a[3]||=e=>Ye(`role`)},[r(s(i(l)(`common.sort.role`))+` `,1),i(L)===`role`?(o(),_(`span`,_e,s(i(B)===`asc`?`↑`:`↓`),1)):n(``,!0)],10,J)],8,me)]),i(k)&&i(Z).length===0?(o(),_(`div`,ve,[a[11]||=v(`span`,{class:`i-svg-spinners:ring-resize w-5 h-5 text-fg-muted animate-spin mx-auto`,"aria-hidden":`true`},null,-1),v(`p`,ye,s(i(l)(`org.members.loading`)),1)])):i(A)?(o(),_(`div`,be,[v(`p`,xe,s(i(A)),1),v(`button`,{type:`button`,class:`mt-2 font-mono text-xs text-fg-muted hover:text-fg transition-colors duration-200 rounded focus-visible:outline-accent/70`,onClick:Q},s(i(l)(`common.try_again`)),1)])):i(Z).length===0?(o(),_(`div`,Y,[v(`p`,Se,s(i(l)(`org.members.no_members`)),1)])):(o(),_(`ul`,{key:3,class:`divide-y divide-border max-h-[400px] overflow-y-auto`,"aria-label":i(l)(`org.members.list_label`)},[(o(!0),_(m,null,d(i(He),e=>(o(),_(`li`,{key:e.name,class:`flex flex-col gap-2 p-3 bg-bg hover:bg-bg-subtle transition-colors duration-200`},[v(`div`,we,[v(`div`,Te,[c(h,{to:{name:`~username`,params:{username:e.name}},class:`font-mono text-sm text-fg hover:text-fg transition-colors duration-200`},{default:ee(()=>[r(` ~`+s(e.name),1)]),_:2},1032,[`to`]),v(`span`,{class:t([`px-1.5 py-0.5 font-mono text-xs border rounded`,Xe(e.role)])},s($(e.role)),3)]),v(`div`,Ee,[v(`label`,{for:`role-${e.name}`,class:`sr-only`},s(i(l)(`org.members.change_role_for`,{name:e.name})),9,De),c(f,{label:i(l)(`org.members.change_role_for`,{name:e.name}),"hidden-label":``,id:`role-${e.name}`,"model-value":e.role,name:`role-${e.name}`,block:``,size:`sm`,items:[{label:$(`developer`),value:`developer`},{label:$(`admin`),value:`admin`},{label:$(`owner`),value:`owner`}],value:e.role,"onUpdate:modelValue":t=>Je(e.name,t)},null,8,[`label`,`id`,`model-value`,`name`,`items`,`value`,`onUpdate:modelValue`]),v(`button`,{type:`button`,class:`p-1 text-fg-subtle hover:text-red-400 transition-colors duration-200 rounded focus-visible:outline-accent/70`,"aria-label":i(l)(`org.members.remove_from_org`,{name:e.name}),onClick:t=>qe(e.name)},[...a[12]||=[v(`span`,{class:`i-lucide:x w-4 h-4`,"aria-hidden":`true`},null,-1)]],8,Oe)])]),e.teams.length>0?(o(),_(`div`,ke,[(o(!0),_(m,null,d(e.teams,e=>(o(),_(`button`,{key:e,type:`button`,class:`inline-flex items-center gap-1 px-1.5 py-0.5 font-mono text-xs text-fg-muted border border-border rounded hover:text-fg hover:border-border-hover transition-colors duration-200 focus-visible:outline-accent/70`,"aria-label":i(l)(`org.members.view_team`,{team:e}),onClick:t=>Qe(e)},s(e),9,Ae))),128))])):n(``,!0)]))),128))],8,Ce)),i(Z).length>0&&i(He).length===0?(o(),_(`div`,je,[v(`p`,Me,s(i(l)(`org.members.no_match`)),1)])):n(``,!0),v(`div`,Ne,[i(V)?(o(),_(`div`,Pe,[v(`form`,{class:`space-y-2`,onSubmit:g(Ke,[`prevent`])},[v(`label`,Fe,s(i(l)(`org.members.username_label`)),1),c(u,{id:`new-member-username`,modelValue:i(H),"onUpdate:modelValue":a[4]||=e=>p(H)?H.value=e:null,type:`text`,name:`new-member-username`,placeholder:i(l)(`org.members.username_placeholder`),"no-correct":``,class:`w-full min-w-25`,size:`small`},null,8,[`modelValue`,`placeholder`]),v(`div`,Ie,[c(f,{label:i(l)(`org.members.role_label`),"hidden-label":``,id:`new-member-role`,modelValue:i(U),"onUpdate:modelValue":a[5]||=e=>p(U)?U.value=e:null,name:`new-member-role`,block:``,class:`flex-1`,size:`sm`,items:[{label:i(l)(`org.members.role.developer`),value:`developer`},{label:i(l)(`org.members.role.admin`),value:`admin`},{label:i(l)(`org.members.role.owner`),value:`owner`}]},null,8,[`label`,`modelValue`,`items`]),c(f,{label:i(l)(`org.members.team_label`),"hidden-label":``,id:`new-member-team`,modelValue:i(W),"onUpdate:modelValue":a[6]||=e=>p(W)?W.value=e:null,name:`new-member-team`,block:``,class:`flex-1`,size:`sm`,items:[{label:i(l)(`org.members.no_team`),value:``},...i(Ve).map(e=>({label:e,value:e}))]},null,8,[`label`,`modelValue`,`items`]),v(`button`,{type:`submit`,disabled:!i(H).trim()||i(X),class:`px-3 py-2 font-mono text-xs text-bg bg-fg rounded transition-all duration-200 hover:bg-fg/90 disabled:opacity-50 disabled:cursor-not-allowed focus-visible:outline-accent/70`},s(i(X)?`…`:i(l)(`org.members.add_button`)),9,Le),v(`button`,{type:`button`,class:`p-1.5 text-fg-subtle hover:text-fg transition-colors duration-200 rounded focus-visible:outline-accent/70`,"aria-label":i(l)(`org.members.cancel_add`),onClick:a[7]||=e=>V.value=!1},[...a[13]||=[v(`span`,{class:`i-lucide:x w-4 h-4`,"aria-hidden":`true`},null,-1)]],8,Re)])],32)])):(o(),_(`button`,{key:1,type:`button`,class:`w-full px-3 py-2 font-mono text-sm text-fg-muted bg-bg border border-border rounded transition-colors duration-200 hover:text-fg hover:border-border-hover focus-visible:outline-accent/70`,onClick:a[8]||=e=>V.value=!0},s(i(l)(`org.members.add_member`)),1))])])):n(``,!0)}}}),ze=Object.assign(X,{__name:`OrgMembersPanel`}),Be={key:0,class:`bg-bg-subtle border border-border rounded-lg overflow-hidden`},Ve={class:`flex items-center justify-start p-4 border-b border-border`},Z={id:`teams-heading`,class:`font-mono text-sm font-medium flex items-center gap-2`},He={key:0,class:`text-fg-muted`},Ue=[`aria-label`,`disabled`],We={class:`flex items-center gap-2 p-3 border-b border-border bg-bg`},Q={class:`flex-1 relative`},Ge={for:`teams-search`,class:`sr-only`},Ke=[`aria-label`],qe=[`aria-pressed`],Je={key:0},Ye=[`aria-pressed`],Xe={key:0},Ze={key:0,class:`p-8 text-center`},$={class:`font-mono text-sm text-fg-muted mt-2`},Qe={key:1,class:`p-4 text-center`,role:`alert`},$e={class:`font-mono text-sm text-red-400`},et={key:2,class:`p-8 text-center`},tt={class:`font-mono text-sm text-fg-muted`},nt=[`aria-label`],rt={class:`flex items-center justify-start p-3 hover:bg-bg-subtle transition-colors duration-200`},it=[`aria-expanded`,`aria-controls`,`onClick`],at={class:`font-mono text-sm text-fg`},ot={key:0,class:`font-mono text-xs text-fg-subtle`},st={key:1,class:`i-svg-spinners:ring-resize w-3 h-3 text-fg-muted`,"aria-hidden":`true`},ct=[`aria-label`,`onClick`],lt=[`id`],ut=[`aria-label`],dt={class:`font-mono text-sm text-fg mx-2`},ft=[`aria-label`,`onClick`],pt={key:1,class:`font-mono text-xs text-fg-subtle py-1`},mt={key:2,class:`mt-2`},ht=[`onSubmit`],gt=[`for`],_t=[`disabled`],vt=[`aria-label`],yt=[`onClick`],bt={key:4,class:`p-4 text-center`},xt={class:`font-mono text-sm text-fg-muted`},St={class:`p-3 border-t border-border`},Ct={key:0},wt={class:`flex-1 flex items-center`},Tt={class:`px-2 py-3 leading-none font-mono text-sm text-fg-subtle bg-bg border border-ie-0 border-border rounded-is`},Et={for:`new-team-name`,class:`sr-only`},Dt=[`disabled`],Ot=[`aria-label`],kt=e({__name:`TeamsPanel`,props:{orgName:{}},setup(e){let a=e,{isConnected:l,lastExecutionTime:b,listOrgTeams:te,listOrgUsers:x,listTeamUsers:ne,addOperation:S,error:re}=ie(),w=u([]),T=y({}),E=u(!1),D=y({}),O=u(null),k=u({}),A=u(``),M=u(`name`),N=u(`asc`),P=y(new Set),F=u(!1),I=u(``),L=u(!1),R=u(null),B=u(``),V=u(!1),H=f(()=>{let e=w.value;if(A.value.trim()){let t=A.value.toLowerCase();e=e.filter(e=>e.toLowerCase().includes(t))}return e=[...e].sort((e,t)=>{if(M.value===`name`)return N.value===`asc`?e.localeCompare(t):t.localeCompare(e);{let n=T.value[e]?.length??0,r=T.value[t]?.length??0;return N.value===`asc`?n-r:r-n}}),e});async function U(){if(l.value){E.value=!0,O.value=null;try{let[e,t]=await Promise.all([te(a.orgName),x(a.orgName)]);e?w.value=e.map(e=>e.replace(`${a.orgName}:`,``)):O.value=re.value||`Failed to load teams`,t&&(k.value=t)}finally{E.value=!1}}}async function W(e){if(l.value){D.value[e]=!0;try{let t=await ne(z(a.orgName,e));t&&(T.value[e]=t)}finally{D.value[e]=!1}}}async function ae(e){P.value.has(e)?P.value.delete(e):(P.value.add(e),T.value[e]||await W(e)),P.value=new Set(P.value)}async function G(){if(I.value.trim()){L.value=!0;try{let e=I.value.trim(),t=z(a.orgName,e);await S({type:`team:create`,params:{scopeTeam:t},description:`Create team ${t}`,command:`npm team create ${t}`}),I.value=``,F.value=!1}finally{L.value=!1}}}async function K(e){let t=z(a.orgName,e);await S({type:`team:destroy`,params:{scopeTeam:t},description:`Destroy team ${t}`,command:`npm team destroy ${t}`})}async function q(e){if(B.value.trim()){V.value=!0;try{let t=B.value.trim().replace(/^@/,``),n=z(a.orgName,e),r;if(!(t in k.value)){let e=await S({type:`org:add-user`,params:{org:a.orgName,user:t,role:`developer`},description:`Add @${t} to @${a.orgName} as developer`,command:`npm org set ${a.orgName} ${t} developer`});e&&(r=e.id)}await S({type:`team:add-user`,params:{scopeTeam:n,user:t},description:`Add @${t} to team ${e}`,command:`npm team add ${n} ${t}`,dependsOn:r}),B.value=``,R.value=null}finally{V.value=!1}}}async function oe(e,t){let n=z(a.orgName,e);await S({type:`team:rm-user`,params:{scopeTeam:n,user:t},description:`Remove @${t} from ${n}`,command:`npm team rm ${n} ${t}`})}function se(e){M.value===e?N.value=N.value===`asc`?`desc`:`asc`:(M.value=e,N.value=`asc`)}return h(l,e=>{e&&U()},{immediate:!0}),h(b,()=>{l.value&&U()}),(a,u)=>{let f=j,h=C;return i(l)?(o(),_(`section`,Be,[v(`div`,Ve,[v(`h2`,Z,[u[8]||=v(`span`,{class:`i-lucide:users w-4 h-4 text-fg-muted`,"aria-hidden":`true`},null,-1),r(` `+s(a.$t(`org.teams.title`))+` `,1),i(w).length>0?(o(),_(`span`,He,`(`+s(i(w).length)+`)`,1)):n(``,!0)]),u[9]||=v(`span`,{"aria-hidden":`true`,class:`flex-shrink-1 flex-grow-1`},null,-1),v(`button`,{type:`button`,class:`p-1.5 text-fg-muted hover:text-fg transition-colors duration-200 rounded focus-visible:outline-accent/70`,"aria-label":a.$t(`org.teams.refresh`),disabled:i(E),onClick:U},[v(`span`,{class:t([`i-lucide:refresh-ccw w-4 h-4`,{"animate-spin":i(E)}]),"aria-hidden":`true`},null,2)],8,Ue)]),v(`div`,We,[v(`div`,Q,[u[10]||=v(`span`,{class:`absolute inset-is-2 top-1/2 -translate-y-1/2 i-lucide:search w-3.5 h-3.5 text-fg-subtle`,"aria-hidden":`true`},null,-1),v(`label`,Ge,s(a.$t(`org.teams.filter_label`)),1),c(f,{id:`teams-search`,modelValue:i(A),"onUpdate:modelValue":u[0]||=e=>p(A)?A.value=e:null,type:`search`,name:`teams-search`,placeholder:a.$t(`org.teams.filter_placeholder`),"no-correct":``,class:`w-full min-w-25 ps-7`,size:`medium`},null,8,[`modelValue`,`placeholder`])]),v(`div`,{class:`flex items-center gap-1 text-xs`,role:`group`,"aria-label":a.$t(`org.teams.sort_by`)},[v(`button`,{type:`button`,class:t([`px-2 py-1 font-mono rounded transition-colors duration-200 focus-visible:outline-accent/70`,i(M)===`name`?`bg-bg-muted text-fg`:`text-fg-muted hover:text-fg`]),"aria-pressed":i(M)===`name`,onClick:u[1]||=e=>se(`name`)},[r(s(a.$t(`common.sort.name`))+` `,1),i(M)===`name`?(o(),_(`span`,Je,s(i(N)===`asc`?`↑`:`↓`),1)):n(``,!0)],10,qe),v(`button`,{type:`button`,class:t([`px-2 py-1 font-mono rounded transition-colors duration-200 focus-visible:outline-accent/70`,i(M)===`members`?`bg-bg-muted text-fg`:`text-fg-muted hover:text-fg`]),"aria-pressed":i(M)===`members`,onClick:u[2]||=e=>se(`members`)},[r(s(a.$t(`common.sort.members`))+` `,1),i(M)===`members`?(o(),_(`span`,Xe,s(i(N)===`asc`?`↑`:`↓`),1)):n(``,!0)],10,Ye)],8,Ke)]),i(E)&&i(w).length===0?(o(),_(`div`,Ze,[u[11]||=v(`span`,{class:`i-svg-spinners:ring-resize w-5 h-5 text-fg-muted mx-auto`,"aria-hidden":`true`},null,-1),v(`p`,$,s(a.$t(`org.teams.loading`)),1)])):i(O)?(o(),_(`div`,Qe,[v(`p`,$e,s(i(O)),1),v(`button`,{type:`button`,class:`mt-2 font-mono text-xs text-fg-muted hover:text-fg transition-colors duration-200 rounded focus-visible:outline-accent/70`,onClick:U},s(a.$t(`common.try_again`)),1)])):i(w).length===0?(o(),_(`div`,et,[v(`p`,tt,s(a.$t(`org.teams.no_teams`)),1)])):(o(),_(`ul`,{key:3,class:`divide-y divide-border`,"aria-label":a.$t(`org.teams.list_label`)},[(o(!0),_(m,null,d(i(H),e=>(o(),_(`li`,{key:e,class:`bg-bg`},[v(`div`,rt,[v(`button`,{type:`button`,class:`flex-1 flex items-center gap-2 text-start rounded focus-visible:outline-accent/70`,"aria-expanded":i(P).has(e),"aria-controls":`team-${e}-members`,onClick:t=>ae(e)},[v(`span`,{class:t([`w-4 h-4 transition-transform duration-200 rtl-flip`,[i(P).has(e)?`i-lucide:chevron-down`:`i-lucide:chevron-right`,`text-fg-muted`]]),"aria-hidden":`true`},null,2),v(`span`,at,s(e),1),i(T)[e]?(o(),_(`span`,ot,` (`+s(a.$t(`org.teams.member_count`,{count:i(T)[e].length},i(T)[e].length))+`) `,1)):n(``,!0),i(D)[e]?(o(),_(`span`,st)):n(``,!0)],8,it),u[13]||=v(`span`,{"aria-hidden":`true`,class:`flex-shrink-1 flex-grow-1`},null,-1),v(`button`,{type:`button`,class:`p-1 text-fg-subtle hover:text-red-400 transition-colors duration-200 rounded focus-visible:outline-accent/70`,"aria-label":a.$t(`org.teams.delete_team`,{name:e}),onClick:g(t=>K(e),[`stop`])},[...u[12]||=[v(`span`,{class:`i-lucide:trash w-4 h-4`,"aria-hidden":`true`},null,-1)]],8,ct)]),i(P).has(e)?(o(),_(`div`,{key:0,id:`team-${e}-members`,class:`ps-9 pe-3 pb-3`},[i(T)[e]?.length?(o(),_(`ul`,{key:0,class:`space-y-1 mb-2`,"aria-label":a.$t(`org.teams.members_of`,{team:e})},[(o(!0),_(m,null,d(i(T)[e],t=>(o(),_(`li`,{key:t,class:`flex items-center justify-start py-1 ps-2 pe-1 rounded hover:bg-bg-subtle transition-colors duration-200`},[c(h,{to:{name:`~username`,params:{username:t}},class:`font-mono text-sm text-fg-muted hover:text-fg transition-colors duration-200`},{default:ee(()=>[r(` ~`+s(t),1)]),_:2},1032,[`to`]),v(`span`,dt,s(e),1),v(`button`,{type:`button`,class:`p-1 text-fg-subtle hover:text-red-400 transition-colors duration-200 rounded focus-visible:outline-accent/70`,"aria-label":a.$t(`org.teams.remove_user`,{user:t}),onClick:n=>oe(e,t)},[...u[14]||=[v(`span`,{class:`i-lucide:x w-3.5 h-3.5`,"aria-hidden":`true`},null,-1)]],8,ft)]))),128))],8,ut)):i(D)[e]?n(``,!0):(o(),_(`p`,pt,s(a.$t(`org.teams.no_members`)),1)),i(R)===e?(o(),_(`div`,mt,[v(`form`,{class:`flex items-center gap-2`,onSubmit:g(t=>q(e),[`prevent`])},[v(`label`,{for:`add-user-${e}`,class:`sr-only`},s(a.$t(`org.teams.username_to_add`,{team:e})),9,gt),c(f,{id:`add-user-${e}`,modelValue:i(B),"onUpdate:modelValue":u[3]||=e=>p(B)?B.value=e:null,type:`text`,name:`add-user-${e}`,placeholder:a.$t(`org.teams.username_placeholder`),"no-correct":``,class:`flex-1 min-w-25`,size:`medium`},null,8,[`id`,`modelValue`,`name`,`placeholder`]),v(`button`,{type:`submit`,disabled:!i(B).trim()||i(V),class:`px-2 py-1 font-mono text-xs text-bg bg-fg rounded transition-all duration-200 hover:bg-fg/90 disabled:opacity-50 disabled:cursor-not-allowed focus-visible:outline-accent/70`},s(i(V)?`…`:a.$t(`org.teams.add_button`)),9,_t),v(`button`,{type:`button`,class:`p-1 text-fg-subtle hover:text-fg transition-colors duration-200 rounded focus-visible:outline-accent/70`,"aria-label":a.$t(`org.teams.cancel_add_user`),onClick:u[4]||=e=>R.value=null},[...u[15]||=[v(`span`,{class:`i-lucide:x w-4 h-4`,"aria-hidden":`true`},null,-1)]],8,vt)],40,ht)])):(o(),_(`button`,{key:3,type:`button`,class:`mt-2 px-2 py-1 font-mono text-xs text-fg-muted hover:text-fg transition-colors duration-200 rounded focus-visible:outline-accent/70`,onClick:t=>R.value=e},s(a.$t(`org.teams.add_member`)),9,yt))],8,lt)):n(``,!0)]))),128))],8,nt)),i(w).length>0&&i(H).length===0?(o(),_(`div`,bt,[v(`p`,xt,s(a.$t(`org.teams.no_match`,{query:i(A)})),1)])):n(``,!0),v(`div`,St,[i(F)?(o(),_(`div`,Ct,[v(`form`,{class:`flex items-center gap-2`,onSubmit:g(G,[`prevent`])},[v(`div`,wt,[v(`span`,Tt,s(e.orgName)+`: `,1),v(`label`,Et,s(a.$t(`org.teams.team_name_label`)),1),c(f,{id:`new-team-name`,modelValue:i(I),"onUpdate:modelValue":u[5]||=e=>p(I)?I.value=e:null,type:`text`,name:`new-team-name`,placeholder:a.$t(`org.teams.team_name_placeholder`),"no-correct":``,class:`flex-1 min-w-25 rounded-is-none`,size:`medium`},null,8,[`modelValue`,`placeholder`])]),v(`button`,{type:`submit`,disabled:!i(I).trim()||i(L),class:`px-3 py-2 font-mono text-xs text-bg bg-fg rounded transition-all duration-200 hover:bg-fg/90 disabled:opacity-50 disabled:cursor-not-allowed focus-visible:outline-accent/70`},s(i(L)?`…`:a.$t(`org.teams.create_button`)),9,Dt),v(`button`,{type:`button`,class:`p-1.5 text-fg-subtle hover:text-fg transition-colors duration-200 rounded focus-visible:outline-accent/70`,"aria-label":a.$t(`org.teams.cancel_create`),onClick:u[6]||=e=>F.value=!1},[...u[16]||=[v(`span`,{class:`i-lucide:x w-4 h-4`,"aria-hidden":`true`},null,-1)]],8,Ot)],32)])):(o(),_(`button`,{key:1,type:`button`,class:`w-full px-3 py-2 font-mono text-sm text-fg-muted bg-bg border border-border rounded transition-colors duration-200 hover:text-fg hover:border-border-hover focus-visible:outline-accent/70`,onClick:u[7]||=e=>F.value=!0},s(a.$t(`org.teams.create_team`)),1))])])):n(``,!0)}}}),At=Object.assign(kt,{__name:`OrgTeamsPanel`});async function jt(e,t,n=10){let r=Array.from({length:e.length}),i=0;async function a(){for(;i<e.length;){let n=i++;r[n]=await t(e[n],n)}}let o=Array.from({length:Math.min(n,e.length)},()=>a());return await Promise.all(o),r}function Mt(e){let t=E(),{searchProvider:n}=O(),r=f(()=>A(t.query.p)===`npm`||n.value===`npm`?`npm`:`algolia`),{getPackagesByName:i}=I();return S(()=>`org-packages:${r.value}:${a(e)}`,async({ssrContext:t},{signal:n})=>{let o=a(e);if(!o)return P();let s;try{let{packages:e}=await $fetch(`/api/registry/org/${encodeURIComponent(o)}/packages`,{signal:n});s=e}catch(e){if(e&&typeof e==`object`&&`statusCode`in e&&e.statusCode===404)throw x({statusCode:404,statusMessage:`Organization not found`,message:`The organization "@${o}" does not exist on npm`});s=[]}if(s.length===0)return P();if(r.value===`algolia`)try{let e=await i(s);if(e.objects.length>0)return e}catch{}let c=(await jt(s,async e=>{try{return await $fetch(`/api/registry/package-meta/${N(e)}`,{signal:n})}catch{return null}},10)).filter(e=>e!==null).map(F);return{isStale:!1,objects:c,total:c.length,time:new Date().toISOString()}},{default:P})}var Nt={class:`container flex-1 py-8 sm:py-12 w-full`},Pt={class:`mb-8 pb-8 border-b border-border`},Ft={class:`flex flex-wrap items-end gap-4`},It={class:`size-16 shrink-0 rounded-lg bg-bg-muted border border-border flex items-center justify-center`,"aria-hidden":`true`},Lt={class:`text-2xl text-fg-subtle font-mono`},Rt={class:`font-mono text-2xl sm:text-3xl font-medium`},zt={key:0,class:`text-fg-muted text-sm mt-1`},Bt={class:`ms-auto text-end`},Vt={"aria-label":`External links`},Ht=[`href`,`title`],Ut=[`title`],Wt={class:`font-mono`},Gt={key:0,class:`mb-8`,"aria-label":`Organization management`},Kt={class:`flex items-center gap-1 mb-4`},qt={key:1,role:`alert`,class:`py-12 text-center`},Jt={class:`text-fg-muted mb-4`},Yt={key:2,class:`py-12 text-center`},Xt={class:`text-fg-muted font-mono`},Zt={class:`text-fg`},Qt={class:`text-fg-subtle text-sm mt-2`},$t=[`aria-label`],en={class:`text-xs text-fg-subtle uppercase tracking-wider mb-4`},tn={key:0,class:`text-fg-muted py-8 text-center font-mono`},nn=e({__name:`[org]`,setup(e){let{t:a}=D(),d=E(`org`),g=b(),y=f(()=>d.params.org.toLowerCase()),{isConnected:x}=ie(),{data:S,status:C,error:O}=Mt(y);h([C,O],([e,t])=>{e===`error`&&t?.statusCode===404&&te({statusCode:404,statusMessage:a(`org.page.not_found`),message:a(`org.page.not_found_message`,{name:y.value})})},{immediate:!0});let j=f(()=>S.value?.objects??[]),N=f(()=>j.value.length),{viewMode:P,paginationMode:F,pageSize:I,columns:R,toggleColumn:z,resetColumns:ae}=V(),{filters:G,sortOption:K,sortedPackages:q,availableKeywords:oe,activeFilters:se,setTextFilter:ce,setSearchScope:le,setDownloadRange:ue,setSecurity:de,setUpdatedWithin:fe,toggleKeyword:pe,clearFilter:me,clearAllFilters:he,setSort:ge}=U({packages:j,initialSort:A(d.query.sort)??`updated-desc`}),J=u(1),_e=f(()=>{if(I.value===`all`)return 1;let e=typeof I.value==`number`?I.value:25;return Math.ceil(q.value.length/e)});h([G,K],()=>{J.value=1}),h(_e,e=>{J.value>e&&e>0&&(J.value=e)});let ve=re(e=>{g.replace({query:{...d.query,q:e.filter||void 0,sort:e.sort&&e.sort!==`updated-desc`?e.sort:void 0}})},300);h([()=>G.value.text,()=>G.value.keywords,()=>K.value],([e,t,n])=>{ve({filter:[e,...t.map(e=>`keyword:${e}`)].filter(Boolean).join(` `),sort:n})});let ye=f(()=>q.value.length),be=f(()=>q.value.reduce((e,t)=>e+(t.downloads?.weekly??0),0));h(y,()=>{he(),ge(`updated-desc`),J.value=1});function xe(e){me(e)}let Y=u(`members`);return T({link:[{rel:`canonical`,href:f(()=>`https://npmx.dev/@${y.value}`)}]}),ne({title:()=>`@${y.value} - npmx`,ogTitle:()=>`@${y.value} - npmx`,twitterTitle:()=>`@${y.value} - npmx`,description:()=>`npm packages published by the ${y.value} organization`,ogDescription:()=>`npm packages published by the ${y.value} organization`,twitterDescription:()=>`npm packages published by the ${y.value} organization`}),M(`Default`,{title:()=>`@${y.value}`,description:()=>N.value?`${N.value} packages`:`npm organization`,primaryColor:`#60a5fa`}),(e,u)=>{let d=ze,f=At,h=w,g=L,b=k,te=B,ne=W,S=H;return o(),_(`main`,Nt,[v(`header`,Pt,[v(`div`,Ft,[v(`div`,It,[v(`span`,Lt,s(i(y).charAt(0).toUpperCase()),1)]),v(`div`,null,[v(`h1`,Rt,`@`+s(i(y)),1),i(C)===`success`?(o(),_(`p`,zt,s(i(a)(`org.public_packages`,{count:e.$n(i(N))},i(N))),1)):n(``,!0)]),v(`div`,Bt,[v(`nav`,Vt,[v(`a`,{href:`https://www.npmjs.com/org/${i(y)}`,target:`_blank`,rel:`noopener noreferrer`,class:`link-subtle font-mono text-sm inline-flex items-center gap-1.5`,title:i(a)(`common.view_on_npm`)},[...u[10]||=[v(`span`,{class:`i-simple-icons:npm w-4 h-4`,"aria-hidden":`true`},null,-1),r(` npm `,-1)]],8,Ht)]),v(`p`,{class:`text-fg-subtle text-xs mt-1 flex items-center gap-1.5 justify-end cursor-help`,title:i(a)(`common.vanity_downloads_hint`,{count:i(ye)},i(ye))},[u[11]||=v(`span`,{class:`i-lucide:chart-line w-3.5 h-3.5`,"aria-hidden":`true`},null,-1),v(`span`,Wt,s(e.$n(i(be)))+` `+s(i(a)(`common.per_week`)),1)],8,Ut)])])]),c(h,null,{default:ee(()=>[i(x)?(o(),_(`section`,Gt,[v(`div`,Kt,[v(`button`,{type:`button`,class:t([`px-4 py-2 font-mono text-sm rounded-t-lg transition-colors duration-200`,i(Y)===`members`?`bg-bg-subtle text-fg border border-border border-b-0`:`text-fg-muted hover:text-fg`]),onClick:u[0]||=e=>Y.value=`members`},s(i(a)(`org.page.members_tab`)),3),v(`button`,{type:`button`,class:t([`px-4 py-2 font-mono text-sm rounded-t-lg transition-colors duration-200`,i(Y)===`teams`?`bg-bg-subtle text-fg border border-border border-b-0`:`text-fg-muted hover:text-fg`]),onClick:u[1]||=e=>Y.value=`teams`},s(i(a)(`org.page.teams_tab`)),3)]),i(Y)===`members`?(o(),l(d,{key:0,"org-name":i(y)},null,8,[`org-name`])):(o(),l(f,{key:1,"org-name":i(y)},null,8,[`org-name`]))])):n(``,!0)]),_:1}),i(C)===`pending`?(o(),l(g,{key:0,text:i(a)(`common.loading_packages`)},null,8,[`text`])):i(C)===`error`?(o(),_(`div`,qt,[v(`p`,Jt,s(i(O)?.message??i(a)(`org.page.failed_to_load`)),1),c(b,{variant:`button-secondary`,to:{name:`index`}},{default:ee(()=>[r(s(i(a)(`common.go_back_home`)),1)]),_:1})])):i(N)===0?(o(),_(`div`,Yt,[v(`p`,Xt,[r(s(i(a)(`org.page.no_packages`))+` `,1),v(`span`,Zt,`@`+s(i(y)),1)]),v(`p`,Qt,s(i(a)(`org.page.no_packages_hint`)),1)])):i(j).length>0?(o(),_(`section`,{key:3,"aria-label":i(a)(`org.page.packages_title`)},[v(`h2`,en,s(i(a)(`org.page.packages_title`)),1),c(te,{filters:i(G),"sort-option":i(K),"onUpdate:sortOption":u[2]||=e=>p(K)?K.value=e:null,"view-mode":i(P),"onUpdate:viewMode":u[3]||=e=>p(P)?P.value=e:null,columns:i(R),"pagination-mode":i(F),"onUpdate:paginationMode":u[4]||=e=>p(F)?F.value=e:null,"page-size":i(I),"onUpdate:pageSize":u[5]||=e=>p(I)?I.value=e:null,"total-count":i(N),"filtered-count":i(ye),"available-keywords":i(oe),"active-filters":i(se),onToggleColumn:i(z),onResetColumns:i(ae),onClearFilter:xe,onClearAllFilters:i(he),"onUpdate:text":i(ce),"onUpdate:searchScope":i(le),"onUpdate:downloadRange":i(ue),"onUpdate:security":i(de),"onUpdate:updatedWithin":i(fe),onToggleKeyword:i(pe)},null,8,[`filters`,`sort-option`,`view-mode`,`columns`,`pagination-mode`,`page-size`,`total-count`,`filtered-count`,`available-keywords`,`active-filters`,`onToggleColumn`,`onResetColumns`,`onClearAllFilters`,`onUpdate:text`,`onUpdate:searchScope`,`onUpdate:downloadRange`,`onUpdate:security`,`onUpdate:updatedWithin`,`onToggleKeyword`]),i(q).length===0?(o(),_(`p`,tn,s(i(a)(`org.page.no_match`,{query:i(G).text})),1)):(o(),_(m,{key:1},[c(ne,{results:i(q),"view-mode":i(P),columns:i(R),filters:i(G),"sort-option":i(K),"onUpdate:sortOption":u[6]||=e=>p(K)?K.value=e:null,"pagination-mode":i(F),"page-size":i(I),"current-page":i(J),onClickKeyword:i(pe)},null,8,[`results`,`view-mode`,`columns`,`filters`,`sort-option`,`pagination-mode`,`page-size`,`current-page`,`onClickKeyword`]),c(S,{mode:i(F),"onUpdate:mode":u[7]||=e=>p(F)?F.value=e:null,"page-size":i(I),"onUpdate:pageSize":u[8]||=e=>p(I)?I.value=e:null,"current-page":i(J),"onUpdate:currentPage":u[9]||=e=>p(J)?J.value=e:null,"total-items":i(q).length,"view-mode":i(P)},null,8,[`mode`,`page-size`,`current-page`,`total-items`,`view-mode`])],64))],8,$t)):n(``,!0)])}}});export{nn as default};