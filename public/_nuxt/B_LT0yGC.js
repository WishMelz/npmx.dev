import{f as e}from"./Cr_GQgS6.js";function t(e){return{package:{name:e.name,version:e.version,description:e.description,keywords:e.keywords,license:e.license,date:e.date,links:e.links,author:e.author,maintainers:e.maintainers},score:{final:0,detail:{quality:0,popularity:0,maintenance:0}},searchScore:0,downloads:e.weeklyDownloads===void 0?void 0:{weekly:e.weeklyDownloads},updated:e.date}}function n(){return{objects:[],total:0,isStale:!1,time:new Date().toISOString()}}function r(e){return!e||e.length===0||e.length>214||!/^[a-z0-9]/i.test(e)?!1:/^[\w-]+$/.test(e)}function i(e){let t=e.trim();if(!t)return{intent:null,name:``};if(t.startsWith(`~`)){let e=t.slice(1);return r(e)?{intent:`user`,name:e}:{intent:null,name:``}}if(t.startsWith(`@`)){if(t.includes(`/`))return{intent:null,name:``};let e=t.slice(1);return r(e)?{intent:`org`,name:e}:{intent:null,name:``}}return r(t)?{intent:`both`,name:t}:{intent:null,name:``}}function a(e){let t,n=`algolia-client-js-${e.key}`;function r(){return t===void 0&&(t=e.localStorage||window.localStorage),t}function i(){return JSON.parse(r().getItem(n)||`{}`)}function a(e){r().setItem(n,JSON.stringify(e))}function o(){let t=e.timeToLive?e.timeToLive*1e3:null,n=i(),r=Object.fromEntries(Object.entries(n).filter(([,e])=>e.timestamp!==void 0));a(r),t&&a(Object.fromEntries(Object.entries(r).filter(([,e])=>{let n=new Date().getTime();return!(e.timestamp+t<n)})))}return{get(e,t,n={miss:()=>Promise.resolve()}){return Promise.resolve().then(()=>(o(),i()[JSON.stringify(e)])).then(e=>Promise.all([e?e.value:t(),e!==void 0])).then(([e,t])=>Promise.all([e,t||n.miss(e)])).then(([e])=>e)},set(e,t){return Promise.resolve().then(()=>{let a=i();return a[JSON.stringify(e)]={timestamp:new Date().getTime(),value:t},r().setItem(n,JSON.stringify(a)),t})},delete(e){return Promise.resolve().then(()=>{let t=i();delete t[JSON.stringify(e)],r().setItem(n,JSON.stringify(t))})},clear(){return Promise.resolve().then(()=>{r().removeItem(n)})}}}function o(){return{get(e,t,n={miss:()=>Promise.resolve()}){return t().then(e=>Promise.all([e,n.miss(e)])).then(([e])=>e)},set(e,t){return Promise.resolve(t)},delete(e){return Promise.resolve()},clear(){return Promise.resolve()}}}function s(e){let t=[...e.caches],n=t.shift();return n===void 0?o():{get(e,r,i={miss:()=>Promise.resolve()}){return n.get(e,r,i).catch(()=>s({caches:t}).get(e,r,i))},set(e,r){return n.set(e,r).catch(()=>s({caches:t}).set(e,r))},delete(e){return n.delete(e).catch(()=>s({caches:t}).delete(e))},clear(){return n.clear().catch(()=>s({caches:t}).clear())}}}function c(e={serializable:!0}){let t={};return{get(n,r,i={miss:()=>Promise.resolve()}){let a=JSON.stringify(n);if(a in t)return Promise.resolve(e.serializable?JSON.parse(t[a]):t[a]);let o=r();return o.then(e=>i.miss(e)).then(()=>o)},set(n,r){return t[JSON.stringify(n)]=e.serializable?JSON.stringify(r):r,Promise.resolve(r)},delete(e){return delete t[JSON.stringify(e)],Promise.resolve()},clear(){return t={},Promise.resolve()}}}function l(e){let t={value:`Algolia for JavaScript (${e})`,add(e){let n=`; ${e.segment}${e.version===void 0?``:` (${e.version})`}`;return t.value.indexOf(n)===-1&&(t.value=`${t.value}${n}`),t}};return t}function u(e,t,n=`WithinHeaders`){let r={"x-algolia-api-key":t,"x-algolia-application-id":e};return{headers(){return n===`WithinHeaders`?r:{}},queryParameters(){return n===`WithinQueryParameters`?r:{}}}}function d({algoliaAgents:e,client:t,version:n}){let r=l(n).add({segment:t,version:n});return e.forEach(e=>r.add(e)),r}function f(){return{debug(e,t){return Promise.resolve()},info(e,t){return Promise.resolve()},error(e,t){return Promise.resolve()}}}var p=120*1e3;function m(e,t=`up`){let n=Date.now();function r(){return t===`up`||Date.now()-n>p}function i(){return t===`timed out`&&Date.now()-n<=p}return{...e,status:t,lastUpdate:n,isUp:r,isTimedOut:i}}var h=class extends Error{name=`AlgoliaError`;constructor(e,t){super(e),t&&(this.name=t)}},g=class extends h{stackTrace;constructor(e,t,n){super(e,n),this.stackTrace=t}},_=class extends g{constructor(e){super(`Unreachable hosts - your application id may be incorrect. If the error persists, please visit our help center https://alg.li/support-unreachable-hosts or reach out to the Algolia Support team: https://alg.li/support`,e,`RetryError`)}},v=class extends g{status;constructor(e,t,n,r=`ApiError`){super(e,n,r),this.status=t}},y=class extends h{response;constructor(e,t){super(e,`DeserializationError`),this.response=t}},b=class extends v{error;constructor(e,t,n,r){super(e,t,r,`DetailedApiError`),this.error=n}};function x(e){let t=e;for(let n=e.length-1;n>0;n--){let r=Math.floor(Math.random()*(n+1)),i=e[n];t[n]=e[r],t[r]=i}return t}function S(e,t,n){let r=C(n),i=`${e.protocol}://${e.url}${e.port?`:${e.port}`:``}/${t.charAt(0)===`/`?t.substring(1):t}`;return r.length&&(i+=`?${r}`),i}function C(e){return Object.keys(e).filter(t=>e[t]!==void 0).sort().map(t=>`${t}=${encodeURIComponent(Object.prototype.toString.call(e[t])===`[object Array]`?e[t].join(`,`):e[t]).replace(/\+/g,`%20`)}`).join(`&`)}function w(e,t){if(e.method===`GET`||e.data===void 0&&t.data===void 0)return;let n=Array.isArray(e.data)?e.data:{...e.data,...t.data};return JSON.stringify(n)}function T(e,t,n){let r={Accept:`application/json`,...e,...t,...n},i={};return Object.keys(r).forEach(e=>{let t=r[e];i[e.toLowerCase()]=t}),i}function E(e){try{return JSON.parse(e.content)}catch(t){throw new y(t.message,e)}}function D({content:e,status:t},n){try{let r=JSON.parse(e);return`error`in r?new b(r.message,t,r.error,n):new v(r.message,t,n)}catch{}return new v(e,t,n)}function O({isTimedOut:e,status:t}){return!e&&~~t===0}function k({isTimedOut:e,status:t}){return e||O({isTimedOut:e,status:t})||~~(t/100)!=2&&~~(t/100)!=4}function A({status:e}){return~~(e/100)==2}function j(e){return e.map(e=>M(e))}function M(e){let t=e.request.headers[`x-algolia-api-key`]?{"x-algolia-api-key":`*****`}:{};return{...e,request:{...e.request,headers:{...e.request.headers,...t}}}}function N({hosts:e,hostsCache:t,baseHeaders:n,logger:r,baseQueryParameters:i,algoliaAgent:a,timeouts:o,requester:s,requestsCache:c,responsesCache:l}){async function u(e){let n=await Promise.all(e.map(e=>t.get(e,()=>Promise.resolve(m(e))))),r=n.filter(e=>e.isUp()),i=n.filter(e=>e.isTimedOut()),a=[...r,...i];return{hosts:a.length>0?a:e,getTimeout(e,t){return(i.length===0&&e===0?1:i.length+3+e)*t}}}async function d(c,l,d){let f=[],p=w(c,l),h=T(n,c.headers,l.headers),g=c.method===`GET`?{...c.data,...l.data}:{},v={...i,...c.queryParameters,...g};if(a.value&&(v[`x-algolia-agent`]=a.value),l&&l.queryParameters)for(let e of Object.keys(l.queryParameters))!l.queryParameters[e]||Object.prototype.toString.call(l.queryParameters[e])===`[object Object]`?v[e]=l.queryParameters[e]:v[e]=l.queryParameters[e].toString();let y=0,b=async(e,n)=>{let i=e.pop();if(i===void 0)throw new _(j(f));let a={...o,...l.timeouts},u={data:p,headers:h,method:c.method,url:S(i,c.path,v),connectTimeout:n(y,a.connect),responseTimeout:n(y,d?a.read:a.write)},g=t=>{let n={request:u,response:t,host:i,triesLeft:e.length};return f.push(n),n},x=await s.send(u);if(k(x)){let a=g(x);return x.isTimedOut&&y++,r.info(`Retryable failure`,M(a)),await t.set(i,m(i,x.isTimedOut?`timed out`:`down`)),b(e,n)}if(A(x))return E(x);throw g(x),D(x,f)},x=await u(e.filter(e=>e.accept===`readWrite`||(d?e.accept===`read`:e.accept===`write`)));return b([...x.hosts].reverse(),x.getTimeout)}function f(e,t={}){let r=()=>d(e,t,a),a=e.useReadTransporter||e.method===`GET`;if((t.cacheable||e.cacheable)!==!0)return r();let o={request:e,requestOptions:t,transporter:{queryParameters:i,headers:n}};return l.get(o,()=>c.get(o,()=>c.set(o,r()).then(e=>Promise.all([c.delete(o),e]),e=>Promise.all([c.delete(o),Promise.reject(e)])).then(([e,t])=>t)),{miss:e=>l.set(o,e)})}return{hostsCache:t,requester:s,timeouts:o,logger:r,algoliaAgent:a,baseHeaders:n,baseQueryParameters:i,hosts:e,request:f,requestsCache:c,responsesCache:l}}function P(){function e(e){return new Promise(t=>{let n=new XMLHttpRequest;n.open(e.method,e.url,!0),Object.keys(e.headers).forEach(t=>n.setRequestHeader(t,e.headers[t]));let r=(e,r)=>setTimeout(()=>{n.abort(),t({status:0,content:r,isTimedOut:!0})},e),i=r(e.connectTimeout,`Connection timeout`),a;n.onreadystatechange=()=>{n.readyState>n.OPENED&&a===void 0&&(clearTimeout(i),a=r(e.responseTimeout,`Socket timeout`))},n.onerror=()=>{n.status===0&&(clearTimeout(i),clearTimeout(a),t({content:n.responseText||`Network request failed`,status:n.status,isTimedOut:!1}))},n.onload=()=>{clearTimeout(i),clearTimeout(a),t({content:n.responseText,status:n.status,isTimedOut:!1})},n.send(e.data)})}return{send:e}}var F=`5.49.0`;function I(e){return[{url:`${e}-dsn.algolia.net`,accept:`read`,protocol:`https`},{url:`${e}.algolia.net`,accept:`write`,protocol:`https`}].concat(x([{url:`${e}-1.algolianet.com`,accept:`readWrite`,protocol:`https`},{url:`${e}-2.algolianet.com`,accept:`readWrite`,protocol:`https`},{url:`${e}-3.algolianet.com`,accept:`readWrite`,protocol:`https`}]))}function L({appId:e,apiKey:t,authMode:n,algoliaAgents:r,...i}){let a=u(e,t,n),o=N({hosts:I(e),...i,algoliaAgent:d({algoliaAgents:r,client:`Lite`,version:F}),baseHeaders:{"content-type":`text/plain`,...a.headers(),...i.baseHeaders},baseQueryParameters:{...a.queryParameters(),...i.baseQueryParameters}});return{transporter:o,appId:e,apiKey:t,clearCache(){return Promise.all([o.requestsCache.clear(),o.responsesCache.clear()]).then(()=>void 0)},get _ua(){return o.algoliaAgent.value},addAlgoliaAgent(e,t){o.algoliaAgent.add({segment:e,version:t})},setClientApiKey({apiKey:e}){!n||n===`WithinHeaders`?o.baseHeaders[`x-algolia-api-key`]=e:o.baseQueryParameters[`x-algolia-api-key`]=e},searchForHits(e,t){return this.search(e,t)},searchForFacets(e,t){return this.search(e,t)},customPost({path:e,parameters:t,body:n},r){if(!e)throw Error("Parameter `path` is required when calling `customPost`.");let i={method:`POST`,path:`/{path}`.replace(`{path}`,e),queryParameters:t||{},headers:{},data:n||{}};return o.request(i,r)},getRecommendations(e,t){if(e&&Array.isArray(e)&&(e={requests:e}),!e)throw Error("Parameter `getRecommendationsParams` is required when calling `getRecommendations`.");if(!e.requests)throw Error("Parameter `getRecommendationsParams.requests` is required when calling `getRecommendations`.");let n={method:`POST`,path:`/1/indexes/*/recommendations`,queryParameters:{},headers:{},data:e,useReadTransporter:!0,cacheable:!0};return o.request(n,t)},search(e,t){if(e&&Array.isArray(e)&&(e={requests:e.map(({params:e,...t})=>t.type===`facet`?{...t,...e,type:`facet`}:{...t,...e,facet:void 0,maxFacetHits:void 0,facetQuery:void 0})}),!e)throw Error("Parameter `searchMethodParams` is required when calling `search`.");if(!e.requests)throw Error("Parameter `searchMethodParams.requests` is required when calling `search`.");let n={method:`POST`,path:`/1/indexes/*/queries`,queryParameters:{},headers:{},data:e,useReadTransporter:!0,cacheable:!0};return o.request(n,t)}}}function R(e,t,n){if(!e||typeof e!=`string`)throw Error("`appId` is missing.");if(!t||typeof t!=`string`)throw Error("`apiKey` is missing.");return L({appId:e,apiKey:t,timeouts:{connect:1e3,read:2e3,write:3e4},logger:f(),requester:P(),algoliaAgents:[{segment:`Browser`}],authMode:`WithinQueryParameters`,responsesCache:c(),requestsCache:c({serializable:!1}),hostsCache:s({caches:[a({key:`${F}-${e}`}),c()]}),...n})}var z=null,B=null;function V(e,t){return(!z||B!==e)&&(z=R(e,t),B=e),z}var H=[`name`,`version`,`description`,`modified`,`homepage`,`repository`,`owners`,`downloadsLast30Days`,`downloadsRatio`,`popular`,`keywords`,`deprecated`,`isDeprecated`,`license`],U=[`name`];function W(e){return{package:{name:e.name,version:e.version,description:e.description||``,keywords:e.keywords,date:new Date(e.modified).toISOString(),links:{npm:`https://www.npmjs.com/package/${e.name}`,homepage:e.homepage||void 0,repository:e.repository?.url||void 0},maintainers:e.owners?e.owners.map(e=>({name:e.name,email:e.email})):[]},score:{final:0,detail:{quality:e.popular?1:0,popularity:e.downloadsRatio,maintenance:0}},searchScore:0,downloads:{weekly:Math.round(e.downloadsLast30Days/4.3)},updated:new Date(e.modified).toISOString()}}function G(){let{algolia:t}=e().public,n=V(t.appId,t.apiKey),r=t.indexName;async function i(e,t={}){let{results:i}=await n.search({requests:[{indexName:r,query:e,offset:t.from,length:t.size,filters:t.filters||``,analyticsTags:[`npmx.dev`],attributesToRetrieve:H,attributesToHighlight:[]}]}),a=i[0];if(!a)throw Error(`Algolia returned an empty response`);return{isStale:!1,objects:a.hits.map(W),total:a.nbHits??0,time:new Date().toISOString()}}async function a(e,t={}){let i=t.maxResults??1e3,a=[],o=0,s=0;for(;o<i;){let t=s>0?Math.min(i,s)-o:i-o;if(t<=0)break;let c=Math.min(200,t),{results:l}=await n.search({requests:[{indexName:r,query:``,offset:o,length:c,filters:`owner.name:${e}`,analyticsTags:[`npmx.dev`],attributesToRetrieve:H,attributesToHighlight:[]}]}),u=l[0];if(!u||(s=u.nbHits??0,a.push(...u.hits),u.hits.length<c||a.length>=s))break;o+=c}return{isStale:!1,objects:a.map(W),total:s,time:new Date().toISOString()}}async function o(e){if(e.length===0)return{isStale:!1,objects:[],total:0,time:new Date().toISOString()};let n=(await $fetch(`https://${t.appId}-dsn.algolia.net/1/indexes/*/objects`,{method:`POST`,headers:{"x-algolia-api-key":t.apiKey,"x-algolia-application-id":t.appId},body:{requests:e.map(e=>({indexName:r,objectID:e,attributesToRetrieve:H}))}})).results.filter(e=>e!==null&&`name`in e);return{isStale:!1,objects:n.map(W),total:n.length,time:new Date().toISOString()}}async function s(e,t={},i){let a=[{indexName:r,query:e,offset:t.from,length:t.size,filters:t.filters||``,analyticsTags:[`npmx.dev`],attributesToRetrieve:H,attributesToHighlight:[]}],o=i?.checkOrg&&i.name?a.length:-1;i?.checkOrg&&i.name&&a.push({indexName:r,query:`"@${i.name}"`,length:1,analyticsTags:[`npmx.dev`],attributesToRetrieve:U,attributesToHighlight:[]});let s=i?.checkUser&&i.name?a.length:-1;i?.checkUser&&i.name&&a.push({indexName:r,query:``,filters:`owner.name:${i.name}`,length:1,analyticsTags:[`npmx.dev`],attributesToRetrieve:U,attributesToHighlight:[]});let c=i?.checkPackage?a.length:-1;i?.checkPackage&&a.push({indexName:r,query:``,filters:`objectID:${i.checkPackage}`,length:1,analyticsTags:[`npmx.dev`],attributesToRetrieve:U,attributesToHighlight:[]});let{results:l}=await n.search({requests:a}),u=l[0];if(!u)throw Error(`Algolia returned an empty response`);let d={isStale:!1,objects:u.hits.map(W),total:u.nbHits??0,time:new Date().toISOString()},f=!1;if(o>=0&&i?.name){let e=l[o],t=`@${i.name.toLowerCase()}/`;f=e?.hits?.some(e=>e.name?.toLowerCase().startsWith(t))??!1}let p=!1;s>=0&&(p=(l[s]?.nbHits??0)>0);let m=null;return c>=0&&(m=(l[c]?.nbHits??0)>0),{search:d,orgExists:f,userExists:p,packageExists:m}}return{search:i,searchWithSuggestions:s,searchByOwner:a,getPackagesByName:o}}export{i,n,t as r,G as t};