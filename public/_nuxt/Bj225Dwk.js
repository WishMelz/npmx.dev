import{A as e,At as t,C as n,D as r,Dt as i,G as a,H as o,J as s,Nt as c,O as l,S as u,St as d,Z as f,at as p,b as m,d as h,ht as g,lt as _,m as v,n as y,ot as b,ut as ee,w as x,x as S,yt as te}from"./BLt7TXlb.js";import{B as C,R as ne,b as w,d as T,f as E,s as D,t as O,z as k}from"./CreLCcZP.js";import"./ByNgdIzL.js";import"./Cr_GQgS6.js";import"./B2KNUzwv.js";import"./BFu3gPrq.js";import{n as re}from"./DZubR30v.js";import{a as A,o as ie}from"./mPlC9-cP.js";import{n as ae,t as oe,u as j}from"./-B2-_an5.js";import{n as M}from"./DkotcqDl.js";import{t as N}from"./Cend_Z8Q.js";import"./CdWQmgpE.js";import{t as P}from"./Bi22IuVY.js";import"./JOw9R0Rj.js";import{a as F,c as I,f as se,p as L,u as ce}from"./Brdikwlz.js";import{t as R}from"./Cf-Ej6y2.js";import"./Z_xnzAqw.js";import"./DQw8S1UI.js";import"./B_LT0yGC.js";import{n as z,r as le,t as ue}from"./QmH1X8kf.js";import{t as de}from"./HQH6yG0Z.js";import"./CAwcA5eI.js";import{i as fe,n as pe,r as me,t as he}from"./DTGHBlvF.js";import{c as ge,m as _e,n as B,t as ve}from"./Dg50IizM.js";import"./BDOMo5uf.js";var ye=[`aria-label`],be={class:`bg-bg-subtle/80 backdrop-blur-sm border border-border-subtle rounded-lg shadow-lg shadow-bg-elevated/50 overflow-hidden p-1`},V={class:`min-w-0 flex-1`},H={class:`text-xs text-fg-subtle mt-0.5`},xe={class:`min-w-0 flex-1`},Se={class:`text-xs text-fg-subtle mt-0.5`},Ce={key:0,class:`border-t border-border mx-1 mt-1 pt-2 pb-1`},U={href:`https://www.algolia.com/developers`,target:`_blank`,rel:`noopener noreferrer`,class:`text-xs text-fg-subtle hover:text-fg-muted transition-colors inline-flex items-center gap-1 px-2`},we=e({__name:`SearchProviderToggle.client`,setup(e){let a=k(),o=C(),{searchProvider:u}=A(),f=m(()=>M(a.query.p)===`npm`||u.value===`npm`?`npm`:`algolia`),h=d(!1),g=p(`toggleRef`);return oe(g,()=>{h.value=!1}),j(`keydown`,e=>{e.key===`Escape`&&h.value&&(h.value=!1)}),(e,d)=>{let p=N;return s(),x(`div`,{ref_key:`toggleRef`,ref:g,class:`relative`},[l(p,{"aria-label":e.$t(`settings.data_source.label`),"aria-expanded":i(h),"aria-haspopup":`true`,size:`small`,class:`border-none w-8 h-8 !px-0 justify-center`,classicon:`i-lucide:settings`,onClick:d[0]||=e=>h.value=!i(h)},null,8,[`aria-label`,`aria-expanded`]),l(y,{"enter-active-class":`transition-all duration-150`,"leave-active-class":`transition-all duration-100`,"enter-from-class":`opacity-0 translate-y-1`,"leave-to-class":`opacity-0 translate-y-1`},{default:_(()=>[i(h)?(s(),x(`div`,{key:0,class:`absolute inset-ie-0 top-full pt-2 w-72 z-50`,role:`menu`,"aria-label":e.$t(`settings.data_source.label`)},[S(`div`,be,[S(`button`,{type:`button`,role:`menuitem`,class:t([`w-full flex items-start gap-3 px-3 py-2.5 rounded-md text-start transition-colors hover:bg-bg-muted`,[i(f)===`algolia`?``:`bg-bg-muted`]]),onClick:d[1]||=()=>{u.value=`npm`,i(o).push({query:{...i(a).query,p:`npm`}}),h.value=!1}},[S(`span`,{class:t([`i-simple-icons:npm w-4 h-4 mt-0.5 shrink-0`,i(f)===`algolia`?`text-fg-muted`:`text-accent`]),"aria-hidden":`true`},null,2),S(`div`,V,[S(`div`,{class:t([`text-sm font-medium`,i(f)===`algolia`?`text-fg-muted`:`text-fg`])},c(e.$t(`settings.data_source.npm`)),3),S(`p`,H,c(e.$t(`settings.data_source.npm_description`)),1)])],2),S(`button`,{type:`button`,role:`menuitem`,class:t([`w-full flex items-start gap-3 px-3 py-2.5 rounded-md text-start transition-colors hover:bg-bg-muted mt-1`,[i(f)===`algolia`?`bg-bg-muted`:``]]),onClick:d[2]||=()=>{u.value=`algolia`,i(o).push({query:{...i(a).query,p:void 0}}),h.value=!1}},[S(`span`,{class:t([`i-simple-icons:algolia w-4 h-4 mt-0.5 shrink-0`,i(f)===`algolia`?`text-accent`:`text-fg-muted`]),"aria-hidden":`true`},null,2),S(`div`,xe,[S(`div`,{class:t([`text-sm font-medium`,i(f)===`algolia`?`text-fg`:`text-fg-muted`])},c(e.$t(`settings.data_source.algolia`)),3),S(`p`,Se,c(e.$t(`settings.data_source.algolia_description`)),1)])],2),i(f)===`algolia`?(s(),x(`div`,Ce,[S(`a`,U,[r(c(e.$t(`search.algolia_disclaimer`))+` `,1),d[3]||=S(`span`,{class:`i-lucide:external-link w-3 h-3`,"aria-hidden":`true`},null,-1)])])):n(``,!0)])],8,ye)):n(``,!0)]),_:1})],512)}}}),Te=Object.assign(we,{__name:`SearchProviderToggle`}),Ee={class:`text-lg text-fg-subtle font-mono`},De={class:`min-w-0 flex-1`},Oe={class:`flex items-center gap-2`},ke={class:`font-mono text-sm sm:text-base font-medium text-fg group-hover:text-fg transition-colors`,dir:`ltr`},Ae={class:`text-xs px-1.5 py-0.5 rounded bg-bg-muted border border-border text-fg-muted font-mono`},je={key:0,class:`text-xs px-1.5 py-0.5 rounded bg-accent/20 border border-accent/30 text-accent font-mono`},Me={class:`text-xs sm:text-sm text-fg-muted mt-0.5`},Ne=e({__name:`SearchSuggestionCard`,props:{type:{},name:{},isExactMatch:{type:Boolean},index:{}},setup(e){return(r,i)=>{let a=O,o=B;return s(),u(o,{isExactMatch:e.isExactMatch},{default:_(()=>[l(a,{to:e.type===`user`?{name:`~username`,params:{username:e.name.toLowerCase()}}:{name:`org`,params:{org:e.name.toLowerCase()}},"data-suggestion-index":e.index,class:`flex items-center gap-4 focus-visible:outline-none after:content-[''] after:absolute after:inset-0`},{default:_(()=>[S(`div`,{class:t([`w-10 h-10 shrink-0 flex items-center justify-center border border-border`,e.type===`org`?`rounded-lg bg-bg-muted`:`rounded-full bg-bg-muted`]),"aria-hidden":`true`},[S(`span`,Ee,c(e.name.charAt(0).toUpperCase()),1)],2),S(`div`,De,[S(`div`,Oe,[S(`span`,ke,c(e.type===`user`?`~`:`@`)+c(e.name),1),S(`span`,Ae,c(e.type===`user`?r.$t(`search.suggestion.user`):r.$t(`search.suggestion.org`)),1),e.isExactMatch?(s(),x(`span`,je,c(r.$t(`search.exact_match`)),1)):n(``,!0)]),S(`p`,Me,c(e.type===`user`?r.$t(`search.suggestion.view_user_packages`):r.$t(`search.suggestion.view_org_packages`)),1)]),i[0]||=S(`span`,{class:`i-lucide:arrow-right rtl-flip w-4 h-4 text-fg-subtle group-hover:text-fg transition-colors shrink-0`,"aria-hidden":`true`},null,-1)]),_:1},8,[`to`,`data-suggestion-index`])]),_:1},8,[`isExactMatch`])}}}),Pe=Object.assign(Ne,{__name:`SearchSuggestionCard`}),W=T(I),Fe={key:0,class:`py-8 text-center`},Ie={key:1,class:`space-y-4`},Le={class:`flex items-center gap-3 p-4 bg-green-500/10 border border-green-500/20 rounded-lg`},G={class:`font-mono text-sm text-fg`},Re={class:`text-xs text-fg-muted`},ze={class:`text-sm text-fg-muted`},Be={class:`flex gap-3`},K={key:2,class:`space-y-4`},q={class:`p-4 bg-bg-subtle border border-border rounded-lg`},Ve={class:`font-mono text-lg text-fg`},J={key:0,class:`p-3 text-sm text-red-400 bg-red-500/10 border border-red-500/20 rounded-md`,role:`alert`},He={class:`font-medium mb-1`},Y={class:`list-disc list-inside space-y-1`},Ue={key:1,class:`p-3 text-sm text-yellow-400 bg-yellow-500/10 border border-yellow-500/20 rounded-md`,role:`alert`},We={class:`font-medium mb-1`},Ge={class:`list-disc list-inside space-y-1`},Ke={key:0,class:`flex items-center gap-3 p-4 bg-red-500/10 border border-red-500/20 rounded-lg`},qe={class:`font-mono text-sm text-fg`},X={key:1,class:`flex items-center gap-3 p-4 bg-green-500/10 border border-green-500/20 rounded-lg`},Je={class:`font-mono text-sm text-fg`},Ye={key:2,class:`flex items-center gap-3 p-4 bg-red-500/10 border border-red-500/20 rounded-lg`},Xe={class:`font-mono text-sm text-fg`},Z={key:0},Ze={key:1},Qe={class:`space-y-2`},$e={key:0,class:`i-lucide:circle-alert text-red-500 w-4 h-4 mt-0.5 shrink-0`,"aria-hidden":`true`},et={key:1,class:`i-lucide:circle-alert text-yellow-500 w-4 h-4 mt-0.5 shrink-0`,"aria-hidden":`true`},tt={key:2,class:`w-4 h-4 shrink-0`},Q={class:`min-w-0`},nt={key:0,class:`text-xs text-fg-subtle truncate`},rt={key:4,role:`alert`,class:`p-3 text-sm text-red-400 bg-red-500/10 border border-red-500/20 rounded-md`},it={key:5,class:`space-y-3`},at={key:0,class:`p-3 text-sm text-yellow-400 bg-yellow-500/10 border border-yellow-500/20 rounded-md`},ot={class:`font-medium mb-1`},$={class:`text-xs text-yellow-400/80`},st={key:1,class:`space-y-3`},ct={class:`p-3 text-sm text-yellow-400 bg-yellow-500/10 border border-yellow-500/20 rounded-md`},lt={key:2,class:`space-y-3`},ut={class:`text-sm text-fg-muted`},dt={class:`border border-border rounded-md overflow-hidden`},ft={class:`px-3 py-2 text-sm text-fg-muted bg-bg-subtle hover:text-fg transition-colors select-none`},pt={class:`p-3 text-xs font-mono text-fg-muted bg-bg-muted overflow-x-auto`},mt=[`disabled`],ht={key:3,class:`space-y-4`},gt={role:`alert`,class:`p-3 text-sm text-red-400 bg-red-500/10 border border-red-500/20 rounded-md`},_t=e({__name:`ClaimPackageModal`,props:{packageName:{},packageScope:{},canPublishToScope:{type:Boolean}},setup(e,{expose:a}){let{t:o}=re(),h=e,{isConnected:g,state:y,npmUser:b,addOperation:ee,approveOperation:te,executeOperations:C,refreshState:ne}=ce(),w=d(!1),T=d(!1),E=d(null),{data:k,refresh:A,status:ie,error:ae}=D((e,{signal:t})=>z(h.packageName,{signal:t}),{default:()=>null,immediate:!1},`$Z_MEDrod7m`),oe=m(()=>ie.value===`pending`),j=m(()=>k.value===null?E.value??(ae.value instanceof Error?ae.value.message:o(`claim.modal.failed_to_check`)):null),M=F(`connector-modal`);async function N(){if(!(!k.value?.available||!g.value)){w.value=!0,E.value=null;try{let e=await ee({type:`package:init`,params:{name:h.packageName,...b.value&&{author:b.value}},description:`Initialize package ${h.packageName}`,command:`npm publish (${h.packageName}@0.0.0)`});if(!e)throw Error(`Failed to create operation`);await te(e.id),await C(),await ne();let t=y.value.operations.find(t=>t.id===e.id);t?.status===`completed`?T.value=!0:t?.status===`failed`?t.result?.requiresOtp?(L(),M.open()):E.value=t.result?.stderr||`Failed to publish package`:(L(),M.open())}catch(e){E.value=e instanceof Error?e.message:o(`claim.modal.failed_to_claim`)}finally{w.value=!1}}}let P=p(`dialogRef`);function I(){E.value=null,T.value=!1,A(),P.value?.showModal()}function L(){P.value?.close()}a({open:I,close:L});let R=m(()=>k.value?.similarPackages?k.value.similarPackages.some(e=>e.similarity===`exact-match`||e.similarity===`very-similar`):!1),le=m(()=>h.packageName.startsWith(`@`)),ue=m(()=>{let e=le.value?`public`:void 0;return{name:h.packageName,version:`0.0.0`,description:`Placeholder for ${h.packageName}`,main:`index.js`,scripts:{},keywords:[],author:b.value?`${b.value} (https://www.npmjs.com/~${b.value})`:``,license:`UNLICENSED`,private:!1,...e&&{publishConfig:{access:e}}}});return(a,d)=>{let p=de,m=O,h=W;return s(),u(h,{ref_key:`dialogRef`,ref:P,modalTitle:i(o)(`claim.modal.title`),id:`claim-package-modal`,class:`max-w-md`},{default:_(()=>[i(oe)?(s(),x(`div`,Fe,[l(p,{text:i(o)(`claim.modal.checking`)},null,8,[`text`])])):i(T)?(s(),x(`div`,Ie,[S(`div`,Le,[d[2]||=S(`span`,{class:`i-lucide:check text-green-500 w-6 h-6`,"aria-hidden":`true`},null,-1),S(`div`,null,[S(`p`,G,c(i(o)(`claim.modal.success`)),1),S(`p`,Re,c(i(o)(`claim.modal.success_detail`,{name:e.packageName})),1)])]),S(`p`,ze,c(i(o)(`claim.modal.success_hint`)),1),S(`div`,Be,[l(m,{to:(`packageRoute`in a?a.packageRoute:i(se))(e.packageName),class:`flex-1 px-4 py-2 font-mono text-sm text-center text-bg bg-fg rounded-md transition-colors duration-200 hover:bg-fg/90 focus-visible:outline-accent/70`,onClick:L},{default:_(()=>[r(c(i(o)(`claim.modal.view_package`)),1)]),_:1},8,[`to`]),S(`button`,{type:`button`,class:`flex-1 px-4 py-2 font-mono text-sm text-fg-muted bg-bg-subtle border border-border rounded-md transition-colors duration-200 hover:text-fg hover:border-border-hover focus-visible:outline-accent/70`,onClick:L},c(i(o)(`common.close`)),1)])])):i(k)?(s(),x(`div`,K,[S(`div`,q,[S(`p`,Ve,c(i(k).name),1)]),i(k).validationErrors?.length?(s(),x(`div`,J,[S(`p`,He,c(i(o)(`claim.modal.invalid_name`)),1),S(`ul`,Y,[(s(!0),x(v,null,f(i(k).validationErrors,e=>(s(),x(`li`,{key:e},c(e),1))),128))])])):n(``,!0),i(k).validationWarnings?.length?(s(),x(`div`,Ue,[S(`p`,We,c(i(o)(`common.warnings`)),1),S(`ul`,Ge,[(s(!0),x(v,null,f(i(k).validationWarnings,e=>(s(),x(`li`,{key:e},c(e),1))),128))])])):n(``,!0),i(k).valid?(s(),x(v,{key:2},[i(g)&&!e.canPublishToScope?(s(),x(`div`,Ke,[d[3]||=S(`span`,{class:`i-lucide:x text-red-500 w-5 h-5`,"aria-hidden":`true`},null,-1),S(`p`,qe,c(i(o)(`claim.modal.missing_permission`,{scope:e.packageScope})),1)])):i(k).available?(s(),x(`div`,X,[d[4]||=S(`span`,{class:`i-lucide:check text-green-500 w-5 h-5`,"aria-hidden":`true`},null,-1),S(`p`,Je,c(i(o)(`claim.modal.available`)),1)])):(s(),x(`div`,Ye,[d[5]||=S(`span`,{class:`i-lucide:x text-red-500 w-5 h-5`,"aria-hidden":`true`},null,-1),S(`p`,Xe,c(i(o)(`claim.modal.taken`)),1)]))],64)):n(``,!0),i(k).similarPackages?.length&&i(k).available?(s(),x(`div`,{key:3,class:t([i(R)?`bg-yellow-500/10 border-yellow-500/20`:`bg-bg-subtle border-border`,`p-4 border rounded-lg`])},[S(`p`,{class:t([i(R)?`text-yellow-400`:`text-fg-muted`,`text-sm font-medium mb-3`])},[i(R)?(s(),x(`span`,Z,c(i(o)(`claim.modal.similar_warning`)),1)):(s(),x(`span`,Ze,c(i(o)(`claim.modal.related`)),1))],2),S(`ul`,Qe,[(s(!0),x(v,null,f(i(k).similarPackages.slice(0,5),e=>(s(),x(`li`,{key:e.name,class:`flex items-start gap-2`},[e.similarity===`exact-match`?(s(),x(`span`,$e)):e.similarity===`very-similar`?(s(),x(`span`,et)):(s(),x(`span`,tt)),S(`div`,Q,[l(m,{to:(`packageRoute`in a?a.packageRoute:i(se))(e.name),class:`font-mono text-sm text-fg hover:underline focus-visible:outline-accent/70 rounded`,target:`_blank`},{default:_(()=>[r(c(e.name),1)]),_:2},1032,[`to`]),e.description?(s(),x(`p`,nt,c(e.description),1)):n(``,!0)])]))),128))])],2)):n(``,!0),i(j)?(s(),x(`div`,rt,c(i(j)),1)):n(``,!0),i(k).available&&i(k).valid?(s(),x(`div`,it,[i(le)?n(``,!0):(s(),x(`div`,at,[S(`p`,ot,c(i(o)(`claim.modal.scope_warning_title`)),1),S(`p`,$,c(i(o)(`claim.modal.scope_warning_text`,{username:i(b)||`username`,name:e.packageName})),1)])),i(g)?i(g)&&e.canPublishToScope?(s(),x(`div`,lt,[S(`p`,ut,c(i(o)(`claim.modal.publish_hint`)),1),S(`details`,dt,[S(`summary`,ft,c(i(o)(`claim.modal.preview_json`)),1),S(`pre`,pt,c(JSON.stringify(i(ue),null,2)),1)]),S(`button`,{type:`button`,disabled:i(w),class:`w-full px-4 py-2 font-mono text-sm text-bg bg-fg rounded-md transition-colors duration-200 hover:bg-fg/90 disabled:opacity-50 disabled:cursor-not-allowed focus-visible:outline-accent/70`,onClick:N},c(i(w)?i(o)(`claim.modal.publishing`):i(o)(`claim.modal.claim_button`)),9,mt)])):n(``,!0):(s(),x(`div`,st,[S(`div`,ct,[S(`p`,null,c(i(o)(`claim.modal.connect_required`)),1)]),S(`button`,{type:`button`,class:`w-full px-4 py-2 font-mono text-sm text-bg bg-fg rounded-md transition-colors duration-200 hover:bg-fg/90 focus-visible:outline-accent/70`,onClick:d[0]||=(...e)=>i(M).open&&i(M).open(...e)},c(i(o)(`claim.modal.connect_button`)),1)]))])):n(``,!0),!i(k).available||!i(k).valid?(s(),x(`button`,{key:6,type:`button`,class:`w-full px-4 py-2 font-mono text-sm text-fg-muted bg-bg-subtle border border-border rounded-md transition-colors duration-200 hover:text-fg hover:border-border-hover focus-visible:outline-accent/70`,onClick:L},c(i(o)(`common.close`)),1)):n(``,!0)])):i(j)?(s(),x(`div`,ht,[S(`div`,gt,c(i(j)),1),S(`button`,{type:`button`,class:`w-full px-4 py-2 font-mono text-sm text-fg-muted bg-bg-subtle border border-border rounded-md transition-colors duration-200 hover:text-fg hover:border-border-hover focus-visible:outline-accent/70`,onClick:d[1]||=()=>i(A)()},c(i(o)(`common.retry`)),1)])):n(``,!0)]),_:1},8,[`modalTitle`])}}}),vt=Object.assign(_t,{__name:`PackageClaimPackageModal`}),yt=new Set([`win32`,`darwin`,`linux`,`android`,`freebsd`,`openbsd`,`netbsd`,`sunos`,`aix`]),bt=new Set([`x64`,`arm64`,`arm`,`ia32`,`ppc64`,`ppc64le`,`s390x`,`riscv64`,`mips64el`,`loong64`]),xt=new Set([`gnu`,`musl`,`msvc`,`gnueabihf`]);function St(e){let t=e.startsWith(`@`)?e.split(`/`)[1]??``:e;if(!t)return!1;let n=t.split(`-`);if(n.length<2)return!1;for(let e=0;e<n.length-1;e++){let t=n[e],r=n[e+1];if(t&&r&&yt.has(t)&&bt.has(r)){let t=n[e+2];if(t&&!xt.has(t)&&e+2===n.length-1)continue;return!0}}return!1}var Ct=T(Te),wt={class:`container-sm`},Tt={class:`flex items-center justify-between gap-4 mb-4`},Et={class:`font-mono text-2xl sm:text-3xl font-medium`},Dt={key:0,class:`results-layout`},Ot={key:0,class:`mb-6 space-y-3`},kt={key:1,class:`mb-6 p-4 bg-bg-subtle border border-border rounded-lg sm:flex hidden flex-row sm:items-center gap-3 sm:gap-4`},At={class:`flex-1 min-w-0`},jt={class:`font-mono text-sm text-fg`},Mt={class:`text-xs text-fg-muted mt-0.5`},Nt={key:2,role:`status`,class:`py-12`},Pt={class:`text-fg-muted font-mono mb-6 text-center`},Ft={key:3,class:`mb-6`},It={key:0,role:`status`,class:`text-fg-muted text-sm mt-4 font-mono`},Lt={key:2,class:`text-fg-subtle`},Rt={key:1,role:`status`,class:`text-fg-muted text-sm mt-4 font-mono`},zt={key:4,role:`status`,class:`py-12`},Bt={class:`text-fg-muted font-mono mb-6 text-center`},Vt={key:0,class:`max-w-md mx-auto mb-6 space-y-3`},Ht={key:1,class:`max-w-md mx-auto text-center hidden sm:block`},Ut={class:`p-4 bg-bg-subtle border border-border rounded-lg`},Wt={class:`text-sm text-fg-muted mb-3`},Gt={key:1,class:`py-20 text-center`},Kt={class:`text-fg-subtle font-mono text-sm`},qt=25,Jt=P(e({__name:`search`,setup(e){let{t:_}=re(),y=k(),{viewMode:C,paginationMode:T,pageSize:D,columns:O,toggleColumn:A,resetColumns:oe}=pe(),j=E(e=>{let t=new URL(window.location.href);e>1?t.searchParams.set(`page`,e.toString()):t.searchParams.delete(`page`),window.history.replaceState(window.history.state,``,t)},500),{model:N,provider:P}=L(),F=m(()=>N.value),I=d(!1);a(()=>{setTimeout(()=>{I.value=!0},300)});let z=d(1),B=m(()=>{let e=Number.parseInt(M(y.query.page),10);return Number.isNaN(e)?1:Math.max(1,e)});a(()=>{B.value>1&&(z.value=B.value)});let ye=m(()=>Le.value),{settings:be}=ie(),V=m(()=>{let e=ye.value;if(!e)return e;let t=e.objects;be.value.hidePlatformPackages&&(t=t.filter(e=>!St(e.package.name)));let n=F.value.trim().toLowerCase();if(!n)return t===e.objects?e:{...e,objects:t};let r=t.findIndex(e=>e.package.name.toLowerCase()===n);if(r<=0)return t===e.objects?e:{...e,objects:t};let i=[...t],[a]=i.splice(r,1);return a&&i.unshift(a),{...e,objects:i}}),H=m(()=>V.value?.objects??[]),xe=[`downloads-week`,`downloads-day`,`downloads-month`,`downloads-year`,`updated`,`name`,`quality`,`popularity`,`maintenance`,`score`],Se=m(()=>{let e=ge[P.value];return xe.filter(t=>!e.has(t))}),{filters:Ce,sortOption:U,availableKeywords:we,activeFilters:Te,setTextFilter:Ee,setSearchScope:De,setDownloadRange:Oe,setSecurity:ke,setUpdatedWithin:Ae,toggleKeyword:je,clearFilter:Me,clearAllFilters:Ne}=he({packages:H,initialSort:`relevance-desc`,searchQueryModel:N}),W=m(()=>U.value===`relevance-desc`||U.value===`relevance-asc`),Fe={algolia:500,npm:500},Ie=m(()=>{let e=D.value===`all`?250:D.value,t=Math.max(qt,z.value*e);if(!W.value){let e=Fe[P.value];return Math.max(t,e)}return t});b(P,e=>{let{key:t}=_e(U.value);ge[e].has(t)||(U.value=`relevance-desc`)});let{data:Le,status:G,isLoadingMore:Re,hasMore:ze,fetchMore:Be,isRateLimited:K,suggestions:q,packageAvailability:Ve}=ue(F,P,()=>({size:Ie.value}),{suggestions:!0}),J=m(()=>{if(W.value)return H.value;let{key:e,direction:t}=_e(U.value),n=t===`asc`?1:-1;return[...H.value].sort((t,r)=>{let i;switch(e){case`downloads-week`:case`downloads-day`:case`downloads-month`:case`downloads-year`:i=(t.downloads?.weekly??0)-(r.downloads?.weekly??0);break;case`updated`:i=new Date(t.package.date).getTime()-new Date(r.package.date).getTime();break;case`name`:i=t.package.name.localeCompare(r.package.name);break;default:i=0}return i*n})}),He=m(()=>J.value.length),Y=m(()=>W.value?V.value?.total??0:J.value.length);function Ue(e){Me(e)}let We=m(()=>I.value?G.value===`pending`&&J.value.length===0:!1);async function Ge(){Re.value||!ze.value||(z.value++,await Be(Ie.value))}o(()=>{j.cancel()});function Ke(e){j(e)}b(F,(e,t)=>{e.trim()!==(t||``).trim()&&(z.value=1,I.value=!0)});let qe=m(()=>le(F.value.trim())),{isConnected:X,npmUser:Je,listOrgUsers:Ye}=ce(),Xe=m(()=>{let e=F.value.trim();if(!e.startsWith(`@`))return null;let t=e.match(/^@([^/]+)\//);return t?t[1]:null}),Z=te({});b([Xe,X,Je],async([e,t,n])=>{if(!(!e||!t||!n)&&!(e in Z.value))try{let t=await Ye(e);t&&n in t?Z.value[e]=!0:Z.value[e]=!1}catch{Z.value[e]=!1}},{immediate:!0});let Ze=m(()=>{let e=Xe.value;return e?Je.value?e.toLowerCase()===Je.value.toLowerCase()?!0:Z.value[e]===!0:!1:!0}),Qe=m(()=>qe.value&&Ve.value?.available===!0&&Ve.value.name===F.value.trim()&&(!X.value||X.value&&Ze.value)&&G.value!==`pending`),$e=p(`claimPackageModalRef`),et=m(()=>{let e=F.value.trim().toLowerCase();return!e||!V.value?!1:V.value.objects.some(t=>t.package.name.toLowerCase()===e)}),tt=m(()=>{let e=F.value.trim();if(!e.startsWith(`@`)||e.includes(`/`))return!1;let t=e.slice(1).toLowerCase();return q.value.some(e=>e.type===`org`&&e.name.toLowerCase()===t&&e.exists)}),Q=m(()=>{if(et.value)return`package`;if(tt.value)return`org`;let e=F.value.trim();if(e.startsWith(`~`)){let t=e.slice(1).toLowerCase();if(q.value.some(e=>e.type===`user`&&e.name.toLowerCase()===t&&e.exists))return`user`}return null}),nt=m(()=>q.value.length),rt=m(()=>nt.value+He.value);function it(){let e=e=>e.getClientRects().length>0,t=Array.from(document.querySelectorAll(`[data-suggestion-index]`)).filter(e).sort((e,t)=>Number.parseInt(e.dataset.suggestionIndex??`0`,10)-Number.parseInt(t.dataset.suggestionIndex??`0`,10)),n=Array.from(document.querySelectorAll(`[data-result-index]`)).filter(e).sort((e,t)=>Number.parseInt(e.dataset.resultIndex??`0`,10)-Number.parseInt(t.dataset.resultIndex??`0`,10));return[...t,...n]}function at(e){e.focus(),e.scrollIntoView({block:`nearest`,behavior:`smooth`})}async function ot(e){await ne(se(e))}let $=d(null);b(J,e=>{if(!$.value)return;if(document.activeElement?.tagName!==`INPUT`){$.value=null;return}let t=e[0];console.log(`[search] watcher fired`,{pending:$.value,firstResult:t?.package.name}),t?.package.name===$.value&&($.value=null,ot(t.package.name))});function st(){document.querySelector(`input[type="search"], input[name="q"]`)?.focus()}function ct(e){if(e.key===`Enter`&&document.activeElement?.tagName===`INPUT`){let e=document.activeElement.value.trim();if(!e)return;let t=J.value[0];if(t?.package.name===e)return $.value=null,ot(t.package.name);$.value=e;return}if(rt.value<=0)return;let t=it();if(t.length===0)return;let n=t.findIndex(e=>e===document.activeElement);if(e.key===`ArrowDown`){e.preventDefault();let r=t[n<0?0:Math.min(n+1,t.length-1)];r&&at(r);return}if(e.key===`ArrowUp`){if(e.preventDefault(),n<=0){st();return}let r=t[n-1];r&&at(r);return}if(e.key===`Enter`&&document.activeElement&&t.includes(document.activeElement)){let t=document.activeElement;t.tagName!==`A`&&(e.preventDefault(),t.click())}}return ae([`ArrowDown`,`ArrowUp`,`Enter`],ct),w({title:()=>`${F.value?_(`search.title_search`,{search:F.value}):_(`search.title_packages`)} - npmx`,ogTitle:()=>`${F.value?_(`search.title_search`,{search:F.value}):_(`search.title_packages`)} - npmx`,twitterTitle:()=>`${F.value?_(`search.title_search`,{search:F.value}):_(`search.title_packages`)} - npmx`,description:()=>F.value?_(`search.meta_description`,{search:F.value}):_(`search.meta_description_packages`),ogDescription:()=>F.value?_(`search.meta_description`,{search:F.value}):_(`search.meta_description_packages`),twitterDescription:()=>F.value?_(`search.meta_description`,{search:F.value}):_(`search.meta_description_packages`)}),R(`Default`,{title:()=>`${F.value?_(`search.title_search`,{search:F.value}):_(`search.title_packages`)} - npmx`,description:()=>F.value?_(`search.meta_description`,{search:F.value}):_(`search.meta_description_packages`),primaryColor:`#60a5fa`}),(e,a)=>{let o=Ct,d=de,p=Pe,m=fe,y=ve,b=me,te=vt;return s(),x(`main`,{class:t([`flex-1 py-8 search-page`,{"overflow-x-hidden":i(C)!==`table`}])},[S(`div`,wt,[S(`div`,Tt,[S(`h1`,Et,c(i(_)(`search.title`)),1),l(o)]),i(F)?(s(),x(`section`,Dt,[i(We)?(s(),u(d,{key:0,text:i(_)(`search.searching`)},null,8,[`text`])):n(``,!0),ee(S(`div`,null,[i(q).length>0&&i(J).length>0?(s(),x(`div`,Ot,[(s(!0),x(v,null,f(i(q),(e,t)=>(s(),u(p,{key:`${e.type}-${e.name}`,type:e.type,name:e.name,index:t,"is-exact-match":i(Q)===`org`&&e.type===`org`||i(Q)===`user`&&e.type===`user`},null,8,[`type`,`name`,`index`,`is-exact-match`]))),128))])):n(``,!0),i(Qe)&&i(V)&&i(J).length>0?(s(),x(`div`,kt,[S(`div`,At,[S(`p`,jt,c(i(_)(`search.not_taken`,{name:i(F)})),1),S(`p`,Mt,c(i(_)(`search.claim_prompt`)),1)]),S(`button`,{type:`button`,class:`shrink-0 px-4 py-2 font-mono text-sm text-bg bg-fg rounded-md motion-safe:transition-colors motion-safe:duration-200 hover:bg-fg/90 focus-visible:outline-accent/70`,onClick:a[0]||=e=>i($e)?.open()},c(i(_)(`search.claim_button`,{name:i(F)})),1)])):n(``,!0),i(K)?(s(),x(`div`,Nt,[S(`p`,Pt,c(i(_)(`search.rate_limited`)),1)])):i(V)&&i(J).length>0?(s(),x(`div`,Ft,[l(m,{filters:i(Ce),"sort-option":i(U),"onUpdate:sortOption":a[1]||=e=>g(U)?U.value=e:null,"view-mode":i(C),"onUpdate:viewMode":a[2]||=e=>g(C)?C.value=e:null,columns:i(O),"pagination-mode":i(T),"onUpdate:paginationMode":a[3]||=e=>g(T)?T.value=e:null,"page-size":i(D),"onUpdate:pageSize":a[4]||=e=>g(D)?D.value=e:null,"total-count":i(Y),"filtered-count":i(J).length,"available-keywords":i(we),"active-filters":i(Te),"disabled-sort-keys":i(Se),"search-context":``,onToggleColumn:i(A),onResetColumns:i(oe),onClearFilter:Ue,onClearAllFilters:i(Ne),"onUpdate:text":i(Ee),"onUpdate:searchScope":i(De),"onUpdate:downloadRange":i(Oe),"onUpdate:security":i(ke),"onUpdate:updatedWithin":i(Ae),onToggleKeyword:i(je)},null,8,[`filters`,`sort-option`,`view-mode`,`columns`,`pagination-mode`,`page-size`,`total-count`,`filtered-count`,`available-keywords`,`active-filters`,`disabled-sort-keys`,`onToggleColumn`,`onResetColumns`,`onClearAllFilters`,`onUpdate:text`,`onUpdate:searchScope`,`onUpdate:downloadRange`,`onUpdate:security`,`onUpdate:updatedWithin`,`onToggleKeyword`]),i(C)===`cards`&&i(T)===`infinite`?(s(),x(`p`,It,[i(W)?(s(),x(v,{key:0},[r(c(i(_)(`search.found_packages`,{count:e.$n(i(V).total)},i(V).total)),1)],64)):(s(),x(v,{key:1},[r(c(i(_)(`search.found_packages_sorted`,{count:e.$n(i(Y))},i(Y))),1)],64)),i(G)===`pending`?(s(),x(`span`,Lt,c(i(_)(`search.updating`)),1)):n(``,!0)])):n(``,!0),i(C)===`table`||i(T)===`paginated`?(s(),x(`p`,Rt,c(i(_)(`filters.count.showing_paginated`,{pageSize:i(D)===`all`?e.$n(i(Y)):Math.min(i(D),i(Y)),count:e.$n(i(Y))},i(Y))),1)):n(``,!0)])):i(G)===`success`||i(G)===`error`?(s(),x(`div`,zt,[S(`p`,Bt,c(i(_)(`search.no_results`,{query:i(F)})),1),i(q).length>0?(s(),x(`div`,Vt,[(s(!0),x(v,null,f(i(q),(e,t)=>(s(),u(p,{key:`${e.type}-${e.name}`,type:e.type,name:e.name,index:t,"is-exact-match":i(Q)===`org`&&e.type===`org`||i(Q)===`user`&&e.type===`user`},null,8,[`type`,`name`,`index`,`is-exact-match`]))),128))])):n(``,!0),i(Qe)?(s(),x(`div`,Ht,[S(`div`,Ut,[S(`p`,Wt,c(i(_)(`search.want_to_claim`)),1),S(`button`,{type:`button`,class:`px-4 py-2 font-mono text-sm text-bg bg-fg rounded-md transition-colors duration-200 hover:bg-fg/90 focus-visible:outline-accent/70`,onClick:a[5]||=e=>i($e)?.open()},c(i(_)(`search.claim_button`,{name:i(F)})),1)])])):n(``,!0)])):n(``,!0),ee(l(y,{results:i(J),"search-query":i(F),filters:i(Ce),"search-context":``,"heading-level":`h2`,"show-publisher":``,"has-more":i(ze),"is-loading":i(Re),"page-size":i(D),"initial-page":i(B),"view-mode":i(C),columns:i(O),"sort-option":i(U),"onUpdate:sortOption":a[6]||=e=>g(U)?U.value=e:null,"pagination-mode":i(T),"current-page":i(z),onLoadMore:Ge,onPageChange:Ke,onClickKeyword:i(je)},null,8,[`results`,`search-query`,`filters`,`has-more`,`is-loading`,`page-size`,`initial-page`,`view-mode`,`columns`,`sort-option`,`pagination-mode`,`current-page`,`onClickKeyword`]),[[h,i(J).length>0&&!i(K)]]),i(J).length>0&&!i(K)?(s(),u(b,{key:5,mode:i(T),"onUpdate:mode":a[7]||=e=>g(T)?T.value=e:null,"page-size":i(D),"onUpdate:pageSize":a[8]||=e=>g(D)?D.value=e:null,"current-page":i(z),"onUpdate:currentPage":a[9]||=e=>g(z)?z.value=e:null,"total-items":i(Y),"view-mode":i(C)},null,8,[`mode`,`page-size`,`current-page`,`total-items`,`view-mode`])):n(``,!0)],512),[[h,i(Le)||i(J).length>0||i(K)||i(G)===`error`||i(G)===`success`]])])):(s(),x(`section`,Gt,[S(`p`,Kt,c(i(_)(`search.start_typing`)),1)]))]),l(te,{ref_key:`claimPackageModalRef`,ref:$e,"package-name":i(F),"package-scope":i(Xe),"can-publish-to-scope":i(Ze)},null,8,[`package-name`,`package-scope`,`can-publish-to-scope`])],2)}}}),[[`__scopeId`,`data-v-94b26821`]]);export{Jt as default};