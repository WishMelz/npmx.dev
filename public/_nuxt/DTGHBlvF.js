import{A as e,At as t,C as n,D as r,Dt as i,G as a,J as o,L as s,Nt as c,O as l,Q as u,S as d,St as f,Z as p,at as m,b as h,ht as g,lt as _,m as v,n as y,nt as b,ot as x,p as S,r as C,rt as w,w as T,x as E,yt as D}from"./BLt7TXlb.js";import{B as O,U as k,z as A}from"./CreLCcZP.js";import{n as j}from"./DZubR30v.js";import{n as M,t as N}from"./-B2-_an5.js";import{n as P}from"./DkotcqDl.js";import{t as F}from"./Cend_Z8Q.js";import{t as I}from"./CdWQmgpE.js";import{t as L}from"./Bi22IuVY.js";import{m as R}from"./Brdikwlz.js";import{t as z}from"./Z_xnzAqw.js";import{t as B}from"./CAwcA5eI.js";import{a as V,d as H,f as U,h as W,i as G,l as ee,m as K,o as q,p as J,r as te,s as ne,u as Y}from"./Dg50IizM.js";var X={class:`relative`},Z=[`id`,`aria-label`],re={class:`py-1`},ie={class:`px-3 py-2 text-xs font-mono text-fg-subtle uppercase tracking-wider border-b border-border`,"aria-hidden":`true`},ae={class:`py-1 max-h-64 overflow-y-auto`},oe=[`checked`,`disabled`,`aria-describedby`,`onChange`],se={class:`text-sm text-fg-muted font-mono flex-1`},ce={class:`border-t border-border py-1`},le=e({__name:`ColumnPicker`,props:{columns:{}},emits:[`toggle`,`reset`],setup(e,{emit:a}){let{t:s}=j(),u=e,g=a,x=f(!1),C=m(`buttonRef`),w=m(`menuRef`),D=b();N(w,()=>{x.value=!1},{ignore:[C]}),M(`Escape`,e=>{x.value&&(x.value=!1,C.value?.focus())},{dedupe:!0});let O=h(()=>u.columns.filter(e=>e.id!==`name`)),k=h(()=>({name:s(`filters.columns.name`),version:s(`filters.columns.version`),description:s(`filters.columns.description`),downloads:s(`filters.columns.downloads`),updated:s(`filters.columns.published`),maintainers:s(`filters.columns.maintainers`),keywords:s(`filters.columns.keywords`),qualityScore:s(`filters.columns.quality_score`),popularityScore:s(`filters.columns.popularity_score`),maintenanceScore:s(`filters.columns.maintenance_score`),combinedScore:s(`filters.columns.combined_score`),security:s(`filters.columns.security`)}));function A(e){return k.value[e]??e}function P(){g(`reset`),x.value=!1}return(e,a)=>{let u=F,f=I;return o(),T(`div`,X,[l(u,{ref_key:`buttonRef`,ref:C,"aria-expanded":i(x),"aria-haspopup":`true`,"aria-controls":i(D),onClick:a[0]||=S(e=>x.value=!i(x),[`stop`]),classicon:`i-lucide:columns-3-cog`},{default:_(()=>[r(c(i(s)(`filters.columns.title`)),1)]),_:1},8,[`aria-expanded`,`aria-controls`]),l(y,{name:`dropdown`},{default:_(()=>[i(x)?(o(),T(`div`,{key:0,ref_key:`menuRef`,ref:w,id:i(D),class:`absolute top-full inset-is-auto sm:inset-ie-0 mt-2 w-60 bg-bg-subtle border border-border rounded-lg shadow-lg z-20`,role:`group`,"aria-label":i(s)(`filters.columns.show`)},[E(`div`,re,[E(`div`,ie,c(i(s)(`filters.columns.show`)),1),E(`div`,ae,[(o(!0),T(v,null,p(i(O),e=>(o(),T(`label`,{key:e.id,class:t([`flex gap-2 items-center px-3 py-2 transition-colors duration-200`,e.disabled?`opacity-50 cursor-not-allowed`:`hover:bg-bg-muted`])},[E(`input`,{type:`checkbox`,checked:e.visible,disabled:e.disabled,"aria-describedby":e.disabled?`${e.id}-disabled-reason`:void 0,class:`w-4 h-4 accent-fg bg-bg-muted border-border rounded disabled:opacity-50`,onChange:t=>!e.disabled&&g(`toggle`,e.id)},null,40,oe),E(`span`,se,c(A(e.id)),1),e.disabled?(o(),d(f,{key:0,id:`${e.id}-disabled-reason`,class:`text-fg-subtle`,text:i(s)(`filters.columns.coming_soon`),position:`left`},{default:_(()=>[...a[1]||=[E(`span`,{class:`size-4 flex justify-center items-center text-xs border rounded-full`},`i`,-1)]]),_:1},8,[`id`,`text`])):n(``,!0)],2))),128))]),E(`div`,ce,[l(u,{onClick:P},{default:_(()=>[r(c(i(s)(`filters.columns.reset`)),1)]),_:1})])])],8,Z)):n(``,!0)]),_:1})])}}}),ue=Object.assign(L(le,[[`__scopeId`,`data-v-7a38e890`]]),{__name:`ColumnPicker`}),de=[`aria-label`],fe=[`aria-pressed`,`aria-label`],pe={class:`sr-only`},me=[`aria-pressed`,`aria-label`],he={class:`sr-only`},ge=e({__name:`ViewModeToggle`,props:{modelValue:{default:`cards`},modelModifiers:{}},emits:[`update:modelValue`],setup(e){let n=w(e,`modelValue`);return(e,r)=>(o(),T(`div`,{class:`inline-flex rounded-md border border-border p-0.5 bg-bg-muted`,role:`group`,"aria-label":e.$t(`filters.view_mode.label`)},[E(`button`,{type:`button`,class:t([`inline-flex items-center px-2.5 py-1.5 text-sm font-medium rounded-sm border transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-1`,n.value===`cards`?`bg-bg-subtle text-fg border-fg-subtle`:`text-fg-muted hover:text-fg border-transparent`]),"aria-pressed":n.value===`cards`,"aria-label":e.$t(`filters.view_mode.cards`),onClick:r[0]||=e=>n.value=`cards`},[r[2]||=E(`span`,{class:`i-lucide:rows-2 w-4 h-4`,"aria-hidden":`true`},null,-1),E(`span`,pe,c(e.$t(`filters.view_mode.cards`)),1)],10,fe),E(`button`,{type:`button`,class:t([`inline-flex items-center px-2.5 py-1.5 text-sm font-medium rounded-sm border transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-1`,n.value===`table`?`bg-bg-subtle  text-fg border-fg-subtle`:`text-fg-muted hover:text-fg border-transparent`]),"aria-pressed":n.value===`table`,"aria-label":e.$t(`filters.view_mode.table`),onClick:r[1]||=e=>n.value=`table`},[r[3]||=E(`span`,{class:`i-lucide:table w-4 h-4`,"aria-hidden":`true`},null,-1),E(`span`,he,c(e.$t(`filters.view_mode.table`)),1)],10,me)],8,de))}}),_e=Object.assign(ge,{__name:`ViewModeToggle`}),ve=[`value`,`checked`,`disabled`],ye=e({__name:`RadioButton`,props:s({disabled:{type:Boolean},type:{},checked:{},value:{}},{modelValue:{},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=w(e,`modelValue`),n=e,r=b(),a=`${t.value}-${r}`,s=h(()=>t.value===n.value),c=()=>{t.value=n.value};return(e,t)=>(o(),T(`div`,null,[E(`input`,{type:`radio`,id:a,value:n.value,checked:i(s),disabled:n.disabled?!0:void 0,onChange:c,class:`peer sr-only`},null,40,ve),E(`label`,{class:`bg-bg-muted text-fg-muted border-border hover:text-fg hover:border-border-hover inline-flex items-center px-2 py-0.5 text-xs font-mono border rounded transition-colors duration-200 peer-focus-visible:outline-2 peer-focus-visible:outline-accent/70 peer-focus-visible:outline-offset-2 border-none peer-checked:bg-fg peer-checked:text-bg peer-checked:border-fg peer-checked:hover:text-text-bg/50 peer-disabled:opacity-50 peer-disabled:pointer-events-none`,htmlFor:a},[u(e.$slots,`default`)])]))}}),be=Object.assign(ye,{__name:`TagRadioButton`}),xe={class:`border border-border rounded-lg bg-bg-subtle`},Se=[`aria-expanded`],Ce={class:`flex items-center gap-2 text-sm font-mono text-fg shrink-0`},we={key:0,class:`text-xs font-mono text-fg-muted truncate`},Te={key:0,class:`px-4 pb-5 border-t border-border`},Ee={class:`pt-4`},De={class:`flex items-center gap-3 mb-1`},Oe={for:`filter-search`,class:`text-sm font-mono text-fg-muted`},ke=[`aria-label`],Ae=[`aria-pressed`,`title`,`onClick`],je={class:`border-0 p-0 m-0 mt-4`},Me={class:`block text-sm font-mono text-fg-muted mb-1`},Ne=[`aria-label`],Pe={class:`border-0 p-0 m-0 mt-4`},Fe={class:`block text-sm font-mono text-fg-muted mb-1`},Ie=[`aria-label`],Le={class:`border-0 p-0 m-0 mt-4`},Re={class:`flex items-center gap-2 text-sm font-mono text-fg-muted mb-1`},ze={class:`text-xs px-1.5 py-0.5 rounded bg-bg-muted text-fg-subtle`},Be=[`aria-label`],Ve={key:0,class:`border-0 p-0 m-0 mt-4`},He={class:`block text-sm font-mono text-fg-muted mb-1`},Ue=[`aria-label`],We=e({__name:`Panel`,props:{filters:{},availableKeywords:{}},emits:[`update:text`,`update:searchScope`,`update:downloadRange`,`update:security`,`update:updatedWithin`,`toggleKeyword`],setup(e,{emit:a}){let{t:s}=j(),u=e,m=a,{t:b}=j(),x=f(!1),S=f(!1),C=h({get:()=>u.filters.text,set:e=>m(`update:text`,e)}),w=h(()=>{let e=u.availableKeywords??[];return S.value?e:e.slice(0,20)}),D=h(()=>{switch(u.filters.searchScope){case`name`:return s(`filters.search_placeholder_name`);case`description`:return s(`filters.search_placeholder_description`);case`keywords`:return s(`filters.search_placeholder_keywords`);case`all`:return s(`filters.search_placeholder_all`);default:return s(`filters.search_placeholder_name`)}}),O=h(()=>!S.value&&(u.availableKeywords?.length??0)>20),k=h(()=>({name:b(`filters.scope_name`),description:b(`filters.scope_description`),keywords:b(`filters.scope_keywords`),all:b(`filters.scope_all`)})),A=h(()=>({name:b(`filters.scope_name_description`),description:b(`filters.scope_description_description`),keywords:b(`filters.scope_keywords_description`),all:b(`filters.scope_all_description`)})),M=h(()=>({any:b(`filters.download_range.any`),lt100:b(`filters.download_range.lt100`),"100-1k":b(`filters.download_range.100_1k`),"1k-10k":b(`filters.download_range.1k_10k`),"10k-100k":b(`filters.download_range.10k_100k`),gt100k:b(`filters.download_range.gt100k`)})),N=h(()=>({any:b(`filters.updated.any`),week:b(`filters.updated.week`),month:b(`filters.updated.month`),quarter:b(`filters.updated.quarter`),year:b(`filters.updated.year`)})),P=h(()=>({all:b(`filters.security_options.all`),secure:b(`filters.security_options.secure`),warnings:b(`filters.security_options.insecure`)}));function I(e){return k.value[e]}function L(e){return A.value[e]}function z(e){return M.value[e]}function B(e){return N.value[e]}function V(e){return P.value[e]}let H=h(()=>{let e=[];if(u.filters.text)if(u.filters.searchScope===`all`)e.push(u.filters.text);else{let t={name:`name`,description:`desc`,keywords:`kw`}[u.filters.searchScope]??`name`;e.push(`${t}:${u.filters.text}`)}if(u.filters.keywords.length>0&&e.push(`kw:${u.filters.keywords.join(`,`)}`),u.filters.downloadRange!==`any`&&e.push(`dl:${u.filters.downloadRange}`),u.filters.updatedWithin!==`any`&&e.push(`updated:${u.filters.updatedWithin}`),u.filters.security!==`all`){let t=u.filters.security===`secure`?`secure`:`warnings`;e.push(`security:${t}`)}return e.length>0?e.join(` `):null}),W=h(()=>!!H.value);return(a,u)=>{let f=R,h=be,b=F;return o(),T(`div`,xe,[E(`button`,{type:`button`,class:`w-full flex items-center gap-3 px-4 py-3 text-start hover:bg-bg-muted transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-inset`,"aria-expanded":i(x),onClick:u[0]||=e=>x.value=!i(x)},[E(`span`,Ce,[u[5]||=E(`span`,{class:`i-lucide:funnel w-4 h-4`,"aria-hidden":`true`},null,-1),r(` `+c(i(s)(`filters.title`)),1)]),!i(x)&&i(W)?(o(),T(`span`,we,c(i(H)),1)):n(``,!0),E(`span`,{class:t([`i-lucide:chevron-down w-4 h-4 text-fg-subtle transition-transform duration-200 shrink-0 ms-auto`,{"rotate-180":i(x)}]),"aria-hidden":`true`},null,2)],8,Se),l(y,{name:`expand`},{default:_(()=>[i(x)?(o(),T(`div`,Te,[E(`div`,Ee,[E(`div`,De,[E(`label`,Oe,c(i(s)(`filters.search`)),1),E(`div`,{class:`inline-flex rounded-md border border-border p-0.5 bg-bg-muted`,role:`group`,"aria-label":i(s)(`filters.search_scope`)},[(o(!0),T(v,null,p(i(ee),n=>(o(),T(`button`,{key:n,type:`button`,class:t([`px-2 py-0.5 text-xs font-mono rounded-sm border transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-1`,e.filters.searchScope===n?`bg-bg-subtle text-fg border-fg-subtle`:`text-fg-muted hover:text-fg border-transparent`]),"aria-pressed":e.filters.searchScope===n,title:L(n),onClick:e=>m(`update:searchScope`,n)},c(I(n)),11,Ae))),128))],8,ke)]),l(f,{id:`filter-search`,type:`text`,modelValue:i(C),"onUpdate:modelValue":u[1]||=e=>g(C)?C.value=e:null,placeholder:i(D),autocomplete:`off`,class:`w-full min-w-25`,size:`medium`,"no-correct":``},null,8,[`modelValue`,`placeholder`])]),E(`fieldset`,je,[E(`legend`,Me,c(i(s)(`filters.weekly_downloads`)),1),E(`div`,{class:`flex flex-wrap gap-2`,role:`radiogroup`,"aria-label":i(s)(`filters.weekly_downloads`)},[(o(!0),T(v,null,p(i(q),t=>(o(),d(h,{key:t.value,"model-value":e.filters.downloadRange,value:t.value,"onUpdate:modelValue":u[2]||=e=>m(`update:downloadRange`,e),name:`range`},{default:_(()=>[r(c(z(t.value)),1)]),_:2},1032,[`model-value`,`value`]))),128))],8,Ne)]),E(`fieldset`,Pe,[E(`legend`,Fe,c(i(s)(`filters.updated_within`)),1),E(`div`,{class:`flex flex-wrap gap-2`,role:`radiogroup`,"aria-label":i(s)(`filters.updated_within`)},[(o(!0),T(v,null,p(i(U),t=>(o(),d(h,{key:t.value,"model-value":e.filters.updatedWithin,value:t.value,name:`updatedWithin`,"onUpdate:modelValue":u[3]||=e=>m(`update:updatedWithin`,e)},{default:_(()=>[r(c(B(t.value)),1)]),_:2},1032,[`model-value`,`value`]))),128))],8,Ie)]),E(`fieldset`,Le,[E(`legend`,Re,[r(c(i(s)(`filters.security`))+` `,1),E(`span`,ze,c(i(s)(`filters.columns.coming_soon`)),1)]),E(`div`,{class:`flex flex-wrap gap-2`,role:`radiogroup`,"aria-label":i(s)(`filters.security`)},[(o(!0),T(v,null,p(i(Y),t=>(o(),d(h,{key:t,disabled:``,"model-value":e.filters.security,value:t,name:`security`},{default:_(()=>[r(c(V(t)),1)]),_:2},1032,[`model-value`,`value`]))),128))],8,Be)]),i(w).length>0?(o(),T(`fieldset`,Ve,[E(`legend`,He,c(i(s)(`filters.keywords`)),1),E(`div`,{class:`flex flex-wrap gap-1.5`,role:`group`,"aria-label":i(s)(`filters.keywords`)},[(o(!0),T(v,null,p(i(w),t=>(o(),d(b,{key:t,size:`small`,"aria-pressed":e.filters.keywords.includes(t),onClick:e=>m(`toggleKeyword`,t)},{default:_(()=>[r(c(t),1)]),_:2},1032,[`aria-pressed`,`onClick`]))),128)),i(O)?(o(),T(`button`,{key:0,type:`button`,class:`text-xs text-fg-subtle self-center font-mono hover:text-fg transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-1`,onClick:u[4]||=e=>S.value=!0},c(i(s)(`filters.more_keywords`,{count:(e.availableKeywords?.length??0)-20})),1)):n(``,!0)],8,Ue)])):n(``,!0)])):n(``,!0)]),_:1})])}}}),Ge=Object.assign(L(We,[[`__scopeId`,`data-v-a8fe1bac`]]),{__name:`FilterPanel`}),Ke={key:0,class:`flex flex-wrap items-center gap-2`},qe={class:`text-fg-subtle text-xs`},Je={class:`max-w-32 truncate`},Ye=[`aria-label`,`onClick`],Xe=e({__name:`Chips`,props:{chips:{}},emits:[`remove`,`clearAll`],setup(e,{emit:t}){let r=t;return(t,i)=>{let a=z;return e.chips.length>0?(o(),T(`div`,Ke,[l(C,{name:`chip`},{default:_(()=>[(o(!0),T(v,null,p(e.chips,e=>(o(),d(a,{key:e.id,class:`gap-2 pe-1`},{default:_(()=>[E(`span`,qe,c(e.label)+`:`,1),E(`span`,Je,c(Array.isArray(e.value)?e.value.join(`, `):e.value),1),E(`button`,{type:`button`,class:`flex items-center p-1 -m-1 hover:text-fg rounded-full transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-1`,"aria-label":t.$t(`filters.remove_filter`,{label:e.label}),onClick:t=>r(`remove`,e)},[...i[1]||=[E(`span`,{class:`i-lucide:x w-3 h-3`,"aria-hidden":`true`},null,-1)]],8,Ye)]),_:2},1024))),128))]),_:1}),e.chips.length>1?(o(),T(`button`,{key:0,type:`button`,class:`text-sm p-0.5 text-fg-muted hover:text-fg underline transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-2`,onClick:i[0]||=e=>r(`clearAll`)},c(t.$t(`filters.clear_all`)),1)):n(``,!0)])):n(``,!0)}}}),Ze=Object.assign(L(Xe,[[`__scopeId`,`data-v-9e72d505`]]),{__name:`FilterChips`}),Qe={class:`space-y-3 mb-6`},$e={class:`flex flex-col sm:flex-row sm:items-center gap-3`},et={key:0,class:`text-sm font-mono text-fg-muted`},tt={key:1,class:`text-sm font-mono text-fg-muted`},nt={class:`flex flex-col sm:flex-row items-start sm:items-center gap-3`},rt={class:`flex items-center gap-1 shrink-0`},it=[`aria-label`,`title`],at={class:`flex flex-row-reverse sm:flex-row items-center gap-1`},ot=e({__name:`ListToolbar`,props:s({filters:{},columns:{},totalCount:{},filteredCount:{},availableKeywords:{},activeFilters:{},searchContext:{type:Boolean},disabledSortKeys:{}},{sortOption:{required:!0},sortOptionModifiers:{},viewMode:{required:!0},viewModeModifiers:{},paginationMode:{required:!0},paginationModeModifiers:{},pageSize:{required:!0},pageSizeModifiers:{}}),emits:s([`toggleColumn`,`resetColumns`,`clearFilter`,`clearAllFilters`,`update:text`,`update:searchScope`,`update:downloadRange`,`update:security`,`update:updatedWithin`,`toggleKeyword`],[`update:sortOption`,`update:viewMode`,`update:paginationMode`,`update:pageSize`]),setup(e,{emit:a}){let s=e,{t:u}=j(),f=w(e,`sortOption`),p=w(e,`viewMode`),m=w(e,`paginationMode`),_=w(e,`pageSize`),y=a,b=h(()=>s.filteredCount!==s.totalCount),x=h(()=>K(f.value)),S=h(()=>new Set(s.disabledSortKeys??[])),C=h(()=>{let e=e=>({...e,disabled:e.disabled||S.value.has(e.key)});return s.searchContext?H.filter(e=>!e.searchOnly||e.key===`relevance`).map(e):H.filter(e=>!e.searchOnly).map(e)}),D=h({get:()=>x.value.key,set:e=>{f.value=J(e,H.find(t=>t.key===e)?.defaultDirection??`desc`)}});function O(){let{key:e,direction:t}=x.value;f.value=J(e,W(t))}let k=h(()=>({relevance:u(`filters.sort.relevance`),"downloads-week":u(`filters.sort.downloads_week`),"downloads-day":u(`filters.sort.downloads_day`),"downloads-month":u(`filters.sort.downloads_month`),"downloads-year":u(`filters.sort.downloads_year`),updated:u(`filters.sort.published`),name:u(`filters.sort.name`),quality:u(`filters.sort.quality`),popularity:u(`filters.sort.popularity`),maintenance:u(`filters.sort.maintenance`),score:u(`filters.sort.score`)}));function A(e){return k.value[e]}return(a,s)=>{let u=B,f=ue,h=_e,S=Ge,w=Ze;return o(),T(`div`,Qe,[E(`div`,$e,[p.value===`cards`&&m.value===`infinite`&&!e.searchContext?(o(),T(`div`,et,[i(b)?(o(),T(v,{key:0},[r(c(a.$t(`filters.count.showing_filtered`,{filtered:a.$n(e.filteredCount),count:a.$n(e.totalCount)},e.totalCount)),1)],64)):(o(),T(v,{key:1},[r(c(a.$t(`filters.count.showing_all`,{count:a.$n(e.totalCount)},e.totalCount)),1)],64))])):n(``,!0),(p.value===`table`||m.value===`paginated`)&&!e.searchContext?(o(),T(`div`,tt,c(a.$t(`filters.count.showing_paginated`,{pageSize:_.value===`all`?a.$n(e.filteredCount):Math.min(_.value,e.filteredCount),count:a.$n(e.filteredCount)},e.filteredCount)),1)):n(``,!0),s[12]||=E(`div`,{class:`flex-1`},null,-1),E(`div`,nt,[E(`div`,rt,[l(u,{label:a.$t(`filters.sort.label`),"hidden-label":``,id:`sort-select`,modelValue:i(D),"onUpdate:modelValue":s[0]||=e=>g(D)?D.value=e:null,items:i(C).map(e=>({label:A(e.key),value:e.key,disabled:e.disabled}))},null,8,[`label`,`modelValue`,`items`]),!e.searchContext||i(x).key!==`relevance`?(o(),T(`button`,{key:0,type:`button`,class:`p-1.5 rounded border border-border bg-bg-subtle text-fg-muted hover:text-fg hover:border-border-hover transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-2 focus-visible:ring-offset-bg`,"aria-label":a.$t(`filters.sort.toggle_direction`),title:i(x).direction===`asc`?a.$t(`filters.sort.ascending`):a.$t(`filters.sort.descending`),onClick:O},[E(`span`,{class:t([`w-4 h-4 block transition-transform duration-200`,i(x).direction===`asc`?`i-lucide:arrow-down-narrow-wide`:`i-lucide:arrow-down-wide-narrow`]),"aria-hidden":`true`},null,2)],8,it)):n(``,!0)]),E(`div`,at,[p.value===`table`?(o(),d(f,{key:0,columns:e.columns,onToggle:s[1]||=e=>y(`toggleColumn`,e),onReset:s[2]||=e=>y(`resetColumns`)},null,8,[`columns`])):n(``,!0),l(h,{modelValue:p.value,"onUpdate:modelValue":s[3]||=e=>p.value=e},null,8,[`modelValue`])])])]),e.searchContext?n(``,!0):(o(),d(S,{key:0,filters:e.filters,"available-keywords":e.availableKeywords,"onUpdate:text":s[4]||=e=>y(`update:text`,e),"onUpdate:searchScope":s[5]||=e=>y(`update:searchScope`,e),"onUpdate:downloadRange":s[6]||=e=>y(`update:downloadRange`,e),"onUpdate:security":s[7]||=e=>y(`update:security`,e),"onUpdate:updatedWithin":s[8]||=e=>y(`update:updatedWithin`,e),onToggleKeyword:s[9]||=e=>y(`toggleKeyword`,e)},null,8,[`filters`,`available-keywords`])),e.searchContext?n(``,!0):(o(),d(w,{key:1,chips:e.activeFilters,onRemove:s[10]||=e=>y(`clearFilter`,e),onClearAll:s[11]||=e=>y(`clearAllFilters`)},null,8,[`chips`]))])}}}),st=Object.assign(ot,{__name:`PackageListToolbar`}),ct={key:0,class:`flex flex-wrap items-center justify-between gap-4 py-4 mt-2`},lt={class:`flex items-center gap-4`},ut=[`aria-label`],dt=[`aria-pressed`],ft=[`aria-pressed`],pt={key:1,class:`relative shrink-0`},mt={key:0,class:`flex items-center gap-4`},ht={class:`text-sm font-mono text-fg-muted`},gt=[`aria-label`],_t=[`disabled`,`aria-label`],vt={key:0,class:`px-2 text-fg-subtle font-mono`},yt=[`aria-current`,`onClick`],bt=[`disabled`,`aria-label`],Q=e({__name:`PaginationControls`,props:s({totalItems:{},viewMode:{}},{mode:{required:!0},modeModifiers:{},pageSize:{required:!0},pageSizeModifiers:{},currentPage:{required:!0},currentPageModifiers:{}}),emits:[`update:mode`,`update:pageSize`,`update:currentPage`],setup(e){let r=e,a=w(e,`mode`),s=w(e,`pageSize`),u=w(e,`currentPage`),d=h(()=>String(s.value)),f=h(()=>r.viewMode===`table`||a.value===`paginated`),m=h(()=>f.value?`paginated`:`infinite`),_=h(()=>s.value===`all`),y=h(()=>_.value?1:Math.ceil(r.totalItems/s.value)),b=h(()=>r.viewMode!==`table`),x=h(()=>r.totalItems===0?0:_.value?1:(u.value-1)*s.value+1),S=h(()=>_.value?r.totalItems:Math.min(u.value*s.value,r.totalItems)),C=h(()=>u.value>1),D=h(()=>u.value<y.value);function O(e){e>=1&&e<=y.value&&(u.value=e)}function k(){C.value&&--u.value}function A(){D.value&&(u.value+=1)}let j=h(()=>{let e=y.value,t=u.value,n=[];if(e<=7)for(let t=1;t<=e;t++)n.push(t);else{n.push(1),t>3&&n.push(`ellipsis`);let r=Math.max(2,t-1),i=Math.min(e-1,t+1);for(let e=r;e<=i;e++)n.push(e);t<e-2&&n.push(`ellipsis`),e>1&&n.push(e)}return n});function M(e){let t=e.target.value;s.value=t===`all`?`all`:Number(t),u.value=1}return(r,s)=>{let h=B;return i(f)?(o(),T(`div`,ct,[E(`div`,lt,[i(b)?(o(),T(`div`,{key:0,class:`inline-flex rounded-md border border-border p-0.5 bg-bg-subtle`,role:`group`,"aria-label":r.$t(`filters.pagination.mode_label`)},[E(`button`,{type:`button`,class:t([`px-2.5 py-1 text-xs font-mono rounded-sm transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-1`,a.value===`infinite`?`bg-bg-muted text-fg`:`text-fg-muted hover:text-fg`]),"aria-pressed":a.value===`infinite`,onClick:s[0]||=e=>a.value=`infinite`},c(r.$t(`filters.pagination.infinite`)),11,dt),E(`button`,{type:`button`,class:t([`px-2.5 py-1 text-xs font-mono rounded-sm transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-1`,a.value===`paginated`?`bg-bg-muted text-fg`:`text-fg-muted hover:text-fg`]),"aria-pressed":a.value===`paginated`,onClick:s[1]||=e=>a.value=`paginated`},c(r.$t(`filters.pagination.paginated`)),11,ft)],8,ut)):n(``,!0),i(m)===`paginated`?(o(),T(`div`,pt,[l(h,{label:r.$t(`filters.pagination.items_per_page`),"hidden-label":``,id:`page-size`,modelValue:i(d),"onUpdate:modelValue":s[2]||=e=>g(d)?d.value=e:null,onChange:M,items:i(ne).map(e=>({label:e===`all`?r.$t(`filters.pagination.all_yolo`):r.$t(`filters.pagination.per_page`,{count:e}),value:String(e)}))},null,8,[`label`,`modelValue`,`items`])])):n(``,!0)]),i(m)===`paginated`?(o(),T(`div`,mt,[E(`span`,ht,c(r.$t(`filters.pagination.showing`,{start:i(x),end:i(S),total:r.$n(e.totalItems)})),1),i(y)>1?(o(),T(`nav`,{key:0,class:`flex items-center gap-1`,"aria-label":r.$t(`filters.pagination.nav_label`)},[E(`button`,{type:`button`,class:`p-1.5 rounded hover:bg-bg-muted text-fg-muted hover:text-fg disabled:opacity-40 disabled:cursor-not-allowed transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-1`,disabled:!i(C),"aria-label":r.$t(`filters.pagination.previous`),onClick:k},[...s[3]||=[E(`span`,{class:`i-lucide:chevron-left block rtl-flip w-4 h-4`,"aria-hidden":`true`},null,-1)]],8,_t),(o(!0),T(v,null,p(i(j),(e,n)=>(o(),T(v,{key:n},[e===`ellipsis`?(o(),T(`span`,vt,`â€¦`)):(o(),T(`button`,{key:1,type:`button`,class:t([`min-w-[32px] h-8 px-2 font-mono text-sm rounded transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-1`,e===u.value?`bg-fg text-bg`:`text-fg-muted hover:text-fg hover:bg-bg-muted`]),"aria-current":e===u.value?`page`:void 0,onClick:t=>O(e)},c(e),11,yt))],64))),128)),E(`button`,{type:`button`,class:`p-1.5 rounded hover:bg-bg-muted text-fg-muted hover:text-fg disabled:opacity-40 disabled:cursor-not-allowed transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-fg focus-visible:ring-offset-1`,disabled:!i(D),"aria-label":r.$t(`filters.pagination.next`),onClick:A},[...s[4]||=[E(`span`,{class:`i-lucide:chevron-right block rtl-flip w-4 h-4`,"aria-hidden":`true`},null,-1)]],8,bt)],8,gt)):n(``,!0)])):n(``,!0)])):n(``,!0)}}}),xt=Object.assign(Q,{__name:`PaginationControls`}),St=`npmx-list-prefs`,Ct=k((e,t,n)=>{if(Array.isArray(e[t])&&Array.isArray(n))return e[t]=n,!0});function wt(e){return{get:()=>{try{let t=localStorage.getItem(e);if(t)return JSON.parse(t)}catch{localStorage.removeItem(e)}return null},set:t=>{try{localStorage.setItem(e,JSON.stringify(t))}catch{}},remove:()=>{localStorage.removeItem(e)}}}function Tt(e){let t=wt(St),n=D(e),r=f(!1);a(()=>{let i=t.get();i&&(n.value=Ct(i,e)),r.value=!0});function i(){t.set(n.value)}function o(){n.value={...e},t.remove()}function s(e,t){n.value[e]=t,i()}return{data:n,isHydrated:r,save:i,reset:o,update:s}}function Et(){let{data:e,isHydrated:t,save:n,reset:r}=Tt(V),i=h({get:()=>e.value.viewMode,set:t=>{e.value.viewMode=t,n()}}),a=h({get:()=>e.value.paginationMode,set:t=>{e.value.paginationMode=t,n()}}),o=h({get:()=>e.value.pageSize,set:t=>{e.value.pageSize=t,n()}}),s=h({get:()=>e.value.columns,set:t=>{e.value.columns=t,n()}}),c=h(()=>s.value.filter(e=>e.visible));function l(e,t){let r=s.value.find(t=>t.id===e);r&&(r.visible=t,n())}function u(e){let t=s.value.find(t=>t.id===e);t&&(t.visible=!t.visible,n())}function d(){e.value.columns=te.map(e=>Object.assign({},e)),n()}function f(e){return s.value.find(t=>t.id===e)?.visible??!1}return{preferences:e,isHydrated:t,viewMode:i,paginationMode:a,pageSize:o,columns:s,visibleColumns:c,setColumnVisibility:l,toggleColumn:u,resetColumns:d,isColumnVisible:f,reset:r}}function $(e){let t={},n=/\b(name|desc|description|kw|keyword):(\S+)/gi,r=e,i;for(;(i=n.exec(e))!==null;){let[e,n,a]=i;if(!n||!a)continue;let o=a.split(`,`).map(e=>e.trim()).filter(Boolean),s=n.toLowerCase();s===`name`?t.name=[...t.name??[],...o]:s===`desc`||s===`description`?t.description=[...t.description??[],...o]:(s===`kw`||s===`keyword`)&&(t.keywords=[...t.keywords??[],...o]),r=r.replace(e,``)}let a=r.trim().replace(/\s+/g,` `);if(a&&(t.text=a),t.keywords){let e=new Set;t.keywords=t.keywords.filter(t=>{let n=t.toLowerCase();return e.has(n)?!1:(e.add(n),!0)})}return t}function Dt(e){return!!(e.name?.length||e.description?.length||e.keywords?.length)}function Ot(e,t){let n=/\b((?:kw|keyword):)(\S+)/gi,r=t.toLowerCase(),i=e.replace(n,(e,t,n)=>{let i=n.split(`,`).filter(Boolean),a=i.filter(e=>e.toLowerCase()!==r);return a.length===0?``:a.length===i.length?e:`${t}${a.join(`,`)}`});return i=i.replace(/\s+/g,` `).trim(),i}function kt(e,t){if(t.length===0)return!0;let n=new Set((e.package.keywords??[]).map(e=>e.toLowerCase()));return t.every(e=>n.has(e.toLowerCase()))}function At(e,t){if(t===`all`)return!0;let n=(e.flags?.insecure??0)>0;return t===`secure`?!n:t===`warnings`?n:!0}function jt(e){let t=A(),n=O(),{packages:r,initialFilters:i,initialSort:a,searchQueryModel:o}=e,{t:s}=j(),c=f(P(t.query.q)),l=D({...G,...i});x(()=>t.query.q,e=>{let t=P(e);c.value!==t&&(c.value=t);let n=$(t);l.value.text=n.text??``,l.value.keywords=n.keywords??[]},{immediate:!0});let u=f(a??`updated-desc`),d=h(()=>{let e=new Map;for(let t of r.value){let n=t.package.keywords??[];for(let t of n)e.set(t,(e.get(t)??0)+1)}return Array.from(e.entries()).sort((e,t)=>t[1]-e[1]).map(([e])=>e)});function p(e,t,n){if(!t)return!0;let r=e.package.name.toLowerCase(),i=(e.package.description??``).toLowerCase(),a=(e.package.keywords??[]).map(e=>e.toLowerCase());if(n===`all`){let e=$(t);if(Dt(e)){if(e.name?.length&&!e.name.some(e=>r.includes(e.toLowerCase()))||e.description?.length&&!e.description.some(e=>i.includes(e.toLowerCase()))||e.keywords?.length&&!e.keywords.some(e=>a.some(t=>t.includes(e.toLowerCase()))))return!1;if(e.text){let t=e.text.toLowerCase();if(!(r.includes(t)||i.includes(t)||a.some(e=>e.includes(t))))return!1}return!0}let n=t.toLowerCase();return r.includes(n)||i.includes(n)||a.some(e=>e.includes(n))}let o=t.toLowerCase();switch(n){case`name`:return r.includes(o);case`description`:return i.includes(o);case`keywords`:return a.some(e=>e.includes(o));default:return r.includes(o)}}function m(e,t){if(t===`any`)return!0;let n=e.downloads?.weekly??0,r=q.find(e=>e.value===t);return r?!(r.min!==void 0&&n<r.min||r.max!==void 0&&n>=r.max):!0}function g(e,t){if(t===`any`)return!0;let n=U.find(e=>e.value===t);if(!n?.days)return!0;let r=new Date(e.package.date),i=new Date;return i.setDate(i.getDate()-n.days),r>=i}let _=h(()=>r.value.filter(e=>!(!p(e,l.value.text,l.value.searchScope)||!m(e,l.value.downloadRange)||!kt(e,l.value.keywords)||!At(e,l.value.security)||!g(e,l.value.updatedWithin))));function v(e,t,n){let{key:r,direction:i}=K(n),a=i===`asc`?1:-1,o;switch(r){case`downloads-week`:o=(e.downloads?.weekly??0)-(t.downloads?.weekly??0);break;case`downloads-day`:case`downloads-month`:case`downloads-year`:o=(e.downloads?.weekly??0)-(t.downloads?.weekly??0);break;case`updated`:o=new Date(e.package.date).getTime()-new Date(t.package.date).getTime();break;case`name`:o=e.package.name.localeCompare(t.package.name);break;case`quality`:o=(e.score?.detail?.quality??0)-(t.score?.detail?.quality??0);break;case`popularity`:o=(e.score?.detail?.popularity??0)-(t.score?.detail?.popularity??0);break;case`maintenance`:o=(e.score?.detail?.maintenance??0)-(t.score?.detail?.maintenance??0);break;case`score`:o=(e.score?.final??0)-(t.score?.final??0);break;case`relevance`:o=0;break;default:o=0}return o*a}let y=h(()=>[..._.value].sort((e,t)=>v(e,t,u.value))),b=h(()=>({any:s(`filters.download_range.any`),lt100:s(`filters.download_range.lt100`),"100-1k":s(`filters.download_range.100_1k`),"1k-10k":s(`filters.download_range.1k_10k`),"10k-100k":s(`filters.download_range.10k_100k`),gt100k:s(`filters.download_range.gt100k`)})),S=h(()=>({all:s(`filters.security_options.all`),secure:s(`filters.security_options.secure`),warnings:s(`filters.security_options.insecure`)})),C=h(()=>({any:s(`filters.updated.any`),week:s(`filters.updated.week`),month:s(`filters.updated.month`),quarter:s(`filters.updated.quarter`),year:s(`filters.updated.year`)})),w=h(()=>{let e=[];l.value.text&&e.push({id:`text`,type:`text`,label:s(`filters.chips.search`),value:l.value.text}),l.value.downloadRange!==`any`&&e.push({id:`downloadRange`,type:`downloadRange`,label:s(`filters.chips.downloads`),value:b.value[l.value.downloadRange]});for(let t of l.value.keywords)e.push({id:`keyword-${t}`,type:`keywords`,label:s(`filters.chips.keyword`),value:t});return l.value.security!==`all`&&e.push({id:`security`,type:`security`,label:s(`filters.chips.security`),value:S.value[l.value.security]}),l.value.updatedWithin!==`any`&&e.push({id:`updatedWithin`,type:`updatedWithin`,label:s(`filters.chips.updated`),value:C.value[l.value.updatedWithin]}),e}),T=h(()=>w.value.length>0);function E(e){l.value.text=e}function k(e){l.value.searchScope=e}function M(e){l.value.downloadRange=e}function N(e){let r=e.toLowerCase();if(!l.value.keywords.some(e=>e.toLowerCase()===r)){l.value.keywords=[...l.value.keywords,e];let r=c.value?`${c.value.trim()} keyword:${e}`:`keyword:${e}`;n.replace({query:{...t.query,q:r}}),o&&(o.value=r)}}function F(e){let r=e.toLowerCase();l.value.keywords=l.value.keywords.filter(e=>e.toLowerCase()!==r);let i=Ot(c.value,e);n.replace({query:{...t.query,q:i||void 0}}),o&&(o.value=i)}function I(e){let t=e.toLowerCase();l.value.keywords.some(e=>e.toLowerCase()===t)?F(e):N(e)}function L(e){l.value.security=e}function R(e){l.value.updatedWithin=e}function z(e){switch(e.type){case`text`:l.value.text=``;break;case`downloadRange`:l.value.downloadRange=`any`;break;case`keywords`:F(e.value);break;case`security`:l.value.security=`all`;break;case`updatedWithin`:l.value.updatedWithin=`any`;break}}function B(){l.value={...G}}function V(e){u.value=e}return{filters:l,sortOption:u,filteredPackages:_,sortedPackages:y,availableKeywords:d,activeFilters:w,hasActiveFilters:T,setTextFilter:E,setSearchScope:k,setDownloadRange:M,addKeyword:N,removeKeyword:F,toggleKeyword:I,setSecurity:L,setUpdatedWithin:R,clearFilter:z,clearAllFilters:B,setSort:V}}export{st as i,Et as n,xt as r,jt as t};