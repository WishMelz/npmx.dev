"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.LexError = void 0;
/**
 * Error class for Lexicon-related errors.
 *
 * LexError extends the standard JavaScript {@link Error} with AT Protocol-specific
 * functionality including:
 * - An error code for programmatic error handling
 * - JSON serialization for API responses
 * - HTTP Response generation
 *
 * @typeParam N - The specific error code type
 *
 * @example
 * ```typescript
 * import { LexError } from '@atproto/lex-data'
 *
 * // Throw a Lexicon error
 * throw new LexError('InvalidRequest', 'Missing required field')
 *
 * // Create and serialize
 * const error = new LexError('NotFound', 'Record not found')
 * console.log(error.toJSON())
 * // { error: 'NotFound', message: 'Record not found' }
 *
 * // Return as HTTP response
 * return error.toResponse()  // 400 Bad Request with JSON body
 * ```
 */
class LexError extends Error {
    error;
    name = 'LexError';
    /**
     * Creates a new LexError.
     *
     * @param error - The error code identifying the type of error
     * @param message - Optional human-readable error message
     * @param options - Standard Error options (e.g., cause)
     */
    constructor(error, message, // Defaults to empty string in Error constructor
    options) {
        super(message, options);
        this.error = error;
    }
    /**
     * Returns a string representation of this error.
     *
     * @returns A formatted string: "LexError: [ERROR_CODE] message"
     */
    toString() {
        return `${this.name}: [${this.error}] ${this.message}`;
    }
    /**
     * Converts this error to a JSON-serializable object.
     *
     * @returns The error data suitable for JSON serialization
     */
    toJSON() {
        const { error, message } = this;
        return { error, message: message || undefined };
    }
    /**
     * Converts this error to an HTTP Response for downstream clients.
     *
     * Returns a 400 Bad Request response with the JSON-serialized error body.
     *
     * @returns A Response object with status 400 and JSON body
     */
    toResponse() {
        return Response.json(this.toJSON(), { status: 400 });
    }
}
exports.LexError = LexError;
//# sourceMappingURL=lex-error.js.map